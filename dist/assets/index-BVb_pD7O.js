import{r as e,u as a,L as t,D as s,U as i,F as l,B as r,a as n,C as o,b as c,A as d,c as m,S as x,j as u,d as h,N as g,e as p,f,g as j,O as b,W as y,T as v,h as N,I as w,i as k,k as q,l as S,m as T,R as _,P as A,n as z,o as C,p as P,q as I,s as M,t as F,v as D,w as R,x as O,y as $,z as E,E as U,G as L,H as J,J as Y,X as B,K as Q,M as H,Q as K,V as X,Y as Z,Z as W,_ as G,$ as V,a0 as ee,a1 as ae,a2 as te,a3 as se,a4 as ie,a5 as le,a6 as re,a7 as ne,a8 as oe,a9 as ce,aa as de,ab as me,ac as xe,ad as ue,ae as he,af as ge,ag as pe,ah as fe,ai as je,aj as be,ak as ye,al as ve,am as Ne,an as we,ao as ke,ap as qe,aq as Se,ar as Te,as as _e,at as Ae,au as ze,av as Ce,aw as Pe,ax as Ie,ay as Me,az as Fe,aA as De,aB as Re,aC as Oe}from"./react-vendor-DGwZaY2p.js";import{G as $e,T as Ee}from"./ai-vendor-xyUEKhwI.js";import"./vendor-C8MmXo7E.js";function Ue(e,a){var t;if(null==(t=null==e?void 0:e.response)?void 0:t[a]){const t=e.response[a];return Array.isArray(t)&&t.length>0?t[0]:"string"==typeof t?t:null}if(null==e?void 0:e[a]){const t=e[a];return Array.isArray(t)&&t.length>0?t[0]:"string"==typeof t?t:null}return null}function Le(e){return function(e){var a,t;const s=(null==(a=null==e?void 0:e.message)?void 0:a.toLowerCase())||"",i=(null==(t=null==e?void 0:e.name)?void 0:t.toLowerCase())||"";return s.includes("network")||s.includes("failed to fetch")||s.includes("networkerror")||s.includes("load failed")||s.includes("network request failed")||"typeerror"===i||"NETWORK_ERROR"===(null==e?void 0:e.code)||"ERR_NETWORK"===(null==e?void 0:e.code)||!(null==e?void 0:e.response)}(e)?"Serverga ulanib bo'lmadi. Iltimos, internet aloqasini tekshiring yoki keyinroq urinib ko'ring.":function(e){var a,t,s;return 401===(null==e?void 0:e.status)||401===(null==(a=null==e?void 0:e.response)?void 0:a.status)||(null==(t=null==e?void 0:e.message)?void 0:t.includes("Unauthorized"))||(null==(s=null==e?void 0:e.message)?void 0:s.includes("authentication"))}(e)?"Sizning sessiyangiz muddati tugagan. Iltimos, qayta kiring.":403===(null==e?void 0:e.status)?"Siz bu amalni bajarish huquqiga egasiz.":404===(null==e?void 0:e.status)?"Ma'lumot topilmadi.":500===(null==e?void 0:e.status)?"Server xatosi. Iltimos, keyinroq urinib ko'ring.":function(e){if("string"==typeof e)return e;if(null==e?void 0:e.response){const a=e.response;if(a.non_field_errors&&Array.isArray(a.non_field_errors)&&a.non_field_errors.length>0)return a.non_field_errors[0];if(a.detail)return"string"==typeof a.detail?a.detail:JSON.stringify(a.detail);if(a.error_note)return a.error_note;if(a.error)return"string"==typeof a.error?a.error:JSON.stringify(a.error);if(a.message)return a.message}return(null==e?void 0:e.detail)?"string"==typeof e.detail?e.detail:JSON.stringify(e.detail):(null==e?void 0:e.error_note)?e.error_note:(null==e?void 0:e.error)?"string"==typeof e.error?e.error:JSON.stringify(e.error):(null==e?void 0:e.message)?e.message:"Xatolik yuz berdi. Iltimos, qayta urinib ko'ring."}(e)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)}).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const Je="https://api.ilmiyfaoliyat.uz/api/v1",Ye=()=>localStorage.getItem("access_token"),Be=e=>localStorage.setItem("access_token",e),Qe=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},He=async(e,a={})=>{var t,s,i,l;const r=Ye(),n={"Content-Type":"application/json",...a.headers};r&&(n.Authorization=`Bearer ${r}`);const o={...a,headers:n};try{const a=`${Je}${e}`;0;const t=await fetch(a,o);if(401===t.status)throw Qe(),window.location.href="/#/login",new Error("Sizning sessiyangiz muddati tugagan. Iltimos, qayta kiring.");if(!t.ok){const e=await t.text();let a;try{a=JSON.parse(e)}catch(c){if(e.includes("<!DOCTYPE html>")||e.includes("<html")){const s=e.match(/<pre class="exception_value">(.*?)<\/pre>/s);a=s?{detail:s[1].trim(),html:!0}:{detail:`Server xatosi (Status: ${t.status})`,html:!0}}else a={detail:e||"Noma'lum xatolik"}}const s=Le({response:a,status:t.status}),i=new Error(s);throw i.status=t.status,i.response=a,i}const s=await t.text();if(!s)return{};try{return JSON.parse(s)}catch(c){throw new Error("Invalid response format")}}catch(d){const a=`${Je}${e}`;if("TypeError"===(null==d?void 0:d.name)&&((null==(t=null==d?void 0:d.message)?void 0:t.includes("fetch"))||(null==(s=null==d?void 0:d.message)?void 0:s.includes("Failed")))){const e=new Error("Serverga ulanib bo'lmadi.");throw e.name="NetworkError",e.code="NETWORK_ERROR",e.originalError=d,e.url=a,e}if((null==(i=null==d?void 0:d.message)?void 0:i.includes("CORS"))||(null==(l=null==d?void 0:d.message)?void 0:l.includes("cors"))){const e=new Error("Server CORS sozlamalari noto'g'ri. Iltimos, administratorga murojaat qiling.");throw e.name="CORS_ERROR",e.code="CORS_ERROR",e}throw d}},Ke={login:async(e,a)=>{const t=await He("/auth/login/",{method:"POST",body:JSON.stringify({phone:e,password:a})});return t.access&&(Be(t.access),localStorage.setItem("refresh_token",t.refresh)),t},register:async e=>{const a=await He("/auth/register/",{method:"POST",body:JSON.stringify(e)});return a.access&&(Be(a.access),localStorage.setItem("refresh_token",a.refresh)),a},logout:()=>{Qe()},getProfile:()=>He("/auth/profile/"),updateProfile:e=>He("/auth/update_profile/",{method:"PUT",body:JSON.stringify(e)}),stats:()=>He("/auth/stats/")},Xe={list:()=>He("/auth/"),get:e=>He(`/auth/${e}/`),create:e=>He("/auth/",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>He(`/auth/${e}/`,{method:"PUT",body:JSON.stringify(a)}),delete:e=>He(`/auth/${e}/`,{method:"DELETE"}),stats:()=>He("/auth/stats/")},Ze={list:e=>{const a=e?`?${new URLSearchParams(e)}`:"";return He(`/articles/${a}`)},get:e=>He(`/articles/${e}/`),create:async(e,a)=>{if(!a||!a.mainFile&&!a.additionalFile)return He("/articles/",{method:"POST",body:JSON.stringify(e)});{const s=new FormData;Object.keys(e).forEach(a=>{const t=e[a];null!=t&&(Array.isArray(t)||"object"==typeof t?s.append(a,JSON.stringify(t)):s.append(a,t))}),a.mainFile&&s.append("final_pdf_path",a.mainFile),a.additionalFile&&s.append("additional_document_path",a.additionalFile);const i=Ye(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${Je}/articles/`,{method:"POST",headers:l,body:s});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(t){throw new Error("Invalid response format")}}},update:async(e,a,t)=>{if(!t||!t.mainFile&&!t.additionalFile)return He(`/articles/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const t=a[e];null!=t&&(Array.isArray(t)||"object"==typeof t?i.append(e,JSON.stringify(t)):i.append(e,t))}),t.mainFile&&i.append("final_pdf_path",t.mainFile),t.additionalFile&&i.append("additional_document_path",t.additionalFile);const l=Ye(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${Je}/articles/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(s){throw new Error("Invalid response format")}}},delete:e=>He(`/articles/${e}/`,{method:"DELETE"}),incrementViews:e=>He(`/articles/${e}/increment_views/`,{method:"POST"}),incrementDownloads:e=>He(`/articles/${e}/increment_downloads/`,{method:"POST"}),updateStatus:(e,a,t)=>He(`/articles/${e}/update_status/`,{method:"POST",body:JSON.stringify({status:a,reason:t})}),checkPlagiarism:e=>He(`/articles/${e}/check_plagiarism/`,{method:"POST"})},We={listCategories:()=>He("/journals/categories/"),list:()=>He("/journals/journals/"),get:e=>He(`/journals/journals/${e}/`),create:async(e,a)=>{if(!a)return He("/journals/journals/",{method:"POST",body:JSON.stringify(e)});{const s=new FormData;Object.keys(e).forEach(a=>{const t=e[a];null!=t&&(Array.isArray(t)||"object"==typeof t?s.append(a,JSON.stringify(t)):s.append(a,t))}),s.append("image_url",a);const i=Ye(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${Je}/journals/journals/`,{method:"POST",headers:l,body:s});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(t){throw new Error("Invalid response format")}}},update:async(e,a,t)=>{if(!t)return He(`/journals/journals/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const t=a[e];null!=t&&(Array.isArray(t)||"object"==typeof t?i.append(e,JSON.stringify(t)):i.append(e,t))}),i.append("image_url",t);const l=Ye(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${Je}/journals/journals/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(s){throw new Error("Invalid response format")}}},delete:e=>He(`/journals/journals/${e}/`,{method:"DELETE"}),createCategory:e=>He("/journals/categories/",{method:"POST",body:JSON.stringify(e)}),deleteCategory:e=>He(`/journals/categories/${e}/`,{method:"DELETE"}),listIssues:()=>He("/journals/issues/"),createIssue:async(e,a)=>{if(!a)return He("/journals/issues/",{method:"POST",body:JSON.stringify(e)});{const s=new FormData;Object.keys(e).forEach(a=>{const t=e[a];null!=t&&(Array.isArray(t)||"object"==typeof t?s.append(a,JSON.stringify(t)):s.append(a,t))}),s.append("collection_file",a);const i=Ye(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${Je}/journals/issues/`,{method:"POST",headers:l,body:s});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(t){throw new Error("Invalid response format")}}},updateIssue:async(e,a,t)=>{if(!t)return He(`/journals/issues/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const t=a[e];null!=t&&(Array.isArray(t)||"object"==typeof t?i.append(e,JSON.stringify(t)):i.append(e,t))}),i.append("collection_file",t);const l=Ye(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${Je}/journals/issues/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(s){throw new Error("Invalid response format")}}},deleteIssue:e=>He(`/journals/issues/${e}/`,{method:"DELETE"})},Ge={listTransactions:()=>He("/payments/transactions/"),getTransaction:e=>He(`/payments/transactions/${e}/`),createTransaction:e=>He("/payments/transactions/",{method:"POST",body:JSON.stringify(e)}),processPayment:(e,a="click")=>He(`/payments/transactions/${e}/process_payment/?provider=${a}`,{method:"POST"}),preparePayment:e=>He(`/payments/transactions/${e}/prepare_payment/`,{method:"POST"}),checkStatus:e=>He(`/payments/transactions/${e}/check_status/`,{method:"POST"})},Ve={list:()=>He("/translations/"),get:e=>He(`/translations/${e}/`),create:e=>{if(e.file){const a=new FormData;return a.append("source_file_path",e.file),Object.keys(e).forEach(t=>{"file"!==t&&a.append(t,e[t])}),He("/translations/",{method:"POST",body:a,headers:{}})}return He("/translations/",{method:"POST",body:JSON.stringify(e)})},update:(e,a)=>{if(a.file){const t=new FormData;return a.file&&t.append("translated_file_path",a.file),Object.keys(a).forEach(e=>{"file"!==e&&t.append(e,a[e])}),He(`/translations/${e}/`,{method:"PUT",body:t,headers:{}})}return He(`/translations/${e}/`,{method:"PUT",body:JSON.stringify(a)})},delete:e=>He(`/translations/${e}/`,{method:"DELETE"})},ea={list:()=>He("/notifications/"),markRead:e=>He(`/notifications/${e}/mark_read/`,{method:"POST"}),markAllRead:()=>He("/notifications/mark_all_read/",{method:"POST"}),unreadCount:()=>He("/notifications/unread_count/")},aa=e=>e?e.startsWith("http")?e:`https://api.ilmiyfaoliyat.uz/media/${e}`:"",ta=e.createContext({user:null,login:async()=>!1,logout:()=>{},loading:!1,error:null,notifications:[],addNotification:()=>{},markAsRead:()=>{},markAllAsRead:()=>{},unreadCount:0}),sa=({children:t})=>{const s=a(),[i,l]=e.useState(null),[r,n]=e.useState(!0),[o,c]=e.useState(null),[d,m]=e.useState([]),x=e.useRef(Date.now());e.useEffect(()=>{(async()=>{try{if(!localStorage.getItem("access_token"))return void n(!1);try{const a=await Ke.getProfile(),t=(null==a?void 0:a.data)||a;if(!t)throw new Error("No user data in response");const s={id:t.id||"",firstName:t.first_name||t.firstName||"",lastName:t.last_name||t.lastName||"",patronymic:t.patronymic||"",email:t.email||"",phone:t.phone||"",role:t.role||"author",affiliation:t.affiliation||"",gamificationProfile:t.gamification_profile||{level:"Beginner",badges:[],points:0},avatarUrl:t.avatar_url||t.avatarUrl||"",telegramUsername:t.telegram_username||t.telegramUsername||""};l(s);try{const e=await ea.list(),a=(Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:[]).map(e=>({id:e.id,message:e.message,read:e.read,link:e.link||void 0}));m(a)}catch(e){console.error("Failed to fetch notifications:",e)}}catch(a){console.error("Failed to fetch user profile:",a),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s("/login")}}catch(t){console.error("Error in loadUser:",t),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),s("/login")}finally{n(!1)}})()},[s]);const u=e.useCallback(()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),l(null),Ke.logout(),s("/login")},[s]),h=e.useCallback(e=>{const a={...e,id:x.current++,read:!1};m(e=>[a,...e].slice(0,20))},[]),g=e.useCallback(e=>{m(a=>a.map(a=>a.id===e?{...a,read:!0}:a)),ea.markRead(e.toString()).catch(e=>{console.error("Failed to mark notification as read on backend:",e)})},[]),p=e.useCallback(()=>{m(e=>e.map(e=>({...e,read:!0}))),ea.markAllRead().catch(e=>{console.error("Failed to mark all notifications as read on backend:",e)})},[]),f=d.filter(e=>!e.read).length,j={user:i,login:async(e,a)=>{var t;n(!0),c(null);try{const t=e.replace(/^\+/,"").replace(/\s/g,"").replace(/\D/g,"");if(!t||t.length<9||t.length>12)return c("Iltimos, to'g'ri telefon raqamni kiriting (9-12 ta raqam)."),n(!1),!1;if(!a||0===a.trim().length)return c("Iltimos, parolni kiriting."),n(!1),!1;const r=await Ke.login(t,a),o=(null==r?void 0:r.data)||r,d=(null==o?void 0:o.access)||(null==o?void 0:o.access_token),m=(null==o?void 0:o.refresh)||(null==o?void 0:o.refresh_token),x=(null==o?void 0:o.user)||o;if(d){if(localStorage.setItem("access_token",d),m&&localStorage.setItem("refresh_token",m),null==x?void 0:x.id){const a={id:x.id,firstName:x.first_name||x.firstName||"",lastName:x.last_name||x.lastName||"",patronymic:x.patronymic||"",email:x.email||"",phone:x.phone||e,role:x.role||"author",affiliation:x.affiliation||"",gamificationProfile:x.gamification_profile||x.gamificationProfile||{level:"Beginner",badges:[],points:0},avatarUrl:x.avatar_url||x.avatarUrl||"",telegramUsername:x.telegram_username||x.telegramUsername||""};return l(a),s("/dashboard"),!0}try{const a=await Ke.getProfile();if(null==a?void 0:a.data){const t=a.data,s={id:t.id,firstName:t.first_name||t.firstName||"",lastName:t.last_name||t.lastName||"",patronymic:t.patronymic||"",email:t.email||"",phone:t.phone||e,role:t.role||"author",affiliation:t.affiliation||"",gamificationProfile:t.gamification_profile||{level:"Beginner",badges:[],points:0},avatarUrl:t.avatar_url||t.avatarUrl||"",telegramUsername:t.telegram_username||t.telegramUsername||""};l(s)}return s("/dashboard"),!0}catch(i){return console.error("Failed to fetch user profile:",i),s("/dashboard"),!0}}return c("Server response did not include access token"),!1}catch(r){let e="Login failed. Please check your credentials.";if(null==(t=null==r?void 0:r.response)?void 0:t.data){const a=r.response.data;e=a.detail||a.message||JSON.stringify(a)}else(null==r?void 0:r.message)?e=r.message:"string"==typeof r&&(e=r);return c(e),!1}finally{n(!1)}},logout:u,loading:r,error:o,notifications:d,addNotification:h,markAsRead:g,markAllAsRead:p,unreadCount:f};return e.createElement(ta.Provider,{value:j},t)},ia=()=>{const a=e.useContext(ta);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a},la=()=>{const{notifications:e,addNotification:a,markAsRead:t,markAllAsRead:s,unreadCount:i}=ia();return{notifications:e,addNotification:a,markAsRead:t,markAllAsRead:s,unreadCount:i}};var ra=(e=>(e.Author="author",e.Reviewer="reviewer",e.JournalAdmin="journal_admin",e.SuperAdmin="super_admin",e.Accountant="accountant",e))(ra||{}),na=(e=>(e.Draft="Qoralama",e.Yangi="Yangi",e.WithEditor="Redaktorda",e.QabulQilingan="Qabul Qilingan",e.WritingInProgress="Yozish jarayonida",e.NashrgaYuborilgan="Nashrga Yuborilgan",e.Revision="Tahrirga qaytarilgan",e.Accepted="Qabul qilingan",e.Rejected="Rad etilgan",e.Published="Nashr etilgan",e))(na||{}),oa=(e=>(e.Yangi="Yangi",e.Jarayonda="Jarayonda",e.Bajarildi="Bajarildi",e.BekorQilindi="Bekor Qilindi",e))(oa||{}),ca=(e=>(e.PrePayment="pre-payment",e.PostPayment="post-payment",e))(ca||{}),da=(e=>(e.Fixed="fixed",e.PerPage="per_page",e))(da||{});const ma={[ra.Author]:"Muallif",[ra.Reviewer]:"Taqrizchi",[ra.JournalAdmin]:"Jurnal administratori",[ra.SuperAdmin]:"Bosh administrator",[ra.Accountant]:"Moliyachi"},xa={[ra.Author]:[{to:"/dashboard",icon:t,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Maqolalarim"},{to:"/submit",icon:c,label:"Maqola yuborish"},{to:"/my-collections",icon:d,label:"To'plamlarim"},{to:"/my-translations",icon:m,label:"Tarjimalarim"},{to:"/services",icon:x,label:"Xizmatlar"}],[ra.Reviewer]:[{to:"/dashboard",icon:t,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Taqrizga kelganlar"}],[ra.JournalAdmin]:[{to:"/dashboard",icon:t,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/published-articles",icon:o,label:"Nashr etilganlar"}],[ra.SuperAdmin]:[{to:"/dashboard",icon:t,label:"Boshqaruv paneli"},{to:"/users",icon:i,label:"Foydalanuvchilar"},{to:"/articles",icon:l,label:"Barcha maqolalar"},{to:"/journal-management",icon:r,label:"Jurnallar"},{to:"/udk-requests",icon:n,label:"UDK so'rovlari"}],[ra.Accountant]:[{to:"/dashboard",icon:t,label:"Boshqaruv paneli"},{to:"/financials",icon:s,label:"Moliya"}]},ua=()=>{var t,s;const{user:i,logout:l}=ia(),{notifications:r,unreadCount:n,markAsRead:o,markAllAsRead:c}=la(),[d,m]=e.useState(!1),x=a(),j=e.useRef(null),b=i&&xa[i.role]||[];if(e.useEffect(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[j]),!i)return null;return u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between px-4 sm:px-6 h-20 bg-black/20 backdrop-blur-lg border-b border-white/10 sticky top-0 z-30",children:[u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs(h,{to:"/dashboard",className:"text-2xl font-bold text-white tracking-wider flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center text-xl shadow-md",children:"P"}),u.jsx("span",{className:"hidden lg:block",children:"PINM"})]}),u.jsx("nav",{className:"hidden md:flex items-center gap-2",children:b.map(e=>u.jsxs(g,{to:e.to,className:({isActive:e})=>e?"flex items-center px-3 py-2 text-sm font-medium text-white bg-blue-500/20 rounded-lg":"flex items-center px-3 py-2 text-sm font-medium text-gray-300 rounded-lg hover:bg-white/10 transition-colors",children:[u.jsx(e.icon,{className:"w-5 h-5 mr-2"}),u.jsx("span",{children:e.label})]},e.to))})]}),u.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>m(e=>!e),className:"text-gray-300 hover:text-white focus:outline-none transition-colors p-2 rounded-full hover:bg-white/10","aria-label":"Bildirishnomalar",children:[u.jsx(p,{size:22}),n>0&&u.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]}),d&&u.jsxs("div",{ref:j,className:"absolute right-0 mt-3 w-80 max-h-96 overflow-y-auto bg-black/50 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl z-50",children:[u.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[u.jsx("h4",{className:"font-semibold text-white",children:"Bildirishnomalar"}),r.length>0&&u.jsx("button",{onClick:e=>{e.stopPropagation(),c()},className:"text-xs text-blue-400 hover:text-blue-300 transition-colors",children:"Hammasini o'qilgan deb belgilash"})]}),r.length>0?u.jsx("ul",{className:"divide-y divide-white/10",children:r.map(e=>u.jsx("li",{onClick:()=>{return o((a=e).id),a.link&&x(a.link),void m(!1);var a},className:"p-4 text-sm cursor-pointer hover:bg-white/5 transition-colors "+(e.read?"":"bg-blue-500/10"),children:u.jsx("p",{className:"text-gray-200 leading-relaxed",children:e.message})},e.id))}):u.jsx("p",{className:"p-6 text-center text-sm text-gray-400",children:"Yangi bildirishnomalar yo'q."})]})]}),u.jsxs(h,{to:"/profile",className:"flex items-center p-1.5 rounded-full hover:bg-white/10 transition-colors",children:[i.avatarUrl?u.jsx("img",{className:"h-9 w-9 sm:h-10 sm:w-10 rounded-full object-cover border-2 border-white/20",src:i.avatarUrl,alt:`${i.firstName} ${i.lastName}`}):u.jsxs("div",{className:"h-9 w-9 sm:h-10 sm:w-10 rounded-full bg-blue-500/20 border-2 border-white/20 flex items-center justify-center text-white font-semibold",children:[null==(t=i.firstName)?void 0:t.charAt(0),(null==(s=i.lastName)?void 0:s.charAt(0))||"U"]}),u.jsxs("div",{className:"mx-2 sm:mx-4 text-right hidden md:block",children:[u.jsxs("p",{className:"text-sm font-semibold text-white",children:[i.firstName," ",i.lastName]}),u.jsx("p",{className:"text-xs text-gray-400",children:ma[i.role]})]})]}),u.jsx("button",{onClick:l,className:"text-gray-300 hover:text-red-400 focus:outline-none transition-colors p-2.5 rounded-full hover:bg-white/10","aria-label":"Chiqish",children:u.jsx(f,{size:20})})]})]})},ha=()=>{const{user:e}=ia();if(!e)return null;const a={[ra.Author]:[{to:"/dashboard",icon:t,label:"Asosiy"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/submit",icon:c,label:"Yuborish"},{to:"/my-translations",icon:m,label:"Tarjimalar"},{to:"/profile",icon:j,label:"Profilim"}],[ra.Reviewer]:[{to:"/dashboard",icon:t,label:"Asosiy"},{to:"/articles",icon:l,label:"Taqrizlar"},{to:"/profile",icon:j,label:"Profilim"}],[ra.JournalAdmin]:[{to:"/dashboard",icon:t,label:"Asosiy"},{to:"/articles",icon:l,label:"Kutayotganlar"},{to:"/published-articles",icon:o,label:"Nashrlar"}],[ra.SuperAdmin]:[{to:"/dashboard",icon:t,label:"Asosiy"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/users",icon:i,label:"Foydalanuvchilar"},{to:"/journal-management",icon:r,label:"Jurnallar"}],[ra.Accountant]:[{to:"/dashboard",icon:t,label:"Asosiy"},{to:"/financials",icon:s,label:"Moliya"},{to:"/profile",icon:j,label:"Profilim"}]}[e.role]||[];return u.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-20 bg-black/30 backdrop-blur-xl border-t border-white/10 flex justify-around items-center z-40",children:a.map(e=>u.jsxs(g,{to:e.to,className:({isActive:e})=>"flex flex-col items-center justify-center text-center text-gray-400 hover:text-blue-400 transition-colors w-full h-full "+(e?"text-blue-400":""),children:[u.jsx(e.icon,{className:"w-7 h-7 mb-1"}),u.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.to))})},ga=()=>{const e="DIQQAT! Phoenix Ilmiy Nashriyot Markazining yangi platformasi sinov (demo) rejimida ishlamoqda. Taklif va kamchiliklar yuzasidan murojaat uchun telefon: +998 (94) 743-09-12";return u.jsx("div",{className:"scrolling-banner-container","aria-live":"polite",children:u.jsxs("div",{className:"scrolling-banner-inner",children:[u.jsx("span",{children:e}),u.jsx("span",{"aria-hidden":"true",children:e})]})})},pa=()=>u.jsxs("div",{className:"flex flex-col h-screen bg-transparent",children:[u.jsx(ga,{}),u.jsx(ua,{}),u.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto p-6 md:p-8 pb-24 md:pb-8",children:u.jsx(b,{})}),u.jsx("div",{className:"md:hidden",children:u.jsx(ha,{})})]}),fa=({children:e,className:a="",title:t})=>u.jsxs("div",{className:`bg-black/20 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-lg p-6 sm:p-8 transition-all duration-300 hover:shadow-2xl hover:border-white/20 ${a}`,children:[t&&u.jsx("h3",{className:"text-xl font-bold text-white mb-6 border-b border-white/10 pb-4",children:t}),e]}),ja=({children:e,variant:a="primary",isLoading:t=!1,...s})=>u.jsxs("button",{className:`px-6 py-3 font-semibold rounded-full focus:outline-none focus:ring-4 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center transform active:scale-95 shadow-md hover:shadow-lg ${{primary:"bg-blue-600 text-white hover:bg-blue-500 focus:ring-blue-500/50",secondary:"bg-white/10 text-white hover:bg-white/20 focus:ring-white/30 backdrop-blur-md border border-white/10",danger:"bg-red-600 text-white hover:bg-red-500 focus:ring-red-500/50"}[a]}`,disabled:t||s.disabled,...s,children:[t&&u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e]}),ba=({icon:e,title:a,value:t,gradient:s,to:i})=>{const l=u.jsxs(fa,{className:"!p-0 overflow-hidden relative h-full transition-transform transform hover:scale-105 hover:shadow-xl",children:[u.jsx("div",{className:`absolute -top-4 -right-4 w-20 h-20 opacity-10 ${s} rounded-full blur-2xl`}),u.jsxs("div",{className:"p-6 flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl mr-5 bg-white/10",children:u.jsx(e,{className:"h-7 w-7 text-white"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-3xl font-bold text-white",children:t}),u.jsx("p",{className:"text-sm text-gray-400 capitalize",children:a})]})]}),u.jsx("div",{className:`h-1.5 ${s}`})]});return i?u.jsx(h,{to:i,className:"block",children:l}):l},ya=()=>{const{user:t}=ia(),r=a(),[n,c]=e.useState([]),[d,m]=e.useState([]),[x,h]=e.useState([]),[g,p]=e.useState([]),[f,j]=e.useState(null),[b,z]=e.useState(!0),[C,P]=e.useState(null);if(e.useEffect(()=>{(async()=>{if(t)try{z(!0),P(null);let a=[];if(t.role===ra.SuperAdmin)try{const e=await Xe.list();a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:[]}catch(e){console.error("Failed to fetch users:",e),a=[]}const[s,i,l]=await Promise.all([Ze.list(),We.list(),Ge.listTransactions()]),r=e=>Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],n=r(s),o=r(i),d=r(l),x=r(a);if(c(n),m(o),h(x),p(d),t.role===ra.SuperAdmin)try{const e=await Xe.stats();j(e)}catch(e){console.error("Failed to fetch stats:",e)}}catch(a){P((null==a?void 0:a.message)||"Boshqaruv paneli ma'lumotlarini yuklashda xatolik. Iltimos, keyinroq urinib ko'ring.")}finally{z(!1)}})()},[t]),!t)return null;if(b)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(C)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:C}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const I={"fast-track":"Tezkor ko'rib chiqish",publication_fee:"Nashr haqi",language_editing:"Tilni tahrirlash",top_up:"Hisobni to'ldirish",book_publication:"Kitob nashri",translation:"Tarjima"};switch(t.role){case"author":return(()=>{const e=(Array.isArray(n)?n:[]).filter(e=>e.author===t.id),a=e.filter(e=>"QabulQilingan"===e.status).length,s=e.filter(e=>"Published"===e.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",t.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Bu yerdan o'z faoliyatingizni kuzatib borishingiz mumkin."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(ba,{icon:l,title:"Jami maqolalar",value:e.length,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(ba,{icon:A,title:"Ko'rib chiqilmoqda",value:a,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(ba,{icon:o,title:"Nashr etilgan",value:s,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/articles"})]})]})})();case"reviewer":return(()=>{const e=Array.isArray(n)?n:[],a=e.filter(e=>"QabulQilingan"===e.status).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0)),s=e.filter(e=>"QabulQilingan"===e.status);return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",t.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Taqrizchi sifatida faoliyatingizni boshqaring."}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx(ba,{icon:w,title:"Yangi so'rovlar",value:a.length,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(ba,{icon:k,title:"Jarayonda",value:s.length,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(ba,{icon:o,title:"Bajarilgan",value:t.reviewsCompleted||0,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/profile"}),u.jsx(ba,{icon:v,title:"O'rtacha vaqt",value:`${t.averageReviewTime||0} kun`,gradient:"bg-gradient-to-r from-purple-500 to-indigo-400",to:"/profile"})]}),u.jsx(fa,{title:"Yangi so'rovlar",children:u.jsx("div",{className:"space-y-4",children:a.length>0?a.map(e=>{const a=x.find(a=>a.id===e.author),t=d.find(a=>a.id===e.journal);return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-3",children:[e.fast_track&&u.jsxs("span",{className:"text-xs font-bold px-2.5 py-1 rounded-full whitespace-nowrap bg-yellow-500/20 text-yellow-300 flex items-center gap-1.5",children:[u.jsx(_,{size:14})," TOP"]}),u.jsx("p",{className:"font-semibold text-blue-400",children:e.title})]}),u.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Muallif: ",a?`${a.first_name} ${a.last_name}`:"Noma'lum"," | Jurnal: ",t?t.name:"Noma'lum"]})]}),u.jsxs(ja,{onClick:()=>r(`/articles/${e.id}`),variant:"secondary",className:"w-full sm:w-auto",children:["Ko'rib chiqish ",u.jsx(N,{className:"ml-2 h-4 w-4"})]})]},e.id)}):u.jsx("p",{className:"text-center text-gray-400 py-8",children:"Hozircha ko'rib chiqish uchun yangi so'rovlar yo'q."})})})]})})();case"journal_admin":return(()=>{const e=d.filter(e=>e.journal_admin===t.id).map(e=>e.id),a=Array.isArray(n)?n:[],s=a.filter(a=>e.includes(a.journal)&&"NashrgaYuborilgan"===a.status).length,i=a.filter(a=>e.includes(a.journal)&&"Yangi"===a.status).length,l=a.filter(a=>e.includes(a.journal)&&"Published"===a.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Jurnal administratori paneli"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx(ba,{icon:w,title:"Yangi Kelganlar",value:i,gradient:"bg-gradient-to-r from-cyan-500 to-blue-400",to:"/articles"}),u.jsx(ba,{icon:k,title:"Nashrni kutmoqda",value:s,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(ba,{icon:o,title:"Jami nashrlar",value:l,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/published-articles"})]})]})})();case"super_admin":return(()=>{var e,a,t,r,c,m,h,p,j;const b=Array.isArray(g)?g:[],y=(null==(e=null==f?void 0:f.finance)?void 0:e.total_revenue)||b.filter(e=>"top_up"!==e.service_type&&"completed"===e.status).reduce((e,a)=>e+Math.abs(a.amount),0),v=(null==(a=null==f?void 0:f.users)?void 0:a.total)||x.length,N=(null==(t=null==f?void 0:f.users)?void 0:t.authors)||x.filter(e=>e.role===ra.Author||"author"===e.role).length,_=(null==(r=null==f?void 0:f.users)?void 0:r.reviewers)||x.filter(e=>e.role===ra.Reviewer||"reviewer"===e.role).length,A=Array.isArray(n)?n:[],z=(null==(c=null==f?void 0:f.articles)?void 0:c.total)||A.length,C=(null==(m=null==f?void 0:f.articles)?void 0:m.new_submissions)||A.filter(e=>"Yangi"===e.status||"WithEditor"===e.status).length,P=(null==(h=null==f?void 0:f.articles)?void 0:h.in_review)||A.filter(e=>"QabulQilingan"===e.status).length,I=(null==(p=null==f?void 0:f.articles)?void 0:p.published)||A.filter(e=>"Published"===e.status).length,M=(null==(j=null==f?void 0:f.articles)?void 0:j.rejected)||A.filter(e=>"Rejected"===e.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Umumiy platforma statistikasi"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(ba,{icon:s,title:"Jami tushum",value:`${(y/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/financials"}),u.jsx(ba,{icon:i,title:"Jami foydalanuvchilar",value:v,gradient:"bg-gradient-to-r from-indigo-500 to-violet-400",to:"/users"}),u.jsx(ba,{icon:l,title:"Jami maqolalar",value:z,gradient:"bg-gradient-to-r from-purple-500 to-pink-400",to:"/articles"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Maqolalar holati bo'yicha statistika"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[u.jsx(ba,{icon:w,title:"Yangi kelganlar",value:C,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(ba,{icon:k,title:"Taqrizda",value:P,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(ba,{icon:o,title:"Nashr etilgan",value:I,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/articles"}),u.jsx(ba,{icon:q,title:"Rad etilgan",value:M,gradient:"bg-gradient-to-r from-red-500 to-rose-400",to:"/articles"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Foydalanuvchilar taqsimoti"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[u.jsx(ba,{icon:S,title:"Mualliflar",value:N,gradient:"bg-gradient-to-r from-gray-500 to-gray-400",to:"/users"}),u.jsx(ba,{icon:T,title:"Taqrizchilar",value:_,gradient:"bg-gradient-to-r from-gray-500 to-gray-400",to:"/users"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Jurnal administratorlari statistikasi"}),u.jsx("div",{className:"space-y-4",children:x.filter(e=>e.role===ra.JournalAdmin||"journal_admin"===e.role).map(e=>{const a=d.filter(a=>a.journal_admin===e.id||a.journalAdminId===e.id).map(e=>e.id),t=A.filter(e=>a.includes(e.journal)&&"Published"===e.status).length;return u.jsx(fa,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:e.avatar_url||e.avatarUrl,className:"h-12 w-12 rounded-full object-cover",alt:`${e.firstName||e.first_name} avatar`}),u.jsxs("div",{className:"ml-4",children:[u.jsxs("p",{className:"font-semibold text-white",children:[e.firstName||e.first_name," ",e.lastName||e.last_name]}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Nashrlar soni: ",u.jsx("span",{className:"font-bold text-white",children:t})]})]})]})},e.id)})})]})]})})();case"accountant":return(()=>{const e=Array.isArray(g)?g:[],a=e.filter(e=>"completed"===e.status&&"top_up"!==e.service_type),t=a.reduce((e,a)=>e+Math.abs(a.amount),0),i=(new Date).toISOString().split("T")[0],n=a.filter(e=>new Date(e.created_at).toISOString().split("T")[0]===i),o=n.reduce((e,a)=>e+Math.abs(a.amount),0),c=new Date;c.setDate(c.getDate()-7);const d=a.filter(e=>new Date(e.created_at)>=c).reduce((e,a)=>e+Math.abs(a.amount),0);return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Moliyachi Boshqaruv Paneli"}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Platformaning moliyaviy holatini kuzatib boring."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx(ba,{icon:s,title:"Jami Tushum",value:`${(t/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/financials"}),u.jsx(ba,{icon:y,title:"Bugungi Tushum",value:`${o.toLocaleString()} so'm`,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/financials"}),u.jsx(ba,{icon:l,title:"Bugungi Tranzaksiyalar",value:n.length,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/financials"}),u.jsx(ba,{icon:v,title:"Haftalik Tushum",value:`${(d/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-purple-500 to-indigo-400",to:"/financials"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx(fa,{title:"So'ngi Tranzaksiyalar",children:u.jsxs("div",{className:"space-y-4",children:[e.slice(0,5).map(e=>{const a=x.find(a=>a.id===e.user),t=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi";return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:t}),u.jsx("p",{className:"text-sm text-gray-400",children:I[e.service_type]||e.service_type||"Noma'lum xizmat"})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-medium "+(e.amount>=0?"text-green-400":"text-red-400"),children:[e.amount>=0?"+":"",e.amount.toLocaleString()," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id)}),0===e.length&&u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Hozircha tranzaksiyalar mavjud emas."})]})}),u.jsx(fa,{title:"To'lov Statistikasi",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Muvaffaqiyatli to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"completed"===e.status).length})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Kutilayotgan to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"pending"===e.status).length})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Muvaffaqiyatsiz to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"failed"===e.status).length})]}),u.jsx("div",{className:"pt-4 mt-4 border-t border-white/10",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Umumiy tranzaksiyalar"}),u.jsx("span",{className:"font-bold text-white",children:e.length})]})})]})})]}),u.jsx(fa,{title:"Tezkor Amallar",children:u.jsx("div",{className:"flex flex-wrap gap-4 justify-center",children:u.jsxs(ja,{onClick:()=>r("/financials"),variant:"secondary",children:["Batafsil Moliyaviy Hisobot ",u.jsx(N,{className:"ml-2 h-4 w-4"})]})})})]})})();default:return u.jsxs(fa,{children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",t.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 mt-2",children:"PINM tizimiga xush kelibsiz. Ishlaringizni boshqarish uchun yon menyudan foydalaning."})]})}},va=()=>u.jsx("div",{className:"flex flex-col items-center w-20 h-20 justify-center",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:"logoGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#0D2A4F"}),u.jsx("stop",{offset:"100%",stopColor:"#3A527A"})]})}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"url(#logoGrad)"}),u.jsx("path",{d:"M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z",fill:"#C09D58"})]})}),Na=()=>u.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center drop-shadow-lg",children:[u.jsxs("svg",{viewBox:"0 0 100 100",className:"absolute w-full h-full text-[#C09D58]",children:[u.jsxs("defs",{children:[u.jsxs("radialGradient",{id:"sealGrad",cx:"50%",cy:"50%",r:"50%",fx:"25%",fy:"25%",children:[u.jsx("stop",{offset:"0%",stopColor:"#FDEEBE"}),u.jsx("stop",{offset:"100%",stopColor:"#A47D3A"})]}),u.jsx("filter",{id:"sealShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:u.jsx("feDropShadow",{dx:"1",dy:"2",stdDeviation:"1",floodColor:"#000",floodOpacity:"0.3"})})]}),u.jsx("path",{d:"M50 0 L61.8 38.2 L100 38.2 L69.1 61.8 L80.9 100 L50 76.4 L19.1 100 L30.9 61.8 L0 38.2 L38.2 38.2 Z",fill:"url(#sealGrad)",filter:"url(#sealShadow)"})]}),u.jsx("div",{className:"absolute w-[80%] h-[80%] rounded-full bg-gradient-to-br from-[#d4af6a] to-[#b48c4a]",style:{boxShadow:"inset 0 0 10px rgba(0,0,0,0.3)"}}),u.jsxs("svg",{viewBox:"0 0 100 100",className:"absolute w-[75%] h-[75%]",children:[u.jsx("path",{id:"circlePath",d:"M 10, 50 a 40,40 0 1,1 80,0 a 40,40 0 1,1 -80,0",fill:"none"}),u.jsx("text",{fill:"#8b6b33",className:"text-[7px] font-bold tracking-widest uppercase",children:u.jsx("textPath",{href:"#circlePath",startOffset:"50%",textAnchor:"middle",children:"PHOENIX SCIENTIFIC • AUTHENTIC DOCUMENT •"})})]}),u.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute text-[#8b6b33]/80",children:u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z",fill:"currentColor"})})]}),wa=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsxs("defs",{children:[u.jsx("pattern",{id:"guilloche1",patternUnits:"userSpaceOnUse",width:"50",height:"50",children:u.jsx("path",{d:"M 50,25 C 50,38.807 38.807,50 25,50 C 11.193,50 0,38.807 0,25 C 0,11.193 11.193,0 25,0 C 38.807,0 50,11.193 50,25 Z M 25,10 a 15,15 0 1,0 0,30 a 15,15 0 1,0 0,-30",stroke:"#0D2A4F",strokeWidth:"0.25",fill:"none",opacity:"0.1"})}),u.jsx("pattern",{id:"guilloche2",patternUnits:"userSpaceOnUse",width:"30",height:"30",patternTransform:"rotate(45)",children:u.jsx("path",{d:"M0 0 H15 V15 H0Z M15 15 H30 V30 H15Z",fill:"#C09D58",opacity:"0.05"})}),u.jsxs("radialGradient",{id:"parchment",children:[u.jsx("stop",{offset:"0%",stopColor:"#FDFBF5"}),u.jsx("stop",{offset:"100%",stopColor:"#F5F1E8"})]}),u.jsxs("linearGradient",{id:"borderGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#0D2A4F"}),u.jsx("stop",{offset:"100%",stopColor:"#3A527A"})]}),u.jsx("path",{id:"microtextPath",d:"M60 40 H1120 V750 H60 Z"})]}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#parchment)"}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#guilloche1)"}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#guilloche2)"}),u.jsx("g",{transform:"translate(595 395) scale(6)",opacity:"0.03",fill:"#0D2A4F",children:u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z"})}),u.jsxs("g",{stroke:"url(#borderGrad)",fill:"none",strokeWidth:"1",children:[u.jsx("rect",{x:"30",y:"25",width:"1120",height:"740",rx:"10"}),u.jsx("path",{d:"M 40,35 H 1110 V 730 H 40 Z",strokeWidth:"0.5",strokeDasharray:"5 5",opacity:"0.5"}),u.jsx("path",{d:"M 50,45 a 10,10 0 0,1 10,-10 H 1100 a 10,10 0 0,1 10,10 V 720 a 10,10 0 0,1 -10,10 H 60 a 10,10 0 0,1 -10,-10 Z",strokeWidth:"2.5"})]}),u.jsxs("g",{fill:"url(#borderGrad)",opacity:"0.8",children:[u.jsx("path",{transform:"translate(50, 45)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(1130, 45) scale(-1, 1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(50, 755) scale(1, -1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(1130, 755) scale(-1, -1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"})]}),u.jsx("text",{fill:"#0D2A4F",fontSize:"3",opacity:"0.5",letterSpacing:"1",children:u.jsxs("textPath",{href:"#microtextPath",children:[u.jsx("tspan",{children:"PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"})]})})]}),ka=[{id:"journal-1",name:"Iqtisodiyot va Innovatsion Texnologiyalar",issn:"2091-5946",description:"Iqtisodiyot sohasidagi ilmiy tadqiqotlar va zamonaviy texnologiyalarning iqtisodiy jarayonlarga ta'siri.",journalAdminId:"user-4",publicationFee:2e5,categoryId:"cat-1",imageUrl:"https://picsum.photos/seed/journal1/400/200",paymentModel:ca.PostPayment,pricingType:da.Fixed,additionalDocumentConfig:{required:!0,label:"Taqriz fayli",type:"file"},issueIds:["issue-1"]},{id:"journal-2",name:"Texnika Fanlari Axborotnomasi",issn:"1234-5678",description:"Muhandislik va texnika sohasidagi yangiliklar, ixtirolar va ilmiy-texnikaviy yechimlar tahlili.",journalAdminId:"user-4",pricePerPage:15e3,categoryId:"cat-2",imageUrl:"https://picsum.photos/seed/journal2/400/200",paymentModel:ca.PrePayment,pricingType:da.PerPage,additionalDocumentConfig:{required:!1,label:"",type:"file"}},{id:"journal-3",name:"Tibbiyot va Salomatlik",issn:"8765-4321",description:"Sog'liqni saqlash sohasidagi eng so'nggi yutuqlar, klinik tadqiqotlar va tibbiy amaliyotga oid maqolalar.",journalAdminId:"user-4",publicationFee:25e4,categoryId:"cat-3",imageUrl:"https://picsum.photos/seed/journal3/400/200",paymentModel:ca.PostPayment,pricingType:da.Fixed,additionalDocumentConfig:{required:!0,label:"Tavsiyanoma havolasi",type:"link"}},{id:"journal-4",name:"Filologiya Masalalari",issn:"4567-1238",description:"Tilshunoslik va adabiyotshunoslikka oid ilmiy maqolalar, tahliliy sharhlar va tadqiqotlar majmuasi.",journalAdminId:"user-4",pricePerPage:12e3,categoryId:"cat-4",imageUrl:"https://picsum.photos/seed/journal4/400/200",paymentModel:ca.PrePayment,pricingType:da.PerPage,additionalDocumentConfig:{required:!1,label:"",type:"file"}}];na.Published,na.QabulQilingan,na.Yangi,na.NashrgaYuborilgan,oa.Bajarildi,oa.Jarayonda,oa.Yangi,[{id:"log-1-1",articleId:"article-1",timestamp:"2025-09-15T10:00:00Z",userId:"user-1",action:"Maqola yuborildi"},{id:"log-1-2",articleId:"article-1",timestamp:"2025-09-16T14:30:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.QabulQilingan}`},{id:"log-1-3",articleId:"article-1",timestamp:"2025-09-22T09:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.Accepted}`},{id:"log-1-4",articleId:"article-1",timestamp:"2025-09-22T11:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.NashrgaYuborilgan}`},{id:"log-1-5",articleId:"article-1",timestamp:"2025-09-25T18:00:00Z",userId:"user-4",action:"Maqola nashr etildi"},{id:"log-2-1",articleId:"article-2",timestamp:"2025-10-20T11:20:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-2-2",articleId:"article-2",timestamp:"2025-10-21T16:00:00Z",userId:"user-2",action:"So'rov qabul qilindi",details:"Taqrizchi Gulnora Saidova"},{id:"log-2-3",articleId:"article-2",timestamp:"2025-10-21T16:05:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.QabulQilingan}`},{id:"log-3-1",articleId:"article-3",timestamp:"2025-11-10T08:45:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-4-1",articleId:"article-4",timestamp:"2025-11-15T12:00:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-4-2",articleId:"article-4",timestamp:"2025-11-16T10:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.QabulQilingan}`},{id:"log-4-3",articleId:"article-4",timestamp:"2025-11-20T15:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${na.NashrgaYuborilgan}`}].sort((e,a)=>new Date(a.timestamp).getTime()-new Date(e.timestamp).getTime());const qa=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsx("rect",{width:"100%",height:"100%",fill:"#ffffff"}),u.jsx("g",{transform:"translate(420 297) rotate(15) scale(2.5)",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-[#3A527A]",opacity:"0.03",children:[u.jsx("path",{d:"M16.88,7.31c-2.39-2.39-6.26-2.39-8.65,0L12,11.06L16.88,7.31z",fill:"currentColor",opacity:"0.5"}),u.jsx("path",{d:"M11.06,12l-3.75,3.75c2.39,2.39,6.26,2.39,8.65,0l-4.9-4.9V12z",fill:"currentColor"}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"currentColor"})]})})]}),Sa=({articles:e,author:a})=>u.jsxs("div",{className:"bg-white text-gray-800 aspect-[210/297] w-full max-w-4xl mx-auto shadow-lg overflow-hidden relative font-sans p-2 print:shadow-none",children:[u.jsx(qa,{}),u.jsx("div",{className:"absolute inset-4 border border-gray-400 p-1",children:u.jsx("div",{className:"w-full h-full border border-gray-300"})}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-16 py-12",children:[u.jsxs("header",{className:"flex flex-col items-center w-full pb-4",children:[u.jsx(va,{}),u.jsx("p",{className:"font-serif text-md text-slate-700 tracking-widest uppercase mt-2",children:"Phoenix Ilmiy Nashrlar Markazi"})]}),u.jsx("h1",{className:"font-serif text-4xl font-bold text-[#3A527A] tracking-wide my-6 text-center",children:"MAQOLALAR BO'YICHA MA'LUMOTNOMA"}),u.jsxs("main",{className:"flex-grow text-base text-slate-800",children:[u.jsxs("div",{className:"mb-6 text-sm",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Muallif:"})," ",a.lastName," ",a.firstName," ",a.patronymic]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tashkilot:"})," ",a.affiliation]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Sana:"})," ",(new Date).toLocaleDateString("uz-UZ")]})]}),u.jsx("div",{className:"overflow-auto border border-gray-300 rounded-lg",children:u.jsxs("table",{className:"min-w-full text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700 w-8",children:"№"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Sarlavha"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Jurnal"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Sana"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Holati"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map((e,a)=>{const t=ka.find(a=>a.id===e.journalId),s=(i=e.status,{[na.Draft]:{text:"Qoralama",color:"text-gray-600"},[na.Yangi]:{text:"Yangi",color:"text-blue-600"},[na.WithEditor]:{text:"Redaktorda",color:"text-indigo-600"},[na.QabulQilingan]:{text:"Qabul Qilingan",color:"text-yellow-700"},[na.Revision]:{text:"Tahrirda",color:"text-orange-600"},[na.Accepted]:{text:"Ma'qullangan",color:"text-teal-600"},[na.Published]:{text:"Nashr etilgan",color:"text-green-700"},[na.Rejected]:{text:"Rad etilgan",color:"text-red-600"},[na.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"text-purple-600"},[na.WritingInProgress]:{text:"Yozilmoqda",color:"text-cyan-600"}}[i]||{text:i,color:"text-gray-600"});var i;return u.jsxs("tr",{children:[u.jsx("td",{className:"p-2 align-top",children:a+1}),u.jsx("td",{className:"p-2 align-top font-medium text-gray-800",children:e.title}),u.jsx("td",{className:"p-2 align-top text-gray-600",children:(null==t?void 0:t.name)||"-"}),u.jsx("td",{className:"p-2 align-top text-gray-600 whitespace-nowrap",children:new Date(e.submissionDate).toLocaleDateString("uz-UZ")}),u.jsx("td",{className:`p-2 align-top font-semibold ${s.color}`,children:s.text})]},e.id)})})]})})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-6 mt-auto",children:[u.jsx("div",{className:"text-left text-xs text-slate-500",children:u.jsx("p",{children:"PINM tizimi orqali yaratildi."})}),u.jsx(Na,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-12 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"})]})]})]})]}),Ta=e=>({id:e.id,title:e.title,abstract:e.abstract,keywords:e.keywords,status:e.status,authorId:e.author,journalId:e.journal,submissionDate:e.submission_date,fastTrack:e.fast_track,versions:[],analytics:{views:e.views,downloads:e.downloads,citations:0}}),_a=e=>({[na.Draft]:{text:"Qoralama",color:"bg-gray-500/20 text-gray-300"},[na.Yangi]:{text:"Yangi",color:"bg-blue-500/20 text-blue-300"},[na.WithEditor]:{text:"Redaktorda",color:"bg-indigo-500/20 text-indigo-300"},[na.QabulQilingan]:{text:"Qabul Qilingan",color:"bg-yellow-500/20 text-yellow-300"},[na.Revision]:{text:"Tahrirga qaytarilgan",color:"bg-orange-500/20 text-orange-300"},[na.Accepted]:{text:"Ma'qullangan",color:"bg-teal-500/20 text-teal-300"},[na.Published]:{text:"Nashr etilgan",color:"bg-green-500/20 text-green-300"},[na.Rejected]:{text:"Rad etilgan",color:"bg-red-500/20 text-red-300"},[na.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"bg-purple-500/20 text-purple-300"},[na.WritingInProgress]:{text:"Yozilmoqda",color:"bg-cyan-500/20 text-cyan-300"},[oa.Jarayonda]:{text:"Jarayonda",color:"bg-yellow-500/20 text-yellow-300"},[oa.Bajarildi]:{text:"Bajarildi",color:"bg-green-500/20 text-green-300"},[oa.BekorQilindi]:{text:"Bekor Qilindi",color:"bg-red-500/20 text-red-300"}}[e]||{text:e,color:"bg-gray-500/20 text-gray-300"}),Aa=({article:t,isAdmin:s=!1,isJournalAdmin:i=!1,userId:l,journalIds:r,onStatusUpdate:n})=>{const o=a(),[c,d]=e.useState(!1),[m,x]=e.useState(t.status),[h,g]=e.useState(!1),p=_a(m),f=s||i&&r&&r.includes(t.journal);return u.jsxs("div",{className:"p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 cursor-pointer border border-transparent hover:border-white/10",onClick:()=>o(`/articles/${t.id}`),children:[u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-blue-400",children:t.title}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[t.fast_track&&u.jsxs("span",{className:"text-xs font-bold px-3 py-1 rounded-full whitespace-nowrap bg-yellow-500/20 text-yellow-300 flex items-center gap-1.5",children:[u.jsx(_,{size:14})," TOP"]}),u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${p.color}`,children:p.text}),f&&u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:e=>{e.stopPropagation(),d(!c)},className:"text-xs bg-gray-700 hover:bg-gray-600 rounded-full p-1.5 transition-colors",children:u.jsx(P,{size:14})}),c&&u.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10",children:u.jsx("div",{className:"py-1 max-h-60 overflow-y-auto",children:[na.Draft,na.Yangi,na.WithEditor,na.QabulQilingan,na.Revision,na.Accepted,na.Published,na.Rejected,na.NashrgaYuborilgan,na.WritingInProgress].map(e=>u.jsxs("button",{onClick:a=>{a.stopPropagation(),(async e=>{if(f)try{if(g(!0),!e)return void console.error("Status is null or undefined, cannot update");const a=String(e);await Ze.updateStatus(t.id,a),x(e),d(!1),n&&n()}catch(a){console.error("Failed to update article status:",a)}finally{g(!1)}})(e)},disabled:h,className:"w-full text-left px-3 py-2 text-sm flex items-center gap-2 "+(m===e?"bg-blue-600/30 text-blue-300":"text-gray-300 hover:bg-gray-700/50"),children:[u.jsx(I,{size:14,className:m===e?"opacity-100":"opacity-0"}),_a(e).text]},e))})})]})]})})]})]}),u.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:t.abstract}),u.jsxs("div",{className:"flex justify-between items-center mt-4 text-xs text-gray-500",children:[u.jsx("span",{children:t.author_name||"Noma'lum muallif"}),u.jsx("span",{children:new Date(t.submission_date).toLocaleDateString()})]})]})},za=({request:e})=>{var t,s,i;const l=a(),r=_a(e.status);return u.jsxs("div",{className:"p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 cursor-pointer border border-transparent hover:border-white/10",onClick:()=>l(`/translations/${e.id}`),children:[u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsxs("h4",{className:"text-lg font-semibold text-indigo-400 flex items-center gap-2",children:[u.jsx(m,{size:20})," ",e.title]}),u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${r.color}`,children:r.text})]}),u.jsxs("div",{className:"flex justify-between items-end mt-4",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[(null==(t=e.source_language)?void 0:t.toUpperCase())||"Noma'lum"," ",u.jsx(N,{size:14,className:"inline-block mx-1"})," ",(null==(s=e.target_language)?void 0:s.toUpperCase())||"Noma'lum"]}),u.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[u.jsxs("span",{children:["Muallif: ",e.author_name||"Noma'lum"]}),u.jsx("span",{className:"mx-2",children:"|"}),u.jsxs("span",{children:["Sana: ",new Date(e.submission_date).toLocaleDateString()]})]})]}),u.jsxs("span",{className:"text-sm font-semibold text-green-400",children:[(null==(i=e.cost)?void 0:i.toLocaleString())||0," so'm"]})]})]})},Ca=()=>{const{user:a}=ia(),t="string"==typeof(null==a?void 0:a.role)?a.role.toLowerCase():null==a?void 0:a.role,s=t===ra.JournalAdmin||"journal_admin"===t||"journaladmin"===t,[i,r]=e.useState(""),[n,o]=e.useState((null==a?void 0:a.role)===ra.Reviewer?"reviews":s?"new":"all"),[c,d]=e.useState(!1),[m,x]=e.useState([]),[h,g]=e.useState([]),[p,f]=e.useState([]),[j,b]=e.useState(!0),[y,v]=e.useState(null),N=[{id:"reviews",label:"Maqola Taqrizlari",statuses:[na.QabulQilingan]},{id:"translations",label:"Tarjimalar",statuses:[oa.Yangi,oa.Jarayonda]}],w=[{id:"new",label:"Yangi Kelganlar",statuses:[na.Yangi]},{id:"with-editor",label:"Redaktorda",statuses:[na.WithEditor]},{id:"in-review",label:"Tekshiruvda",statuses:[na.QabulQilingan]},{id:"ready",label:"Nashrga Tayyorlar",statuses:[na.NashrgaYuborilgan]},{id:"published",label:"Nashr etilgan",statuses:[na.Published]},{id:"all",label:"Barcha Maqolalar",statuses:[]}];let k="Maqolalar";switch(t){case ra.Author:case"author":k="Mening Maqolalarim";break;case ra.Reviewer:case"reviewer":k="Ish Stoli";break;case ra.JournalAdmin:case"journal_admin":case"journaladmin":k="Jurnal Maqolalari";break;case ra.SuperAdmin:case"super_admin":case"superadmin":k="Tizimdagi Barcha Maqolalar"}const q=e.useMemo(()=>{if(s){const e=a.id||a.userId||a.user_id,t=p.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e).map(e=>e.id),s=w.find(e=>e.id===n);return s?m.filter(e=>{const a=t.includes(e.journal),i="all"===s.id||(null==s?void 0:s.statuses.includes(e.status));return a&&i}).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0)):[]}switch(a.role){case ra.Author:return m;case ra.Reviewer:if("reviews"===n){const e=N.find(e=>e.id===n);return m.filter(a=>null==e?void 0:e.statuses.includes(a.status)).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0))}return[];case ra.SuperAdmin:return m;default:return[]}},[a,n,m,p,s]),S=e.useMemo(()=>a.role!==ra.Reviewer||"translations"!==n?[]:h.filter(e=>e.status===oa.Yangi||e.reviewer===a.id&&e.status===oa.Jarayonda),[a,n,h]),T=e.useMemo(()=>{if(!i)return q;const e=i.toLowerCase();return q.filter(a=>a.title.toLowerCase().includes(e)||a.keywords&&a.keywords.join(" ").toLowerCase().includes(e))},[i,q]),_=e.useMemo(()=>{if(!i)return S;const e=i.toLowerCase();return S.filter(a=>a.title.toLowerCase().includes(e))},[i,S]),A=e.useMemo(()=>N.map(e=>{let t=0;return"translations"===e.id?t=h.filter(t=>e.statuses.includes(t.status)&&(!t.reviewer||t.reviewer===a.id)).length:e.statuses&&(t=m.filter(a=>{const t=e.statuses.includes(a.status);return e.id,t}).length),{id:e.id,count:t}}),[m,h,N]),P=e.useMemo(()=>{const e=a.id||a.userId||a.user_id,t=p.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e).map(e=>e.id);return w.map(e=>{let a=0;return void 0!==e.statuses&&(a=m.filter(a=>("all"===e.id||e.statuses.includes(a.status))&&t.includes(a.journal)).length),{id:e.id,count:a}})},[a,m,p,w]),I=e.useCallback(async()=>{if(a)try{b(!0),v(null);const[e,t,s]=await Promise.all([a.role===ra.Author?Ze.list({author:a.id}):Ze.list(),Ve.list(),We.list()]);let i=[];Array.isArray(e)?i=e:e&&"object"==typeof e&&"results"in e&&Array.isArray(e.results)?i=e.results:(null==e?void 0:e.data)&&Array.isArray(e.data)&&(i=e.data);const l=Array.isArray(t)?t:(null==t?void 0:t.data)&&Array.isArray(t.data)?t.data:(null==t?void 0:t.results)&&Array.isArray(t.results)?t.results:[],r=Array.isArray(s)?s:(null==s?void 0:s.data)&&Array.isArray(s.data)?s.data:(null==s?void 0:s.results)&&Array.isArray(s.results)?s.results:[];x(i),g(l),f(r)}catch(e){v((null==e?void 0:e.message)||"Maqolalar ma'lumotlarini yuklashda xatolik. Iltimos, keyinroq urinib ko'ring.")}finally{b(!1)}},[a]);if(e.useEffect(()=>{I()},[I]),!a)return null;if(j)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(y)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:y}),u.jsx(ja,{onClick:()=>{v(null),I()},className:"mt-4",children:"Qayta urinish"})]});const M=(e,a)=>u.jsx("div",{className:"mb-6 border-b border-white/10 flex",children:e.map(e=>{var t;const s=(null==(t=a.find(a=>a.id===e.id))?void 0:t.count)||0;return u.jsxs("button",{onClick:()=>o(e.id),className:"px-4 py-3 font-medium text-sm transition-colors "+(n===e.id?"border-b-2 border-blue-400 text-blue-400":"text-gray-400 hover:text-white"),children:[e.label," ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+(n===e.id?"bg-blue-500/20 text-blue-300":"bg-white/10 text-gray-300"),children:s})]},e.id)})});return u.jsxs(u.Fragment,{children:[u.jsxs(fa,{title:k,children:[a.role===ra.Author&&u.jsx("div",{className:"mb-6 flex justify-end",children:u.jsxs(ja,{onClick:()=>d(!0),variant:"secondary",children:[u.jsx(l,{className:"mr-2 h-4 w-4"})," Barcha maqolalar bo'yicha ma'lumotnoma"]})}),a.role===ra.Reviewer&&M(N,A),s&&M(w,P),u.jsxs("div",{className:"flex items-center bg-white/5 border border-white/10 rounded-xl mb-6 focus-within:border-accent-color focus-within:ring-2 focus-within:ring-accent-color-glow transition-all",children:[u.jsx(z,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Sarlavha bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:i,onChange:e=>r(e.target.value)})]}),(()=>{if(a.role===ra.Reviewer&&"translations"===n)return u.jsx("div",{className:"space-y-4",children:_.length>0?_.map(e=>u.jsx(za,{request:e},e.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Yangi tarjima so'rovlari mavjud emas."})});const e=a.role===ra.SuperAdmin,s=t===ra.JournalAdmin||"journal_admin"===t||"journaladmin"===t;let l=[];if(s){const e=a.id||a.userId||a.user_id,t=p.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e);l=t.map(e=>e.id)}return u.jsx("div",{className:"space-y-4",children:T.length>0?T.map(t=>u.jsx(Aa,{article:t,isAdmin:e,isJournalAdmin:s,userId:a.id,journalIds:l,onStatusUpdate:I},t.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Ushbu bo'limda hozircha maqolalar mavjud emas."})})})()]}),c&&a&&u.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4 no-print",children:u.jsxs("div",{className:"w-full max-w-4xl h-[90vh] bg-gray-800 rounded-lg shadow-2xl flex flex-col",children:[u.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Maqolalar bo'yicha ma'lumotnoma"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(ja,{onClick:()=>{window.print()},variant:"primary",children:[u.jsx(C,{className:"mr-2 h-4 w-4"})," Chop Etish"]}),u.jsx(ja,{onClick:()=>d(!1),variant:"secondary",children:"Yopish"})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsx("div",{id:"author-report-print-area",children:u.jsx(Sa,{articles:q.map(Ta),author:a})})})]})})]})},Pa=new $e({apiKey:"AIzaSyBm02i-rm_XNVckLVGOKBqH1GH6tk4pFKE"});const Ia=new class{async processPayment(e,a="click"){try{const t=await Ge.processPayment(e,a);return t&&void 0===t.success&&(t.payment_url||0===t.error_code||!t.error_code&&!t.error?t.success=!0:t.success=!1),t&&t.payment_url&&!1===t.success&&(console.warn("Payment URL exists but success is false, overriding to true:",t),t.success=!0),t}catch(t){console.error("Error processing payment:",t);let e="To'lovni amalga oshirishda xatolik yuz berdi",a=-1;return t.message?e=t.message:"string"==typeof t?e=t:t.error?e=t.error:t.error_note&&(e=t.error_note),t.error_code&&(a=t.error_code),{success:!1,error_code:a,error:e,error_note:e}}}async checkPaymentStatus(e){try{const a=(await Ge.listTransactions()).find(a=>a.id===e);return a?{error_code:0,error_note:"Success",payment_status:"completed"===a.status?2:"failed"===a.status?-1:0}:{error_code:-5,error_note:"Transaction not found"}}catch(a){return console.error("Error checking payment status:",a),{error_code:-9,error_note:a.message||"Failed to check payment status"}}}redirectToPayment(e){if(!e)throw console.error("Payment URL is not available"),new Error("To'lov URL topilmadi");try{if(!new URL(e).protocol.startsWith("http"))throw console.error("Invalid payment URL protocol:",e),new Error("Noto'g'ri to'lov URL formati")}catch(a){throw console.error("Invalid payment URL format:",e,a),new Error("Noto'g'ri to'lov URL formati")}try{document.body&&(document.body.innerHTML=""),window.location.replace(e),setTimeout(()=>{window.location.href!==e&&(console.warn("Replace failed, using href as fallback"),window.location.href=e)},100)}catch(t){console.error("Failed to redirect to payment URL:",t);try{if(!window.open(e,"_blank"))throw new Error("Popup blocked")}catch(s){throw new Error("To'lov sahifasiga yo'naltirishda xatolik yuz berdi. Iltimos, quyidagi linkni oching: "+e)}}}async createTransactionAndPay(e,a,t,s,i,l="click"){try{const r={amount:e,currency:a||"UZS",service_type:t};s&&""!==s.trim()&&(r.article=s),i&&""!==i.trim()&&(r.translation_request=i);const n=await Ge.createTransaction(r);if(!n||!n.id)return console.error("Transaction creation failed - no ID returned:",n),{success:!1,error_code:-1,error:"Transaction yaratilmadi. Server javob bermadi.",error_note:"Failed to create transaction - no transaction ID returned"};n.id;const o=await this.processPayment(n.id,l);return o}catch(r){console.error("Error creating transaction and processing payment:",r);let e="To'lovni amalga oshirishda xatolik yuz berdi";return r.message?e=r.message:"string"==typeof r?e=r:r.error?e=r.error:r.error_note&&(e=r.error_note),{success:!1,error_code:r.error_code||-1,error:e,error_note:e}}}},Ma=5e4,Fa=()=>{var t,s,r,o;const{user:c}=ia(),{addNotification:d}=la(),m=a(),[h,g]=e.useState(1),[p,f]=e.useState(!1),[j,b]=e.useState(!1),[y,v]=e.useState("idle"),[N,w]=e.useState(null),[k,S]=e.useState(0),[T,A]=e.useState(0),[C,P]=e.useState(null),[L,J]=e.useState(null),[Y,B]=e.useState([]),[Q,H]=e.useState([]),[K,X]=e.useState(""),[Z,W]=e.useState([]),[G,V]=e.useState({min:0,max:1e8}),[ee,ae]=e.useState(!1),[te,se]=e.useState([]),[ie,le]=e.useState(null),[re,ne]=e.useState({firstName:(null==c?void 0:c.firstName)||"",lastName:(null==c?void 0:c.lastName)||"",email:(null==c?void 0:c.email)||"",affiliation:(null==c?void 0:c.affiliation)||""}),[oe,ce]=e.useState([]),[de,me]=e.useState({fastTrack:!1}),[xe,ue]=e.useState(null),[he,ge]=e.useState(""),[pe,fe]=e.useState(""),[je,be]=e.useState(""),[ye,ve]=e.useState(!1),[Ne,we]=e.useState(null),ke=e.useRef(null),qe=e.useRef(null);e.useEffect(()=>{(async()=>{try{const[e,a]=await Promise.all([We.list(),We.listCategories()]);let t=[];Array.isArray(e)?t=e:e&&"object"==typeof e&&(t=Array.isArray(e.data)?e.data:Array.isArray(e.results)?e.results:e.hasOwnProperty("journals")?Array.isArray(e.journals)?e.journals:[]:[e]);let s=[];Array.isArray(a)?s=a:a&&"object"==typeof a&&(s=Array.isArray(a.data)?a.data:Array.isArray(a.results)?a.results:a.hasOwnProperty("categories")?Array.isArray(a.categories)?a.categories:[]:[a]);const i=t.map(e=>({...e,name:e.name||"Nomsiz jurnal",description:e.description||"Tavsif mavjud emas",issn:e.issn||"ISSN yo'q",categoryId:e.categoryId||e.category||"",pricingType:e.pricingType||e.pricing_type||da.Fixed,publicationFee:void 0!==e.publicationFee?"string"==typeof e.publicationFee?parseFloat(e.publicationFee):e.publicationFee:e.publication_fee?parseFloat(e.publication_fee):0,pricePerPage:void 0!==e.pricePerPage?"string"==typeof e.pricePerPage?parseFloat(e.pricePerPage):e.pricePerPage:e.price_per_page?parseFloat(e.price_per_page):0})),l=s.map(e=>({...e,name:e.name||"Noma'lum toifa"}));B(i),H(l)}catch(e){console.error("Failed to fetch journals:",e),d({message:"Jurnallar ro'yxatini yuklashda xatolik yuz berdi."})}})()},[d]),e.useEffect(()=>()=>{qe.current&&clearTimeout(qe.current)},[]);const Se=e.useMemo(()=>Y.find(e=>e.id===L),[Y,L]),Te=e.useMemo(()=>{let e=0;return"publish"===C&&Se&&(Se.pricingType===da.Fixed?e+=parseFloat(Se.publicationFee)||0:Se.pricingType===da.PerPage&&T>0&&(e+=(parseFloat(Se.pricePerPage)||0)*T)),"write"===C&&(e+=15e4),de.fastTrack&&(e+=Ma),Math.round(e)},[C,de,Se,T]),_e=e.useMemo(()=>Y.filter(e=>{var a,t,s;const i=(null==(a=e.name)?void 0:a.toLowerCase().includes(K.toLowerCase()))||(null==(t=e.description)?void 0:t.toLowerCase().includes(K.toLowerCase()))||(null==(s=e.issn)?void 0:s.toLowerCase().includes(K.toLowerCase())),l=0===Z.length||Z.includes(e.categoryId);let r=0;e.pricingType===da.Fixed?r=parseFloat(e.publicationFee)||0:e.pricingType===da.PerPage&&(r=(parseFloat(e.pricePerPage)||0)*(T||10));const n=r>=G.min&&r<=G.max,o=!ee||te.includes(e.id);return i&&l&&n&&o}),[Y,K,Z,G,ee,te,T]),Ae=(e,a,t)=>{const s=[...oe];s[e]={...s[e],[a]:t},ce(s)},ze=()=>{b(!1),qe.current&&clearTimeout(qe.current)},Ce=async e=>{var a;e&&(e.preventDefault(),e.stopPropagation()),w(null),v("processing"),qe.current&&clearTimeout(qe.current);try{let e;try{const t={title:he.replace(/\.[^/.]+$/,""),abstract:pe||"Maqola annotatsiyasi",keywords:je?je.split(",").map(e=>e.trim()):["kalit so'z"],journal:L,page_count:T,fast_track:de.fastTrack,status:"Yangi"},s=await Ze.create(t,{mainFile:xe});if(e=(null==s?void 0:s.id)||(null==(a=null==s?void 0:s.data)?void 0:a.id),!e)throw new Error("Maqola yaratildi, lekin ID olinmadi.")}catch(t){throw console.error("Failed to create article before payment:",t),new Error(`Maqola yaratishda xatolik: ${t.message||"Noma'lum xatolik"}`)}const s=await Ia.createTransactionAndPay(Te,"UZS",de.fastTrack?"fast-track":"publication_fee",e,void 0);if(s&&!0===s.success&&s.payment_url)b(!1),d({message:"To'lov sahifasiga yo'naltirilmoqdasiz. To'lovni tugallang."}),setTimeout(()=>{s.payment_url?(s.payment_url,Ia.redirectToPayment(s.payment_url)):(console.error("Payment URL is missing"),v("failed"),w("To'lov URL topilmadi. Iltimos, qayta urinib ko'ring."),b(!0))},500);else{const e=(null==s?void 0:s.user_message)||(null==s?void 0:s.error_note)||(null==s?void 0:s.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";v("failed"),w(e),d({message:e})}}catch(s){console.error("Payment failed:",s);const e=s.message||s.error_note||s.user_message||"To'lovni amalga oshirishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.";v("failed"),w(e),d({message:e})}};return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Maqola yuborish"}),u.jsx("p",{className:"text-gray-400 mb-8",children:"Ilmiy maqolangizni platformaga yuboring"}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Qadam ",h," dan 5"]}),u.jsx("span",{className:"text-gray-400",children:["Jurnal tanlash","Xizmat turi","Tafsilotlar","Hammualliflar","Tasdiqlash"][h-1]})]}),u.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:h/5*100+"%"}})})]}),u.jsxs("div",{className:"mt-8 p-6 bg-white/5 rounded-xl min-h-[400px]",children:[1===h&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),u.jsx("input",{type:"text",placeholder:"Jurnal nomi yoki tavsifi bo'yicha qidirish...",value:K,onChange:e=>X(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/10 border border-white/10 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsx(ja,{variant:"secondary",onClick:()=>ae(!ee),children:ee?"Barchasi":"Sevimlilar"})]}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[Q.map(e=>u.jsx("button",{onClick:()=>{return a=e.id,void W(e=>e.includes(a)?e.filter(e=>e!==a):[...e,a]);var a},className:"px-3 py-1.5 text-sm rounded-full transition-colors "+(Z.includes(e.id)?"bg-blue-500 text-white":"bg-white/10 text-gray-300 hover:bg-white/20"),children:e.name},e.id)),Z.length>0&&u.jsx("button",{onClick:()=>W([]),className:"px-3 py-1.5 text-sm rounded-full bg-gray-500/20 text-gray-300 hover:bg-gray-500/30",children:"Tozalash"})]}),u.jsxs("div",{className:"mb-4 text-sm text-gray-400",children:["Jurnallar soni: ",Y.length," | Filtrlangan: ",_e.length]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_e.map(e=>{var a,t,s;return u.jsx("div",{className:"border rounded-xl p-5 cursor-pointer transition-all duration-300 transform hover:scale-[1.02] "+(L===e.id?"border-blue-500 bg-gradient-to-r from-blue-500/10 to-indigo-500/10 shadow-lg":"border-white/10 hover:border-white/30 hover:bg-white/5"),onClick:()=>J(e.id),children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-start gap-4",children:[u.jsx("div",{className:"bg-gradient-to-br from-blue-400 to-indigo-600 rounded-xl w-16 h-16 flex items-center justify-center flex-shrink-0",children:u.jsx(n,{className:"h-8 w-8 text-white"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("h3",{className:"font-bold text-white text-lg",children:e.name||"Nomsiz jurnal"})}),u.jsx("p",{className:"text-sm text-gray-300 mt-2 line-clamp-2",children:e.description||"Tavsif mavjud emas"}),u.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[u.jsx("span",{className:"text-xs px-2.5 py-1 bg-white/10 text-gray-300 rounded-full",children:e.categoryId?(null==(a=Q.find(a=>a.id===e.categoryId))?void 0:a.name)||"Noma'lum toifa":"Toifa yo'q"}),u.jsx("span",{className:"text-xs px-2.5 py-1 bg-white/10 text-gray-300 rounded-full",children:e.issn||"ISSN yo'q"})]})]})]})}),u.jsxs("div",{className:"flex flex-col items-end gap-3 ml-2",children:[u.jsx("button",{onClick:a=>{var t;a.stopPropagation(),t=e.id,se(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t])},className:"p-1.5 rounded-full hover:bg-white/10 transition-colors",children:u.jsx(M,{className:"h-5 w-5 "+(te.includes(e.id)?"text-yellow-400 fill-current":"text-gray-400")})}),u.jsx("div",{className:"text-right bg-black/20 rounded-lg p-2 min-w-[120px]",children:e.pricingType===da.Fixed?u.jsxs("div",{children:[u.jsxs("span",{className:"text-lg font-bold text-green-400",children:[void 0!==e.publicationFee&&null!==e.publicationFee&&(null==(t=parseFloat(e.publicationFee))?void 0:t.toLocaleString())||"0"," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"To'liq to'lov"})]}):u.jsxs("div",{children:[u.jsxs("span",{className:"text-lg font-bold text-green-400",children:[void 0!==e.pricePerPage&&null!==e.pricePerPage&&(null==(s=parseFloat(e.pricePerPage))?void 0:s.toLocaleString())||"0"," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"/bet"})]})})]})]})},e.id)})}),0===_e.length&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx(n,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Hech qanday jurnal topilmadi"})]})]}),2===h&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"Asosiy xizmat turini tanlang"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"border-2 rounded-xl p-6 cursor-pointer transition-all "+("write"===C?"border-blue-500 bg-blue-500/10":"border-white/10 hover:border-white/20"),onClick:()=>P("write"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx(F,{className:"h-8 w-8 text-blue-400"}),u.jsx("h4",{className:"text-lg font-semibold text-white",children:"Maqola yozish"})]}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Professional muharrirlar siz uchun ilmiy maqola yozadi"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-lg font-bold text-green-400",children:"150,000 so'm"}),"write"===C&&u.jsx(I,{className:"h-6 w-6 text-blue-400"})]})]}),u.jsxs("div",{className:"border-2 rounded-xl p-6 cursor-pointer transition-all "+("publish"===C?"border-blue-500 bg-blue-500/10":"border-white/10 hover:border-white/20"),onClick:()=>P("publish"),children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx(D,{className:"h-8 w-8 text-purple-400"}),u.jsx("h4",{className:"text-lg font-semibold text-white",children:"Nashr etish"})]}),u.jsx("p",{className:"text-gray-400 mb-4",children:"O'z maqolangizni jurnalda nashr etish"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[(null==Se?void 0:Se.pricingType)===da.Fixed?u.jsxs("span",{className:"text-lg font-bold text-green-400",children:[(null==(t=parseFloat(Se.publicationFee))?void 0:t.toLocaleString())||0," so'm"]}):u.jsxs("span",{className:"text-lg font-bold text-green-400",children:[(null==(s=parseFloat(null==Se?void 0:Se.pricePerPage))?void 0:s.toLocaleString())||0," so'm/bet"]}),u.jsx("p",{className:"text-xs text-gray-400",children:(null==Se?void 0:Se.name)||"Jurnal tanlanmagan"})]}),"publish"===C&&u.jsx(I,{className:"h-6 w-6 text-blue-400"})]})]})]}),u.jsxs("div",{className:"border-t border-white/10 pt-6",children:[u.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Qo'shimcha xizmatlar"}),u.jsx("div",{className:"space-y-3",children:u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg cursor-pointer "+(de.fastTrack?"bg-yellow-500/10 border border-yellow-500/30":"bg-white/5 hover:bg-white/10"),onClick:()=>me(e=>({...e,fastTrack:!e.fastTrack})),children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(_,{className:"h-5 w-5 text-yellow-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:"Tezkor ko'rib chiqish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Maqolani 24 soat ichida ko'rib chiqish"})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"font-bold text-yellow-400",children:"+50,000 so'm"}),u.jsx("div",{className:"h-5 w-5 rounded-full border-2 flex items-center justify-center "+(de.fastTrack?"border-yellow-400 bg-yellow-400":"border-gray-400"),children:de.fastTrack&&u.jsx(I,{className:"h-3 w-3 text-black"})})]})]})})]}),C&&u.jsx("div",{className:"bg-white/5 rounded-lg p-4 mt-6",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Umumiy summa:"}),u.jsxs("span",{className:"text-xl font-bold text-green-400",children:[Te.toLocaleString()," so'm"]})]})})]}),3===h&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"Maqola faylini yuklang"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx("div",{children:u.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-xl p-8 text-center cursor-pointer hover:border-blue-500 transition-colors h-full flex flex-col items-center justify-center",onClick:()=>{var e;return null==(e=ke.current)?void 0:e.click()},children:[u.jsx(R,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),u.jsx("h4",{className:"text-lg font-medium text-white mb-2",children:"PDF fayl yuklang"}),u.jsx("p",{className:"text-gray-400 mb-4",children:"Maqolani PDF formatda yuklang"}),u.jsx(ja,{variant:"secondary",children:"Fayl tanlash"}),u.jsx("input",{type:"file",ref:ke,onChange:e=>{var a;const t=null==(a=e.target.files)?void 0:a[0];if(t){ue(t),ge(t.name);const e=Math.max(1,Math.floor(t.size/2048));A(e)}},accept:".pdf",className:"hidden"})]})}),u.jsx("div",{className:"space-y-4",children:xe?u.jsxs("div",{className:"bg-white/5 rounded-lg p-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(l,{className:"h-8 w-8 text-blue-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-white font-medium",children:he}),u.jsxs("p",{className:"text-gray-400 text-sm",children:[(xe.size/1024/1024).toFixed(2)," MB • Taxminiy ",T," bet"]})]})]}),u.jsx("button",{onClick:()=>{ue(null),ge(""),A(0),ke.current&&(ke.current.value="")},className:"text-gray-400 hover:text-white transition-colors",children:u.jsx(q,{className:"h-6 w-6"})})]}),u.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10",children:[u.jsx(ja,{onClick:async()=>{if(xe){ve(!0),we(null);try{const e=new FileReader;e.onload=async()=>{const a=e.result.split(",")[1];try{const e=await(async e=>{try{const a=`Ushbu ilmiy maqolaning matni asosida unga mos annotatsiya (taxminan 50-70 so'z) va 3-5 ta kalit so'zlar generatsiya qil. Matn: \n\n${e}`,t=(await Pa.models.generateContent({model:"gemini-2.5-flash",contents:a,config:{responseMimeType:"application/json",responseSchema:{type:Ee.OBJECT,properties:{abstract:{type:Ee.STRING,description:"Maqolaning o'zbek tilidagi qisqacha annotatsiyasi."},keywords:{type:Ee.ARRAY,items:{type:Ee.STRING},description:"Maqolaga oid 3-5 ta kalit so'zlar ro'yxati."}},required:["abstract","keywords"]}}})).text.trim(),s=JSON.parse(t);return{abstract:s.abstract||"",keywords:s.keywords||[]}}catch(a){return console.error("Annotatsiya va kalit so'zlarni generatsiya qilishda xatolik:",a),{abstract:"Kontent generatsiya qilishda xatolik yuz berdi.",keywords:[]}}})(a);fe(e.abstract),be(e.keywords.join(", ")),d({message:"Annotatsiya va kalit so'zlar muvaffaqiyatli yaratildi!"})}catch(t){console.error("Failed to generate abstract and keywords:",t),we(t.message||"Annotatsiya va kalit so'zlarni yaratishda xatolik yuz berdi."),d({message:"Annotatsiya va kalit so'zlarni yaratishda xatolik yuz berdi."})}finally{ve(!1)}},e.readAsDataURL(xe)}catch(e){console.error("Failed to read file:",e),we(e.message||"Faylni o'qishda xatolik yuz berdi."),ve(!1)}}else we("Iltimos, avval fayl yuklang.")},disabled:ye,variant:"secondary",className:"w-full",children:ye?u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Yaratilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(x,{className:"mr-2 h-4 w-4"}),"Annotatsiya va kalit so'zlar yaratish"]})}),Ne&&u.jsx("p",{className:"text-red-400 mt-2 text-sm",children:Ne})]})]}):u.jsx("div",{className:"bg-white/5 rounded-lg p-8 text-center h-full flex items-center justify-center",children:u.jsx("p",{className:"text-gray-400",children:"Fayl yuklanmagan"})})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h4",{className:"text-lg font-medium text-white",children:"Maqola tavsifi"}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Annotatsiya"}),u.jsx("textarea",{value:pe,onChange:e=>fe(e.target.value),rows:4,className:"w-full",placeholder:"Maqola annotatsiyasini kiriting..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kalit so'zlar"}),u.jsx("input",{type:"text",value:je,onChange:e=>be(e.target.value),className:"w-full",placeholder:"Kalit so'zlarni vergul bilan ajrating..."})]})]})]}),4===h&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"Hammualliflar"}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-6",children:[u.jsx("h4",{className:"text-lg font-medium text-white mb-4",children:"Asosiy muallif"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism"}),u.jsx("input",{type:"text",value:re.firstName,onChange:e=>ne({...re,firstName:e.target.value}),className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya"}),u.jsx("input",{type:"text",value:re.lastName,onChange:e=>ne({...re,lastName:e.target.value}),className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:re.email,onChange:e=>ne({...re,email:e.target.value}),className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tashkilot"}),u.jsx("input",{type:"text",value:re.affiliation,onChange:e=>ne({...re,affiliation:e.target.value}),className:"w-full",required:!0})]})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h4",{className:"text-lg font-medium text-white",children:"Qo'shimcha mualliflar"}),u.jsxs(ja,{onClick:()=>{ce([...oe,{firstName:"",lastName:"",email:"",affiliation:""}])},variant:"secondary",children:[u.jsx(i,{className:"h-4 w-4 mr-2"}),"Hammuallif qo'shish"]})]}),oe.length>0?u.jsx("div",{className:"space-y-4",children:oe.map((e,a)=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 p-4 bg-white/5 rounded-lg",children:[u.jsxs("div",{className:"md:col-span-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism"}),u.jsx("input",{type:"text",value:e.firstName,onChange:e=>Ae(a,"firstName",e.target.value),className:"w-full",required:!0})]}),u.jsxs("div",{className:"md:col-span-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya"}),u.jsx("input",{type:"text",value:e.lastName,onChange:e=>Ae(a,"lastName",e.target.value),className:"w-full",required:!0})]}),u.jsxs("div",{className:"md:col-span-3",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:e.email,onChange:e=>Ae(a,"email",e.target.value),className:"w-full",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tashkilot"}),u.jsx("input",{type:"text",value:e.affiliation,onChange:e=>Ae(a,"affiliation",e.target.value),className:"w-full",required:!0})]}),u.jsx("div",{className:"md:col-span-1 flex items-end",children:u.jsx("button",{onClick:()=>(e=>{ce(oe.filter((a,t)=>t!==e))})(a),className:"text-red-400 hover:text-red-300 transition-colors p-2",children:u.jsx(q,{className:"h-5 w-5"})})})]},a))}):u.jsxs("div",{className:"text-center py-8 bg-white/5 rounded-lg",children:[u.jsx(i,{className:"h-12 w-12 text-gray-500 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Hozircha qo'shimcha mualliflar qo'shilmagan"})]})]})]}),5===h&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-xl font-semibold text-white",children:"Maqolani yuborish"}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsx(fa,{title:"Jurnal ma'lumotlari",className:"!p-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(n,{className:"h-8 w-8 text-blue-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-white",children:null==Se?void 0:Se.name}),u.jsx("p",{className:"text-sm text-gray-400",children:null==Se?void 0:Se.issn})]})]})}),u.jsxs(fa,{title:"Xizmat turi",className:"!p-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:["write"===C?u.jsx(F,{className:"h-6 w-6 text-blue-400"}):u.jsx(D,{className:"h-6 w-6 text-purple-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:"write"===C?"Maqola yozish":"Nashr etish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"write"===C?"Professional muharrirlar tomonidan yoziladi":"O'z maqolangiz nashr etiladi"})]})]}),u.jsx("span",{className:"font-bold text-green-400",children:"write"===C?"150,000 so'm":(null==Se?void 0:Se.pricingType)===da.Fixed?`${(null==(r=parseFloat(Se.publicationFee))?void 0:r.toLocaleString())||0} so'm`:(parseFloat(null==Se?void 0:Se.pricePerPage)||0)*T+" so'm"})]}),de.fastTrack&&u.jsxs("div",{className:"mt-3 pt-3 border-t border-white/10 flex justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(_,{className:"h-4 w-4 text-yellow-400"}),u.jsx("span",{className:"text-sm",children:"Tezkor ko'rib chiqish"})]}),u.jsx("span",{className:"font-bold text-yellow-400",children:"+50,000 so'm"})]})]}),u.jsx(fa,{title:"Fayl ma'lumotlari",className:"!p-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx(l,{className:"h-6 w-6 text-blue-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white truncate max-w-xs",children:he}),u.jsxs("p",{className:"text-sm text-gray-400",children:[T," bet"]})]})]}),u.jsxs("span",{className:"text-sm text-gray-400",children:[((null==xe?void 0:xe.size)||0).toFixed(2)," MB"]})]})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx(fa,{title:"Mualliflar",className:"!p-4",children:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-sm font-bold",children:[re.firstName.charAt(0),re.lastName.charAt(0)]}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-white",children:[re.firstName," ",re.lastName," ",u.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-1 rounded",children:"Asosiy"})]}),u.jsx("p",{className:"text-sm text-gray-400",children:re.email})]})]}),oe.map((e,a)=>u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"h-8 w-8 rounded-full bg-gray-500 flex items-center justify-center text-white text-sm font-bold",children:[e.firstName.charAt(0),e.lastName.charAt(0)]}),u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-white",children:[e.firstName," ",e.lastName]}),u.jsx("p",{className:"text-sm text-gray-400",children:e.email})]})]},a))]})}),u.jsx(fa,{title:"To'lov ma'lumotlari",className:"!p-4",children:u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Asosiy to'lov:"}),u.jsx("span",{className:"font-medium text-white",children:"write"===C?"150,000 so'm":(null==Se?void 0:Se.pricingType)===da.Fixed?`${(null==(o=parseFloat(Se.publicationFee))?void 0:o.toLocaleString())||0} so'm`:(parseFloat(null==Se?void 0:Se.pricePerPage)||0)*T+" so'm"})]}),de.fastTrack&&u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Tezkor ko'rib chiqish:"}),u.jsx("span",{className:"font-medium text-yellow-400",children:"+50,000 so'm"})]}),u.jsxs("div",{className:"border-t border-white/10 pt-2 mt-2 flex justify-between",children:[u.jsx("span",{className:"font-medium text-white",children:"Umumiy summa:"}),u.jsxs("span",{className:"text-xl font-bold text-green-400",children:[Te.toLocaleString()," so'm"]})]})]})})]})]}),u.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx($,{className:"h-5 w-5 text-yellow-400 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-yellow-400",children:"Diqqat!"}),u.jsx("p",{className:"text-sm text-yellow-300",children:"Maqola yuborilgandan so'ng uni tahrirlab bo'lmaydi. Barcha ma'lumotlarni tekshirib chiqing."})]})]})})]})]}),u.jsxs("div",{className:"mt-8 flex justify-between",children:[u.jsxs(ja,{variant:"secondary",onClick:()=>g(e=>Math.max(e-1,1)),disabled:1===h,children:[u.jsx(E,{className:"mr-2 h-4 w-4"})," Ortga"]}),h<5?u.jsxs(ja,{onClick:()=>{1!==h||L?2!==h||C?g(e=>Math.min(e+1,5)):alert("Davom etish uchun asosiy xizmat turlaridan birini tanlang."):alert("Davom etish uchun jurnal tanlashingiz kerak.")},disabled:1===h&&!L||2===h&&!C,children:["Keyingisi ",u.jsx(U,{className:"ml-2 h-4 w-4"})]}):u.jsx(ja,{onClick:async()=>{if(!L)return void alert("Davom etish uchun jurnal tanlashingiz kerak.");if(!C)return void alert("Davom etish uchun asosiy xizmat turlaridan birini tanlang.");if(((null==Se?void 0:Se.paymentModel)??(null==Se?void 0:Se.payment_model))===ca.PostPayment){f(!0);try{await(async(e=!1)=>{if(xe&&L)try{const a={title:he.replace(/\.[^/.]+$/,""),abstract:pe||"Maqola annotatsiyasi",keywords:je?je.split(",").map(e=>e.trim()):["kalit so'z"],journal:L,page_count:T,fast_track:de.fastTrack,status:"Yangi"};if(void 0===await Ze.create(a,{mainFile:xe}))throw new Error("Maqola yuborishda xatolik yuz berdi.");d({message:e?"Maqolangiz muvaffaqiyatli yuborildi! To'lov tasdiqlandi.":"Maqolangiz muvaffaqiyatli yuborildi!"}),setTimeout(()=>{m("/articles")},1e3)}catch(a){throw console.error("Failed to submit article:",a),d({message:a.message||"Maqola yuborishda xatolik yuz berdi."}),a}})()}catch(e){alert("Maqola yuborishda xatolik yuz berdi.")}finally{f(!1)}}else v("idle"),w(null),b(!0)},disabled:!C||p,children:p?"Yuborilmoqda...":(null==Se?void 0:Se.paymentModel)===ca.PostPayment||"post-payment"===(null==Se?void 0:Se.payment_model)?"Yuborish":"To'lov va Yuborish"})]})]}),j&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full border border-white/10",children:["idle"===y&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"To'lovni tasdiqlash"}),u.jsx("p",{className:"text-gray-300 mb-2",children:"Maqola yuborish uchun to'lov:"}),u.jsx("div",{className:"p-4 bg-blue-900/20 rounded-lg border border-blue-700/30 mb-4",children:u.jsxs("p",{className:"text-2xl font-bold text-white text-center",children:[Te.toLocaleString()," so'm"]})}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ja,{onClick:e=>Ce(e),className:"flex-1",children:"To'lovni Amalga Oshirish"}),u.jsx(ja,{variant:"secondary",onClick:ze,className:"flex-1",children:"Bekor qilish"})]})]}),"processing"===y&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===y&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx("div",{className:"text-green-500 text-4xl mb-4",children:"✓"}),u.jsx("p",{className:"text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"To'lov sahifasiga yo'naltirilmoqdasiz"})]}),"failed"===y&&u.jsxs("div",{children:[u.jsx("div",{className:"text-red-500 text-4xl mb-4 text-center",children:"✗"}),u.jsx("p",{className:"text-lg font-medium text-gray-200 text-center",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto text-center mb-4",children:N}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ja,{onClick:e=>Ce(e),className:"flex-1",children:"Qayta Urinish"}),u.jsx(ja,{variant:"secondary",onClick:ze,className:"flex-1",children:"Yopish"})]})]})]})})]})},Da=()=>{const{user:a}=ia(),[t,s]=e.useState([]),[i,l]=e.useState(""),[r,n]=e.useState(!0),[o,c]=e.useState(null),[d,m]=e.useState(!1),[x,h]=e.useState(!1),[g,p]=e.useState({first_name:"",last_name:"",email:"",phone:"",role:ra.Author,password:"",affiliation:""});e.useEffect(()=>{(async()=>{if(a)try{n(!0),c(null);const e=await Xe.list(),a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[];s(a)}catch(e){console.error("Failed to fetch users:",e),c("Foydalanuvchilarni yuklashda xatolik yuz berdi.")}finally{n(!1)}})()},[a]);const f=()=>{m(!1)},j=e=>{const{name:a,value:t}=e.target;p(e=>({...e,[a]:t}))},b={author:"Muallif",reviewer:"Taqrizchi",journal_admin:"Jurnal administratori",super_admin:"Bosh administrator",accountant:"Moliyachi"},y={author:"bg-blue-500/20 text-blue-300",reviewer:"bg-purple-500/20 text-purple-300",journal_admin:"bg-indigo-500/20 text-indigo-300",super_admin:"bg-red-500/20 text-red-300",accountant:"bg-green-500/20 text-green-300"};if(r)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(o)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:o}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const v=(Array.isArray(t)?t:[]).filter(e=>{var a,t,s,l;return(null==(a=e.first_name)?void 0:a.toLowerCase().includes(i.toLowerCase()))||(null==(t=e.last_name)?void 0:t.toLowerCase().includes(i.toLowerCase()))||(null==(s=e.email)?void 0:s.toLowerCase().includes(i.toLowerCase()))||(null==(l=e.phone)?void 0:l.includes(i))});return u.jsxs(u.Fragment,{children:[u.jsxs(fa,{title:"Foydalanuvchilar boshqaruvi",children:[u.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center bg-white/5 border border-white/10 rounded-xl focus-within:border-accent-color focus-within:ring-2 focus-within:ring-accent-color-glow transition-all",children:[u.jsx(z,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Ism, familiya, email yoki telefon bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:i,onChange:e=>l(e.target.value)})]})}),u.jsxs(ja,{onClick:()=>{p({first_name:"",last_name:"",email:"",phone:"",role:ra.Author,password:"",affiliation:""}),m(!0)},children:[u.jsx(L,{className:"mr-2 h-4 w-4"})," Yangi foydalanuvchi"]})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/10",children:u.jsxs("table",{className:"w-full text-left",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Foydalanuvchi"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Rol"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Telefon"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Tashkilot"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Ro'yxatdan o'tgan"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Amallar"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:v.map(e=>u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-4 py-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.avatar_url?u.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:e.avatar_url,alt:e.first_name}):u.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center",children:u.jsx(S,{className:"h-5 w-5 text-white"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsxs("div",{className:"text-sm font-medium text-white",children:[e.first_name," ",e.last_name]}),u.jsx("div",{className:"text-sm text-gray-400",children:e.email})]})]})}),u.jsx("td",{className:"px-4 py-4",children:u.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${y[e.role]}`,children:b[e.role]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:e.phone}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:e.affiliation}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:new Date(e.date_joined).toLocaleDateString()}),u.jsx("td",{className:"px-4 py-4 text-sm",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(ja,{variant:"secondary",children:u.jsx(J,{className:"h-4 w-4"})}),u.jsx(ja,{variant:"secondary",children:u.jsx(F,{className:"h-4 w-4"})}),u.jsx(ja,{variant:"danger",children:u.jsx(Y,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===v.length&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx(S,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-white",children:"Foydalanuvchilar topilmadi"}),u.jsx("p",{className:"mt-1 text-sm text-gray-400",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Hozircha foydalanuvchilar mavjud emas."})]})]}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(fa,{className:"w-full max-w-2xl",title:"Yangi foydalanuvchi qo'shish",children:[u.jsx("button",{onClick:f,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:u.jsx(B,{size:24})}),u.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g.first_name&&g.last_name&&g.email&&g.phone&&g.password)try{h(!0);const e={first_name:g.first_name,last_name:g.last_name,email:g.email,phone:g.phone,role:g.role,password:g.password,affiliation:g.affiliation},a=await Xe.create(e);s(e=>[...e,a]),f(),alert("Foydalanuvchi muvaffaqiyatli qo'shildi!")}catch(a){console.error("Failed to create user:",a),alert("Foydalanuvchi yaratishda xatolik yuz berdi: "+(a.message||"Noma'lum xatolik"))}finally{h(!1)}else alert("Iltimos, barcha majburiy maydonlarni to'ldiring.")},className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism *"}),u.jsx("input",{type:"text",name:"first_name",value:g.first_name,onChange:j,className:"w-full",placeholder:"Ism",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya *"}),u.jsx("input",{type:"text",name:"last_name",value:g.last_name,onChange:j,className:"w-full",placeholder:"Familiya",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),u.jsx("input",{type:"email",name:"email",value:g.email,onChange:j,className:"w-full",placeholder:"email@example.com",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon *"}),u.jsx("input",{type:"tel",name:"phone",value:g.phone,onChange:j,className:"w-full",placeholder:"+998 XX XXX XXXX",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tashkilot"}),u.jsx("input",{type:"text",name:"affiliation",value:g.affiliation,onChange:j,className:"w-full",placeholder:"Tashkilot nomi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rol *"}),u.jsxs("select",{name:"role",value:g.role,onChange:j,className:"w-full",required:!0,children:[u.jsx("option",{value:ra.Author,children:"Muallif"}),u.jsx("option",{value:ra.Reviewer,children:"Taqrizchi"}),u.jsx("option",{value:ra.JournalAdmin,children:"Jurnal administratori"}),u.jsx("option",{value:ra.Accountant,children:"Moliyachi"}),u.jsx("option",{value:ra.SuperAdmin,children:"Bosh administrator"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol *"}),u.jsx("input",{type:"password",name:"password",value:g.password,onChange:j,className:"w-full",placeholder:"Parol",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-white/10 mt-6",children:[u.jsx(ja,{type:"button",variant:"secondary",onClick:f,disabled:x,children:"Bekor qilish"}),u.jsx(ja,{type:"submit",disabled:x,children:x?"Yaratilmoqda...":"Foydalanuvchi qo'shish"})]})]})]})})]})},Ra=()=>{const{user:a}=ia(),{addNotification:t}=la(),[s,i]=e.useState(!0),[l,r]=e.useState(null),[n,o]=e.useState([]),[c,d]=e.useState({}),[m,x]=e.useState([]);if(e.useEffect(()=>{(async()=>{if(a&&a.role===ra.SuperAdmin)try{i(!0),r(null);const[e,a]=await Promise.all([Ze.list(),Xe.list()]),t=Array.isArray(e)?e:[],s=Array.isArray(a)?a:[];x(s);const l=t.filter(e=>e.status===na.Yangi).slice(0,2).map(e=>{const a=s.find(a=>a.id===e.author);return{id:e.id,author:a?`${a.firstName} ${a.lastName}`:"Noma'lum",title:e.title}});o(l)}catch(e){console.error("Failed to fetch UDK requests:",e),r("UDK so'rovlarni yuklashda xatolik yuz berdi.")}finally{i(!1)}})()},[a]),(null==a?void 0:a.role)!==ra.SuperAdmin)return u.jsx(fa,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(s)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(l)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:l}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});return u.jsx(fa,{title:"UDK Kod So'rovlarini Boshqarish",children:u.jsx("div",{className:"space-y-4",children:n.length>0?n.map(e=>u.jsxs("div",{className:"p-4 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 dark:border-gray-700",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-semibold",children:e.title}),u.jsx("p",{className:"text-sm text-gray-500",children:e.author})]}),u.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[u.jsx("input",{type:"text",placeholder:"UDK kodini kiriting...",className:"w-full sm:w-48",value:c[e.id]||"",onChange:a=>{return t=e.id,s=a.target.value,void d(e=>({...e,[t]:s}));var t,s}}),u.jsx(ja,{onClick:()=>(async e=>{const a=c[e];if(a&&a.trim())try{const s=n.find(a=>a.id===e);s&&t({message:`Sizning "${s.title.substring(0,30)}..." maqolangiz uchun UDK kodi tasdiqlandi: ${a}`,link:`/articles/${e}`}),o(a=>a.filter(a=>a.id!==e)),t({message:"UDK kodi muallifga muvaffaqiyatli yuborildi."})}catch(s){console.error("Failed to send UDK code:",s),alert("UDK kodini yuborishda xatolik yuz berdi.")}else alert("Iltimos, UDK kodini kiriting.")})(e.id),children:"Yuborish"})]})]},e.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:"Yangi UDK so'rovlari mavjud emas."})})})},Oa=({data:e})=>u.jsxs("div",{className:"bg-white text-gray-800 aspect-[297/210] w-full max-w-6xl mx-auto shadow-2xl overflow-hidden relative font-sans p-2",children:[u.jsx(wa,{}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-16 py-8",children:[u.jsxs("header",{className:"flex justify-between items-center w-full border-b-2 border-[#C09D58] pb-3",children:[u.jsx(va,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-serif text-sm text-[#0D2A4F]/70 tracking-[0.2em] uppercase",children:"Phoenix Ilmiy Nashrlar Markazi"}),u.jsx("h1",{className:"font-serif text-5xl font-bold text-[#0D2A4F] tracking-wide my-1",children:"SERTIFIKAT"}),u.jsx("p",{className:"text-xs text-[#0D2A4F]/60 tracking-[0.4em] uppercase",children:"Originality & Plagiarism Check"})]}),u.jsx(va,{})]}),u.jsxs("main",{className:"flex-grow flex flex-col items-center justify-center text-center my-4",children:[u.jsx("p",{className:"text-base text-slate-700",children:"Ushbu sertifikat quyidagi ilmiy ishning tekshiruv natijalarini tasdiqlaydi:"}),u.jsxs("h2",{className:"font-serif text-xl font-medium text-slate-800 mt-4 max-w-3xl",children:['"',e.fileName,'"']}),u.jsx("p",{className:"text-base text-slate-700 mt-4",children:"Muallif"}),u.jsx("h3",{className:"text-4xl font-bold text-[#0D2A4F] font-serif tracking-wide",children:e.author}),u.jsxs("div",{className:"w-full grid grid-cols-2 gap-6 items-center mt-6 p-4",children:[u.jsxs("div",{className:"text-center p-4 border border-[#C09D58]/50 bg-gradient-to-br from-white/50 to-transparent rounded-lg",children:[u.jsx("p",{className:"text-sm font-semibold text-[#0D2A4F] uppercase tracking-wider",children:"Originallik"}),u.jsx("p",{className:"font-serif text-7xl font-bold text-green-800",children:e.originality})]}),u.jsxs("div",{className:"text-center p-4 border border-[#C09D58]/50 bg-gradient-to-br from-white/50 to-transparent rounded-lg",children:[u.jsx("p",{className:"text-sm font-semibold text-[#0D2A4F] uppercase tracking-wider",children:"O'zlashtirish (Plagiat)"}),u.jsx("p",{className:"font-serif text-7xl font-bold text-red-800",children:e.plagiarism})]})]}),u.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Tekshiruv sanasi: ",e.checkDate," ",u.jsx("span",{className:"mx-2",children:"|"})," Sertifikat raqami: ",e.certificateNumber]})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-3 border-t-2 border-[#C09D58]",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=https://ilmiyfaoliyat.uz/verify/${e.certificateNumber}&bgcolor=ffffff`,alt:"QR Code",className:"p-1 bg-white border border-slate-400"}),u.jsx("p",{className:"text-[9px] text-slate-600 max-w-[80px] mt-1",children:"Hujjatni tasdiqlang"})]}),u.jsx(Na,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-10 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"}),u.jsx("p",{className:"text-xs text-slate-600",children:"PINM Tahririyati"})]})]})]})]}),$a=5e4,Ea=()=>{const{user:a}=ia(),{addNotification:t}=la(),[s,i]=e.useState(null),[l,r]=e.useState(!1),[n,o]=e.useState(0),[d,m]=e.useState(null),[x,h]=e.useState(null),[g,p]=e.useState(!1),[f,j]=e.useState("idle"),[b,y]=e.useState(null),[v,N]=e.useState(null),w=e.useRef(null);Q.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]);const k=()=>{p(!1),w.current&&clearTimeout(w.current),j("idle"),y(null)},q=async()=>{if(s&&a){y(null),j("processing"),w.current&&clearTimeout(w.current);try{const e=await Ia.createTransactionAndPay($a,"UZS","language_editing",v||void 0);if(e&&!0===e.success&&e.payment_url)p(!1),t({message:"To'lov sahifasiga yo'naltirilmoqdasiz. To'lovni tugallang."}),setTimeout(()=>{e.payment_url?(e.payment_url,Ia.redirectToPayment(e.payment_url)):(console.error("Payment URL is missing"),j("failed"),y("To'lov URL topilmadi. Iltimos, qayta urinib ko'ring."),p(!0))},500);else{const a=(null==e?void 0:e.user_message)||(null==e?void 0:e.error_note)||(null==e?void 0:e.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";j("failed"),y(a),t({message:a})}}catch(e){console.error("Payment failed:",e);const a=e.message||e.error_note||e.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";j("failed"),y(a)}}},S=[{url:"www.ilmiymaqolalar.uz/archive/2021/article-15.html",snippet:"...bu esa o'z navbatida iqtisodiy o'sishga sezilarli ta'sir ko'rsatadi va innovatsion rivojlanishga olib keladi..."},{url:"cyberleninka.ru/article/n/digital-economy-trends-uz",snippet:"...the integration of artificial intelligence technologies is a key factor for future development..."},{url:"jstor.org/stable/25733682",snippet:"...methodology involved a qualitative analysis of emerging market trends..."},{url:"researchgate.net/publication/3456789/AI_in_Economics",snippet:"...sun'iy intellekt texnologiyalarini joriy etish kelajakdagi rivojlanishning asosiy omili hisoblanadi..."}],T=async(e=!1)=>{if(s&&a)if(e){r(!0),h(null),m(null),o(0);try{const e={title:`Plagiarism Check - ${s.name}`,abstract:"Document submitted for plagiarism check",keywords:["plagiarism","check","document"],status:"Yangi",authorId:a.id,journalId:null,submissionDate:(new Date).toISOString()},t=await Ze.create(e,{mainFile:s});N(t.id);const i=await Ze.checkPlagiarism(t.id),l=i.plagiarism||0,r=i.ai_content||0,n=100-l,o=Math.floor(2*Math.random())+2,c=[...S].sort(()=>.5-Math.random()),d=[];let x=l;for(let a=0;a<o&&!(x<=0);a++){const e=Math.min(x,Math.floor(4*Math.random())+2);x-=e,d.push({source:c[a].url,snippet:c[a].snippet,similarity:e})}m({plagiarism:l,aiContent:r,sources:d});const u={certificateNumber:`PN-${Date.now().toString().slice(-6)}`,checkDate:(new Date).toLocaleDateString("uz-UZ"),author:`${a.lastName} ${a.firstName}`,workType:"Ilmiy ish",fileName:s.name,citations:"0%",plagiarism:`${l}%`,originality:`${n.toFixed(2)}%`,searchModules:"Milliy reestr, Internet plyus, Shablon iboralar, eLIBRARY.RU, Bibliografiya, BMK dissertatsiyalari, Viloy nashriyoti, Universitetlar halqasi, IPS Adilet, Tabobat, Tarjimali matnlar qidiruv moduli, Patentlar, Tarjima tekshiruvi uz-ru, Tarjima tekshiruvi uz-ru, parafaz matnlarni tekshirish, RDK to'plami, Rossiya va MDH OAVlari, Elektron-kutubxona tizimlari, Garant AHT, Iqtibos keltirish, SPS Garant"};h(u),Z.success("Antiplagiat tekshiruvi muvaffaqiyatli amalga oshirildi!")}catch(t){Z.error(Le(t)||"Antiplagiat tekshiruvida xatolik yuz berdi.")}finally{r(!1),o(100)}}else p(!0)};return u.jsxs(u.Fragment,{children:[u.jsxs(fa,{title:"Mustaqil Antiplagiat Tekshiruvi",className:"no-print",children:[u.jsx("div",{className:"text-center",children:u.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-10 border-2 border-dashed rounded-lg dark:border-gray-600 bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(c,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-300",children:s?`Tanlangan fayl: ${s.name}`:"Tekshirish uchun faylni tanlang (.docx, .pdf)"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maksimal hajmi: 10MB"})]}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:e=>{e.target.files&&(i(e.target.files[0]),m(null),h(null),o(0),N(null))},accept:".pdf,.doc,.docx"})]})}),u.jsxs("div",{className:"mt-6 text-center space-y-4",children:[u.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-700/30 rounded-lg",children:[u.jsxs("p",{className:"text-sm text-gray-300 mb-2",children:[u.jsx("span",{className:"font-semibold text-blue-300",children:"Narx:"})," ",$a.toLocaleString()," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400",children:"Antiplagiat tekshiruvi uchun to'lov talab qilinadi"})]}),u.jsx(ja,{onClick:()=>T(!1),disabled:!s||l,isLoading:l,className:"w-full max-w-xs mx-auto",children:l?"Tekshirilmoqda...":u.jsxs(u.Fragment,{children:[u.jsx(H,{className:"mr-2 h-4 w-4"})," To'lov va Tekshirish"]})})]}),l&&u.jsxs("div",{className:"mt-8 max-w-lg mx-auto",children:[u.jsx("p",{className:"text-center text-gray-300 mb-2",children:"Tahlil qilinmoqda... Iltimos, kuting."}),u.jsx("div",{className:"w-full bg-white/10 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${n}%`,transition:"width 0.3s ease-in-out"}})})]}),d&&u.jsxs("div",{className:"mt-8",children:[u.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-white",children:"Tekshiruv Natijalari"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto p-4 bg-white/5 rounded-lg",children:[u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Originallik"}),u.jsxs("p",{className:"text-4xl font-bold text-green-400 mt-1",children:[100-d.plagiarism,"%"]})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"O'xshashlik (Plagiat)"}),u.jsxs("p",{className:"text-4xl font-bold text-yellow-400 mt-1",children:[d.plagiarism,"%"]})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"AI-Kontent"}),u.jsxs("p",{className:"text-4xl font-bold text-cyan-400 mt-1",children:[d.aiContent,"%"]})]})]}),u.jsxs(fa,{title:"Topilgan manbalar",className:"mt-6 max-w-3xl mx-auto",children:[u.jsx("p",{className:"text-sm text-gray-400 mb-4 -mt-4",children:"Tizim matningizga o'xshashlik topgan manbalar ro'yxati. Bu natijalar taxminiy bo'lib, yakuniy xulosa uchun qo'shimcha tahlil talab etilishi mumkin."}),u.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:d.sources.map((e,a)=>u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[u.jsxs("div",{className:"flex justify-between items-start text-sm",children:[u.jsxs("a",{href:`https://${e.source}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-400 hover:underline break-all",children:[u.jsx(K,{size:14})," ",e.source]}),u.jsxs("span",{className:"font-bold text-yellow-300 whitespace-nowrap ml-4",children:[e.similarity,"% o'xshashlik"]})]}),u.jsx("blockquote",{className:"mt-2 pl-3 border-l-2 border-yellow-500/50 text-xs text-gray-400 italic",children:e.snippet})]},a))})]})]})]}),x&&u.jsxs("div",{className:"mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:"Tekshiruv Sertifikati"}),u.jsxs(ja,{onClick:()=>{window.print()},variant:"secondary",children:[u.jsx(C,{className:"mr-2 h-4 w-4"})," Sertifikatni Chop Etish"]})]}),u.jsx("div",{id:"certificate-print-area",children:u.jsx(Oa,{data:x})})]}),g&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full border border-white/10",children:["idle"===f&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"To'lovni tasdiqlash"}),u.jsxs("p",{className:"text-gray-300 mb-4",children:["Antiplagiat tekshiruvi uchun to'lov: ",u.jsxs("span",{className:"font-bold text-blue-400",children:[$a.toLocaleString()," so'm"]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs(ja,{onClick:q,className:"flex-1",children:[u.jsx(X,{className:"mr-2 h-4 w-4"}),"To'lovni Amalga Oshirish"]}),u.jsx(ja,{variant:"secondary",onClick:k,className:"flex-1",children:"Bekor qilish"})]})]}),"processing"===f&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===f&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-green-500 text-4xl mb-4",children:"✓"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx(ja,{onClick:()=>{k(),T(!0)},className:"w-full mt-6",children:"Tekshirishni Davom Ettirish"})]}),"failed"===f&&u.jsxs("div",{children:[u.jsx("div",{className:"text-red-500 text-4xl mb-4 text-center",children:"✗"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200 text-center",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto text-center mb-4",children:b}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ja,{onClick:q,className:"flex-1",children:"Qayta Urinish"}),u.jsx(ja,{variant:"secondary",onClick:k,className:"flex-1",children:"Yopish"})]})]})]})})]})},Ua=[{title:"Kitob Nashr Etish",description:"Tayyor qo'lyozmangizni professional kitob shaklida nashr eting va ISBN oling.",icon:W,link:"/submit-book",isAvailable:!0},{title:"Antiplagiat Tekshiruvi",description:"Maqolangizning o'ziga xosligini tekshiring va muvofiqlik sertifikatiga ega bo'ling.",icon:G,link:"/plagiarism-check",isAvailable:!0},{title:"Ilmiy Tarjima",description:"Maqolalaringizni professional tarjimonlar yordamida ingliz va boshqa tillarga o'giring.",icon:m,link:"/translation-service",isAvailable:!0},{title:"UDK Olish",description:"Ilmiy ishingiz uchun Universal O'nli Klassifikatsiya kodini tez va oson oling.",icon:n,isAvailable:!1},{title:"Tahrirlash va Musahhihlik",description:"Matnning grammatik, uslubiy va imlo xatolarini mutaxassislar tomonidan tekshirtiring.",icon:V,isAvailable:!1},{title:"Adabiyotlarni Formatlash",description:"Manbalar ro'yxatini APA, MLA, Chicago kabi xalqaro standartlarga moslashtirish.",icon:l,isAvailable:!1},{title:"Ilmiy Illustratsiya",description:"Tadqiqotingiz uchun yuqori sifatli grafik, diagramma va jadvallar yaratish.",icon:ee,isAvailable:!1},{title:"Dissertatsiyaga Yordam",description:"Dissertatsiya va ilmiy ishlarni yozishda professional maslahat va yo'l-yo'riqlar.",icon:ae,isAvailable:!1},{title:"Jurnal Tanlash Xizmati",description:"Sizning maqolangiz uchun eng mos bo'lgan jurnallarni topishga yordam beramiz.",icon:te,isAvailable:!1},{title:"DOI Raqami Olish",description:"Maqolangiz uchun unikal raqamli obyekt identifikatorini (DOI) ro'yxatdan o'tkazish.",icon:se,isAvailable:!1},{title:"Taqdimot Tayyorlash",description:"Konferensiyalar uchun professional slaydlar va poster taqdimotlarini yaratish.",icon:ie,isAvailable:!1},{title:"Grant Arizasini Yozish",description:"Ilmiy faoliyatingizni moliyalashtirish uchun grant arizalarini yozishda ko'mak.",icon:le,isAvailable:!1},{title:"Taqrizchi Topish Xizmati",description:"Jurnal administratorlari uchun maqolalarga mos taqrizchilarni topish tizimi.",icon:re,isAvailable:!1}],La=({service:e})=>{const a=u.jsxs("div",{className:"h-full flex flex-col p-6 text-center transition-all duration-300 "+(e.isAvailable?"group-hover:bg-white/5":"opacity-50"),children:[e.isAvailable?u.jsx("div",{className:"absolute top-3 right-3 px-2 py-1 text-xs rounded-full bg-green-500/20 text-green-300",children:"Mavjud"}):u.jsxs("div",{className:"absolute top-3 right-3 flex items-center gap-1.5 px-2 py-1 text-xs rounded-full bg-yellow-500/20 text-yellow-300",children:[u.jsx(ne,{size:12}),u.jsx("span",{children:"Tez Kunda"})]}),u.jsx("div",{className:"flex-shrink-0 mb-4",children:u.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl flex items-center justify-center bg-gradient-to-br "+(e.isAvailable?"from-blue-500 to-cyan-400":"from-gray-700 to-gray-600"),children:u.jsx(e.icon,{className:"text-white",size:32})})}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:e.title}),u.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:e.description})]}),e.isAvailable&&e.link&&u.jsx("div",{className:"mt-6",children:u.jsxs("span",{className:"font-semibold text-blue-400 flex items-center justify-center group-hover:text-blue-300",children:["Boshlash ",u.jsx(N,{className:"ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"})]})})]}),t="relative bg-black/20 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-lg h-full overflow-hidden";return e.isAvailable&&e.link?u.jsx(h,{to:e.link,className:"block group",children:u.jsx("div",{className:`${t} transition-all duration-300 hover:shadow-2xl hover:border-white/20`,children:a})}):u.jsx("div",{className:`${t} cursor-not-allowed`,children:a})},Ja=()=>u.jsxs(fa,{title:"Xizmatlar Markazi",children:[u.jsx("p",{className:"text-center text-gray-300 mb-8 -mt-4 max-w-2xl mx-auto",children:"Tadqiqot va nashr jarayonlaringizni osonlashtirish uchun mo'ljallangan keng qamrovli xizmatlarimizdan foydalaning."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Ua.map(e=>u.jsx(La,{service:e},e.title))})]}),Ya=()=>{var a,t;const{user:s,logout:i}=ia(),[l,r]=e.useState(null),[n,o]=e.useState(!0),[c,d]=e.useState(null),[m,x]=e.useState(!1),[h,g]=e.useState({}),[p,f]=e.useState(!1);e.useEffect(()=>{(async()=>{if(s)try{o(!0),d(null);const e=await Ke.getProfile(),a=e.data||e;r(a),g({first_name:a.first_name,last_name:a.last_name,patronymic:a.patronymic||"",email:a.email,phone:a.phone,affiliation:a.affiliation,orcid_id:a.orcid_id||"",telegram_username:a.telegram_username||""})}catch(e){console.error("Failed to fetch profile:",e),d("Profil ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{o(!1)}})()},[s]);const j=e=>{const{name:a,value:t}=e.target;g(e=>({...e,[a]:t}))};return n?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):c?u.jsxs(fa,{title:"Error",children:[u.jsx("p",{className:"text-red-400",children:c}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Retry"})]}):l?u.jsxs("div",{className:"space-y-6",children:[u.jsx(fa,{title:"Profilim",children:u.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"relative",children:[l.avatar_url?u.jsx("img",{src:l.avatar_url,alt:"Avatar",className:"h-32 w-32 rounded-full object-cover border-4 border-white/10"}):u.jsx("div",{className:"h-32 w-32 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center border-4 border-white/10",children:u.jsx(S,{className:"h-16 w-16 text-white"})}),u.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:u.jsx(F,{className:"h-4 w-4 text-white"})})]}),u.jsxs("div",{className:"mt-4 text-center",children:[u.jsxs("h2",{className:"text-xl font-bold text-white",children:[l.first_name," ",l.last_name," ",l.patronymic]}),u.jsx("p",{className:"text-gray-400",children:{author:"Muallif",reviewer:"Taqrizchi",journal_admin:"Jurnal administratori",super_admin:"Bosh administrator",accountant:"Moliyachi"}[l.role]||l.role})]})]}),u.jsx("div",{className:"flex-1",children:m?u.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=await Ke.updateProfile(h),a=e.data||e;r(a),x(!1),Z.success("Profil muvaffaqiyatli yangilandi")}catch(a){console.error("Failed to update profile:",a),d("Profilni yangilashda xatolik yuz berdi."),Z.error("Profilni yangilashda xatolik yuz berdi")}},className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism"}),u.jsx("input",{type:"text",name:"first_name",value:h.first_name,onChange:j,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya"}),u.jsx("input",{type:"text",name:"last_name",value:h.last_name,onChange:j,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Otasining ismi"}),u.jsx("input",{type:"text",name:"patronymic",value:h.patronymic,onChange:j,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon"}),u.jsxs("div",{className:"flex",children:[u.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-white/10 bg-white/5 text-gray-300",children:"+998"}),u.jsx("input",{type:"tel",name:"phone",value:null==(a=h.phone)?void 0:a.replace("+998",""),onChange:j,className:"flex-1 min-w-0 block w-full rounded-none rounded-r-md",required:!0})]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",name:"email",value:h.email,onChange:j,className:"w-full",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ish yoki o'qish joyi"}),u.jsx("input",{type:"text",name:"affiliation",value:h.affiliation,onChange:j,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ORCID ID"}),u.jsx("input",{type:"text",name:"orcid_id",value:h.orcid_id,onChange:j,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telegram"}),u.jsxs("div",{className:"flex",children:[u.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-white/10 bg-white/5 text-gray-300",children:"@"}),u.jsx("input",{type:"text",name:"telegram_username",value:null==(t=h.telegram_username)?void 0:t.replace("@",""),onChange:j,className:"flex-1 min-w-0 block w-full rounded-none rounded-r-md"})]})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx(ja,{type:"submit",children:"Saqlash"}),u.jsx(ja,{type:"button",variant:"secondary",onClick:()=>x(!1),children:"Bekor qilish"})]})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(S,{className:"h-5 w-5 text-blue-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"To'liq ism"}),u.jsxs("p",{className:"text-white",children:[l.first_name," ",l.last_name," ",l.patronymic]})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(oe,{className:"h-5 w-5 text-green-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Email"}),u.jsx("p",{className:"text-white",children:l.email})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(ce,{className:"h-5 w-5 text-purple-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Telefon"}),u.jsx("p",{className:"text-white",children:l.phone})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(de,{className:"h-5 w-5 text-yellow-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Tashkilot"}),u.jsx("p",{className:"text-white",children:l.affiliation})]})]}),l.orcid_id&&u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(me,{className:"h-5 w-5 text-red-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"ORCID ID"}),u.jsx("p",{className:"text-white",children:l.orcid_id})]})]}),l.telegram_username&&u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx("span",{className:"text-lg mr-3",children:"@"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Telegram"}),u.jsx("p",{className:"text-white",children:l.telegram_username})]})]})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(ja,{onClick:()=>x(!0),children:[u.jsx(F,{className:"mr-2 h-4 w-4"})," Tahrirlash"]})})]})})]})}),l.gamification_profile&&u.jsxs(fa,{title:"Gamifikatsiya",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-blue-500/20 mb-4",children:u.jsx(xe,{className:"h-8 w-8 text-blue-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.level}),u.jsx("p",{className:"text-gray-400",children:"Daraja"})]}),u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-yellow-500/20 mb-4",children:u.jsx(xe,{className:"h-8 w-8 text-yellow-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.points}),u.jsx("p",{className:"text-gray-400",children:"Ballar"})]}),u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-purple-500/20 mb-4",children:u.jsx(xe,{className:"h-8 w-8 text-purple-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.badges.length}),u.jsx("p",{className:"text-gray-400",children:"Mukofotlar"})]})]}),l.gamification_profile.badges.length>0&&u.jsxs("div",{className:"mt-6",children:[u.jsx("h4",{className:"text-md font-semibold text-white mb-3",children:"Mukofotlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:l.gamification_profile.badges.map((e,a)=>u.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 rounded-full text-sm",children:e},a))})]})]}),u.jsx(fa,{title:"Hisobni boshqarish",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-medium text-blue-300 mb-2",children:"Test To'lov"}),u.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Click to'lov tizimini sinab ko'rish uchun 1000 so'm miqdorida test to'lovini amalga oshirish mumkin."}),c&&u.jsx("div",{className:"mb-3 p-2 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-300",children:c}),u.jsxs(ja,{onClick:async()=>{var e;if(!p){f(!0),d(null);try{Z.info("To'lov tayyorlanmoqda...",{autoClose:2e3});const a=await Ia.createTransactionAndPay(1e3,"UZS","top_up");if(a&&!0===a.success&&a.payment_url)Z.success("To'lov sahifasiga yo'naltirilmoqdasiz...",{autoClose:2e3}),setTimeout(()=>{a.payment_url&&Ia.redirectToPayment(a.payment_url)},1500);else{let t="To'lovni amalga oshirishda xatolik yuz berdi";a&&(a.user_message?t=a.user_message:a.error_note?t=a.error_note:a.error?t=a.error:a.details&&(a.details.user_message?t=a.details.user_message:a.details.error_note?t=a.details.error_note:a.details.error&&(t=a.details.error)),a.payment_url||(t=-514===a.error_code||-514===(null==(e=a.details)?void 0:e.error_code)?"Sizning telefon raqamingiz Click tizimida ro'yxatdan o'tmagan. Iltimos, telefon raqamingizni Click tizimida ro'yxatdan o'tkazing va qayta urinib ko'ring.":-1!==a.error_code&&a.error_code?"To'lovni amalga oshirishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.":"To'lov URL yaratib bo'lmadi. Iltimos, qayta urinib ko'ring yoki texnik yordamga murojaat qiling.")),console.error("Payment failed:",a),Z.error(t,{autoClose:8e3}),d(t)}}catch(a){console.error("Test payment error:",a);let e="To'lovni amalga oshirishda xatolik yuz berdi";if(a.response){const t=a.response.data||a.response;e=t.error_note||t.error||t.detail||e}else a.message?e=a.message:"string"==typeof a&&(e=a);Z.error(e,{autoClose:5e3}),d(e)}finally{f(!1)}}},disabled:p,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[u.jsx(X,{className:"mr-2 h-4 w-4"}),p?"Jarayonda...":"1000 so'm test to'lov"]}),p&&u.jsx("div",{className:"text-xs text-gray-400 text-center",children:"To'lov tayyorlanmoqda, iltimos kuting..."})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4 pt-4 border-t border-white/10",children:u.jsx(ja,{variant:"danger",onClick:i,children:"Chiqish"})})]})})]}):u.jsx(fa,{title:"Xatolik",children:u.jsx("p",{children:"Profil ma'lumotlari topilmadi."})})},Ba=({data:e})=>{const a=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsx("defs",{children:u.jsxs("radialGradient",{id:"grad-bg-sub",children:[u.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),u.jsx("stop",{offset:"100%",stopColor:"#f7f7f9"})]})}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#grad-bg-sub)"}),u.jsx("g",{transform:"translate(420 297) rotate(15) scale(2.5)",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-[#3A527A]",opacity:"0.04",children:[u.jsx("path",{d:"M16.88,7.31c-2.39-2.39-6.26-2.39-8.65,0L12,11.06L16.88,7.31z",fill:"currentColor",opacity:"0.5"}),u.jsx("path",{d:"M11.06,12l-3.75,3.75c2.39,2.39,6.26,2.39,8.65,0l-4.9-4.9V12z",fill:"currentColor"}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"currentColor"})]})})]});return u.jsxs("div",{className:"bg-white text-gray-800 aspect-[210/297] w-full max-w-4xl mx-auto shadow-2xl overflow-hidden relative font-sans p-2",children:[u.jsx(a,{}),u.jsx("div",{className:"absolute inset-4 border-2 border-[#3A527A] p-1",children:u.jsx("div",{className:"w-full h-full border border-[#3A527A]/50"})}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-20 py-16",children:[u.jsxs("header",{className:"flex flex-col items-center w-full pb-4",children:[u.jsx(va,{}),u.jsx("p",{className:"font-serif text-md text-slate-700 tracking-widest uppercase mt-2",children:"Phoenix Ilmiy Nashrlar Markazi"})]}),u.jsx("h1",{className:"font-serif text-5xl font-bold text-[#3A527A] tracking-wide my-8 text-center",children:"MA'LUMOTNOMA"}),u.jsxs("main",{className:"flex-grow text-base text-slate-800 leading-relaxed text-justify",children:[u.jsxs("p",{className:"mb-6",children:["Ushbu ma'lumotnoma ",u.jsx("strong",{className:"text-black",children:e.authorFullName}),"ga (",u.jsx("span",{className:"italic",children:e.authorAffiliation}),") uning ",u.jsxs("strong",{className:"text-black",children:['"',e.articleTitle,'"']})," nomli ilmiy maqolasi",u.jsxs("strong",{className:"text-black",children:[' "',e.journalName,'"']})," jurnaliga",u.jsxs("strong",{className:"text-black",children:[" ",e.submissionDate]})," sanasida topshirilganligini tasdiqlash uchun berildi."]}),u.jsxs("div",{className:"my-8 border-y border-gray-200 py-4 px-6 bg-gray-50/50 rounded-md",children:[u.jsx("h2",{className:"text-center font-semibold text-lg text-slate-700 mb-4",children:"Batafsil ma'lumotlar"}),u.jsxs("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 gap-y-2 text-sm",children:[u.jsx("strong",{className:"text-slate-600 text-right",children:"Maqola sarlavhasi:"}),u.jsx("span",{className:"text-slate-800",children:e.articleTitle}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Jurnal:"}),u.jsx("span",{className:"text-slate-800",children:e.journalName}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Topshirilgan sana:"}),u.jsx("span",{className:"text-slate-800",children:e.submissionDate}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Joriy holati:"}),u.jsx("span",{className:"font-semibold text-blue-700",children:e.currentStatus})]})]}),u.jsx("p",{children:"Maqola tahririyat tomonidan qabul qilingan va belgilangan tartibda ko'rib chiqish jarayonida."})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-8 mt-auto",children:[u.jsxs("div",{className:"text-left text-xs text-slate-500",children:[u.jsxs("p",{children:["Ma'lumotnoma raqami: ",e.referenceNumber]}),u.jsxs("p",{children:["Berilgan sana: ",e.issueDate]})]}),u.jsx(Na,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-12 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"}),u.jsx("p",{className:"text-xs text-slate-600",children:"PINM Tahririyati"})]})]})]})]})},Qa=()=>{var t;const{id:s}=ue(),{user:i}=ia(),r=a(),[n,c]=e.useState(null),[d,m]=e.useState(!0),[x,g]=e.useState(null),[p,f]=e.useState([]),[j,b]=e.useState(!1),[y,v]=e.useState(null);e.useEffect(()=>{(async()=>{if(s&&i)try{m(!0),g(null);const e=await Ze.get(s),a=e.data||e;c(a),f([{id:"1",articleId:s,timestamp:(new Date).toISOString(),action:"Maqola yaratildi",details:"Muallif tomonidan yangi maqola yaratildi"}]),v({referenceNumber:`REF-${a.id.substring(0,8).toUpperCase()}`,issueDate:(new Date).toISOString(),authorFullName:`${i.firstName} ${i.lastName}`,authorAffiliation:i.affiliation,articleTitle:a.title,journalName:a.journal_name||"Noma'lum jurnal",submissionDate:a.submission_date||(new Date).toISOString(),currentStatus:a.status,articleId:a.id})}catch(e){console.error("Failed to fetch article data:",e),g("Maqola ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[s,i]);const N=async(e,a)=>{if(s)try{await Ze.updateStatus(s,e,a);const t=await Ze.get(s),i=t.data||t;c(i)}catch(t){console.error("Failed to update article status:",t),g("Maqola holatini yangilashda xatolik yuz berdi.")}};if(d)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});if(!n)return u.jsxs(fa,{title:"Maqola topilmadi",children:[u.jsx("p",{children:"Ko'rsatilgan ID bo'yicha maqola topilmadi."}),u.jsx(ja,{onClick:()=>r("/articles"),className:"mt-4",children:"Orqaga qaytish"})]});const k=(S=n.status,{Qoralama:{text:"Qoralama",color:"bg-gray-500/20 text-gray-300",icon:l},Yangi:{text:"Yangi",color:"bg-blue-500/20 text-blue-300",icon:w},Redaktorda:{text:"Redaktorda",color:"bg-indigo-500/20 text-indigo-300",icon:F},"Qabul Qilingan":{text:"Qabul Qilingan",color:"bg-yellow-500/20 text-yellow-300",icon:o},"Yozish jarayonida":{text:"Yozilmoqda",color:"bg-cyan-500/20 text-cyan-300",icon:F},"Nashrga Yuborilgan":{text:"Nashrga Yuborilgan",color:"bg-purple-500/20 text-purple-300",icon:fe},"Tahrirga qaytarilgan":{text:"Tahrirga qaytarilgan",color:"bg-orange-500/20 text-orange-300",icon:F},"Qabul qilingan":{text:"Ma'qullangan",color:"bg-teal-500/20 text-teal-300",icon:I},"Nashr etilgan":{text:"Nashr etilgan",color:"bg-green-500/20 text-green-300",icon:pe},"Rad etilgan":{text:"Rad etilgan",color:"bg-red-500/20 text-red-300",icon:q}}[S]||{text:S,color:"bg-gray-500/20 text-gray-300",icon:l});var S;const T=k.icon;return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs(h,{to:"/articles",className:"text-blue-400 hover:text-blue-300 flex items-center gap-2 mb-2",children:[u.jsx("span",{children:"←"})," Maqolalar ro'yxati"]}),u.jsx("h1",{className:"text-3xl font-bold text-white",children:n.title})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2 ${k.color}`,children:[u.jsx(T,{size:16}),k.text]}),n.fast_track&&u.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-500/20 text-yellow-300 flex items-center gap-2",children:[u.jsx(xe,{size:16}),"Tezkor"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[u.jsx(fa,{title:"Asosiy ma'lumotlar",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Muallif(lar)"}),u.jsx("p",{className:"text-white",children:n.author_name||"Noma'lum"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Annotatsiya"}),u.jsx("p",{className:"text-gray-300",children:n.abstract||"Annotatsiya mavjud emas"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Kalit so'zlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:(null==(t=n.keywords)?void 0:t.map((e,a)=>u.jsx("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded-full text-sm",children:e},a)))||u.jsx("span",{className:"text-gray-400",children:"Kalit so'zlar mavjud emas"})})]})]})}),u.jsx(fa,{title:"Fayllar",children:u.jsx("div",{className:"space-y-4",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs(ja,{onClick:()=>{(null==n?void 0:n.file_url)&&(window.open(n.file_url,"_blank"),s&&Ze.incrementViews(s).catch(e=>{console.error("Failed to increment view count:",e)}))},variant:"secondary",className:"flex items-center justify-center gap-2 flex-1",children:[u.jsx(J,{size:18}),"Ko'rish"]}),u.jsxs(ja,{onClick:()=>{(null==n?void 0:n.file_url)&&(window.open(n.file_url,"_blank"),s&&Ze.incrementDownloads(s).catch(e=>{console.error("Failed to increment download count:",e)}))},variant:"secondary",className:"flex items-center justify-center gap-2 flex-1",children:[u.jsx(he,{size:18}),"Yuklab olish"]})]})})}),u.jsx(fa,{title:"Faoliyat jurnali",children:u.jsx("div",{className:"space-y-4",children:p.map(e=>u.jsxs("div",{className:"flex gap-4 p-4 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"flex-shrink-0 w-10 h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:u.jsx(ge,{className:"h-5 w-5 text-blue-400"})}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx("span",{className:"font-medium text-white",children:e.action}),u.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleString()})]}),u.jsx("p",{className:"text-sm text-gray-300 mt-1",children:e.details||""}),e.userId&&u.jsxs("span",{className:"text-xs text-gray-500",children:["Foydalanuvchi ID: ",e.userId]})]})]},e.id))})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx(fa,{title:"Boshqaruv",children:u.jsxs("div",{className:"space-y-4",children:[(null==i?void 0:i.role)===ra.Author&&u.jsxs(ja,{onClick:()=>r(`/submit/${s}`),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(F,{size:18}),"Tahrirlash"]}),(null==i?void 0:i.role)===ra.JournalAdmin&&u.jsxs(u.Fragment,{children:[u.jsxs(ja,{onClick:()=>N(na.Accepted),variant:"primary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(I,{size:18}),"Qabul qilish"]}),u.jsxs(ja,{onClick:()=>N(na.Revision),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(F,{size:18}),"Tahrirga qaytarish"]}),u.jsxs(ja,{onClick:()=>N(na.Rejected),variant:"danger",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(B,{size:18}),"Rad etish"]})]}),u.jsxs(ja,{onClick:()=>b(!0),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(C,{size:18}),"Sertifikat chop etish"]})]})}),u.jsx(fa,{title:"Statistika",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Ko'rishlar"}),u.jsx("span",{className:"text-white font-medium",children:n.views||0})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Yuklab olishlar"}),u.jsx("span",{className:"text-white font-medium",children:n.downloads||0})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Yuborilgan sana"}),u.jsx("span",{className:"text-white font-medium",children:n.submission_date?new Date(n.submission_date).toLocaleDateString():"Noma'lum"})]})]})})]})]}),j&&y&&u.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-lg shadow-2xl",children:[u.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Yuborish sertifikati"}),u.jsx(ja,{onClick:()=>b(!1),variant:"secondary",children:"Yopish"})]}),u.jsx("div",{className:"p-4 max-h-[80vh] overflow-y-auto",children:u.jsx(Ba,{data:y})})]})})]})},Ha=({children:e,title:a})=>u.jsxs("div",{className:"min-h-screen bg-transparent flex flex-col justify-center items-center p-4",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-5xl font-extrabold text-white drop-shadow-lg",children:"Phoenix Ilmiy Nashrlar Markazi"}),u.jsx("p",{className:"text-gray-300 mt-3 text-lg",children:"PINM Tizimiga Xush Kelibsiz"})]}),u.jsx("div",{className:"w-full max-w-md",children:e})]}),Ka=()=>{const[t,s]=e.useState(""),[i,l]=e.useState(""),[r,n]=e.useState(!1),[o,c]=e.useState(""),[d,m]=e.useState(!1),{login:x,user:g}=ia(),p=a();e.useEffect(()=>{g&&p("/dashboard")},[g,p]);return u.jsx(Ha,{title:"Tizimga kirish",children:u.jsxs(fa,{children:[u.jsxs("form",{onSubmit:async e=>{e.preventDefault(),c(""),n(!0);try{if(!t||9!==t.length)return c("Iltimos, telefon raqamni to'liq kiriting (9 ta raqam, masalan: 901234567)"),void n(!1);const e=`998${t}`;if(!i||0===i.trim().length)return c("Iltimos, parolni kiriting."),void n(!1);await x(e,i)||c("Telefon raqam yoki parol xato.")}catch(a){const e=Le(a);c(e)}finally{n(!1)}},className:"space-y-6",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Tizimga kirish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Telefon raqam va parol bilan kirish"})]}),o&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-sm text-red-300",children:o}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon raqam"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"px-3 py-3 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 font-medium whitespace-nowrap",children:"+998"}),u.jsx("input",{type:"tel",name:"phone",id:"phone",value:t,onChange:e=>{const a=(e=>{let a=e.replace(/\D/g,"");return a.startsWith("998")&&(a=a.substring(3)),a.substring(0,9)})(e.target.value);s(a)},className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"90 123 45 67",required:!0,maxLength:12})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Faqat raqam kiriting"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{id:"password",name:"password",type:d?"text":"password",value:i,onChange:e=>l(e.target.value),autoComplete:"current-password",required:!0,className:"w-full p-3 pr-10 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"Parolingizni kiriting"}),u.jsx("button",{type:"button",onClick:()=>m(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:d?u.jsx(je,{size:20}):u.jsx(J,{size:20})})]})]}),u.jsx("div",{className:"flex items-center justify-between",children:u.jsx(h,{to:"/forgot-password",className:"text-sm text-blue-400 hover:text-blue-300",children:"Parolni unutdingizmi?"})}),u.jsx(ja,{type:"submit",className:"w-full flex items-center justify-center gap-2",disabled:r,children:r?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Kirish amalga oshirilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(be,{size:18}),"Tizimga kirish"]})})]}),u.jsx("div",{className:"mt-6 text-center text-sm",children:u.jsxs("p",{className:"text-gray-400",children:["Hisobingiz yo'qmi?"," ",u.jsx(h,{to:"/register",className:"font-semibold text-blue-400 hover:text-blue-300",children:"Ro'yxatdan o'tish"})]})})]})})},Xa=()=>{const t=a(),{user:s,login:i}=ia(),[l,r]=e.useState(1),[n,o]=e.useState(""),[c,d]=e.useState(""),[m,x]=e.useState(""),[g,p]=e.useState(""),[f,j]=e.useState(""),[b,y]=e.useState(""),[v,w]=e.useState(""),[k,q]=e.useState(!1),[S,T]=e.useState(""),[_,A]=e.useState(!1);e.useEffect(()=>{s&&t("/dashboard")},[s,t]);return u.jsx(Ha,{title:"Yangi Hisob Yaratish",children:u.jsxs(fa,{children:[1===l?u.jsxs("form",{onSubmit:e=>{e.preventDefault(),T(""),n&&9===n.length?c.trim()?m.trim()?!g||g.length<6?T("Parol kamida 6 ta belgidan iborat bo'lishi kerak"):g===f?r(2):T("Parollar mos kelmayapti"):T("Iltimos, familiyangizni kiriting"):T("Iltimos, ismingizni kiriting"):T("Iltimos, telefon raqamni to'liq kiriting (9 ta raqam, masalan: 901234567)")},className:"space-y-4",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Ro'yxatdan o'tish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Asosiy ma'lumotlarni kiriting"})]}),S&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded text-sm text-red-300",children:S}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon raqam *"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"px-3 py-3 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 font-medium whitespace-nowrap",children:"+998"}),u.jsx("input",{type:"tel",value:n,onChange:e=>{const a=(e=>{let a=e.replace(/\D/g,"");return a.startsWith("998")&&(a=a.substring(3)),a.substring(0,9)})(e.target.value);o(a)},className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"90 123 45 67",required:!0,maxLength:12})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Faqat raqam kiriting (masalan: 901234567)"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:c,onChange:e=>d(e.target.value),placeholder:"Ismingiz"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:m,onChange:e=>x(e.target.value),placeholder:"Familiyangiz"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol *"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:_?"text":"password",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500 pr-10",value:g,onChange:e=>p(e.target.value),placeholder:"Kamida 6 ta belgi",minLength:6}),u.jsx("button",{type:"button",onClick:()=>A(!_),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:_?"👁️":"👁️‍🗨️"})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Kamida 6 ta belgi (har qanday belgilar)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parolni tasdiqlang *"}),u.jsx("input",{type:_?"text":"password",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:f,onChange:e=>j(e.target.value),placeholder:"Parolni qayta kiriting",minLength:6})]}),u.jsxs(ja,{type:"submit",className:"w-full flex items-center justify-center gap-2",children:["Keyingi bosqich",u.jsx(N,{className:"h-4 w-4"})]})]}):u.jsxs("form",{onSubmit:async e=>{e.preventDefault(),T(""),q(!0);try{const e=n.startsWith("998")?n:`998${n}`,s={phone:e,email:b.trim()||`${e}@temp.phoenix.uz`,first_name:c.trim(),last_name:m.trim(),affiliation:v.trim()||"N/A",password:g,password_confirm:f},l=await Ke.register(s);if(!l.access||!l.user)throw new Error("Ro'yxatdan o'tishda xatolik yuz berdi.");Z.success("Muvaffaqiyatli ro'yxatdan o'tdingiz!",{autoClose:2e3});try{const a=await i(e,g);t(a?"/dashboard":"/login")}catch(a){console.error("Auto login failed:",a),t("/login")}}catch(s){const e=Ue(s,"phone"),a=Ue(s,"email"),t=Ue(s,"password");let i="Ro'yxatdan o'tishda xatolik yuz berdi.";i=e?`Telefon raqam: ${e}`:a?`Email: ${a}`:t?`Parol: ${t}`:Le(s),T(i),Z.error(i,{autoClose:5e3})}finally{q(!1)}},className:"space-y-4",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>r(1),className:"text-gray-400 hover:text-white mb-4 flex items-center gap-2 mx-auto",children:[u.jsx(ye,{className:"h-4 w-4"}),"Orqaga"]}),u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Qo'shimcha ma'lumotlar"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Bu maydonlar ixtiyoriy"})]}),S&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded text-sm text-red-300",children:S}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Email ",u.jsx("span",{className:"text-gray-500 text-xs",children:"(ixtiyoriy)"})]}),u.jsx("input",{type:"email",className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:b,onChange:e=>y(e.target.value),placeholder:"email@example.com"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Bo'sh qoldirish mumkin"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Ish yoki o'qish joyi ",u.jsx("span",{className:"text-gray-500 text-xs",children:"(ixtiyoriy)"})]}),u.jsx("input",{type:"text",className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:v,onChange:e=>w(e.target.value),placeholder:"Tashkilot nomi..."}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Bo'sh qoldirish mumkin"})]}),u.jsx(ja,{type:"submit",className:"w-full flex items-center justify-center gap-2",disabled:k,children:k?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Ro'yxatdan o'tilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(ve,{className:"h-4 w-4"}),"Ro'yxatdan o'tish"]})})]}),u.jsx("div",{className:"mt-6 text-center text-sm",children:u.jsxs("p",{className:"text-gray-400",children:["Hisobingiz bormi?"," ",u.jsx(h,{to:"/login",className:"font-semibold text-blue-400 hover:text-blue-300",children:"Kirish"})]})})]})})},Za=()=>{const[t]=Ne(),s=a(),i=t.get("transaction_id"),[l,r]=e.useState(!1),[n,c]=e.useState(null),[d,m]=e.useState(""),[x,h]=e.useState("idle");e.useEffect(()=>{i?g():m("Transaction ID topilmadi")},[i]),e.useEffect(()=>{if(n&&"success"===x){const e=setTimeout(()=>{window.location.href=n},2e3);return()=>clearTimeout(e)}},[n,x]);const g=async()=>{if(i){r(!0),m("");try{const e=await Ge.processPayment(i,"click");e.success&&e.payment_url?(c(e.payment_url),h("success")):(m(e.error||e.error_note||"To'lov URL olinmadi"),h("error"))}catch(e){m(e.message||"To'lov URL yuklashda xatolik"),h("error")}finally{r(!1)}}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex items-center justify-center p-4",children:u.jsxs(fa,{className:"max-w-md w-full",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx(X,{className:"h-16 w-16 mx-auto mb-4 text-blue-400"}),u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Click To'lov"}),u.jsx("p",{className:"text-gray-400",children:"To'lovni amalga oshirish uchun tugmani bosing"})]}),l&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx(we,{className:"h-12 w-12 mx-auto animate-spin text-blue-400 mb-4"}),u.jsx("p",{className:"text-gray-400",children:"To'lov sahifasi tayyorlanmoqda..."})]}),d&&u.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg mb-4",children:u.jsxs("div",{className:"flex items-center gap-2 text-red-300",children:[u.jsx(q,{className:"h-5 w-5"}),u.jsx("p",{children:d})]})}),"success"===x&&n&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2 text-green-300 mb-2",children:[u.jsx(o,{className:"h-5 w-5"}),u.jsx("p",{className:"font-semibold",children:"To'lov sahifasi tayyor!"})]}),u.jsx("p",{className:"text-sm text-gray-400",children:"Quyidagi tugmani bosib, Click to'lov sahifasiga o'ting va karta ma'lumotlarini kiriting."})]}),u.jsxs(ja,{onClick:()=>{n&&(window.location.href=n)},className:"w-full flex items-center justify-center gap-2",children:[u.jsx(X,{className:"h-5 w-5"}),"To'lovni Amalga Oshirish"]}),u.jsx("div",{className:"text-sm text-gray-400 text-center p-3 bg-gray-800/50 rounded-lg",children:u.jsx("p",{children:"ℹ️ Click to'lov sahifasida karta raqami va muddatini kiriting"})}),u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:()=>s("/dashboard"),className:"text-sm text-gray-400 hover:text-white",children:"Orqaga qaytish"})})]}),"error"===x&&u.jsxs("div",{className:"space-y-4",children:[u.jsx(ja,{onClick:g,className:"w-full",children:"Qayta Urinib Ko'rish"}),u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:()=>s("/dashboard"),className:"text-sm text-gray-400 hover:text-white",children:"Orqaga qaytish"})})]})]})})},Wa=()=>{var a,t;const{user:s}=ia(),[i,l]=e.useState([]),[r,n]=e.useState([]),[o,c]=e.useState([]),[d,m]=e.useState(!0),[x,h]=e.useState(null),[g,p]=e.useState(!1),[f,j]=e.useState(!1),[b,y]=e.useState(""),[v,N]=e.useState(null),[w,k]=e.useState(null),q={name:"",issn:"",description:"",journalAdminId:"",categoryId:"",publicationFee:0,pricePerPage:0,imageUrl:"",paymentModel:ca.PostPayment,pricingType:da.Fixed,additionalDocumentConfig:{required:!1,label:"Taqriz fayli",type:"file"}},[S,T]=e.useState(q),[_,A]=e.useState(null);e.useEffect(()=>{(async()=>{if(s&&s.role===ra.SuperAdmin)try{m(!0),h(null);const[e,a,t]=await Promise.all([We.list(),We.listCategories(),Xe.list()]),s=e=>Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],i=s(e),r=s(a),o=s(t);l(i),n(r),c(o)}catch(e){console.error("Failed to fetch data:",e),h("Ma'lumotlarni yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[s]);const z=o.filter(e=>e.role===ra.JournalAdmin||e.role===ra.Reviewer||"journal_admin"===e.role||"reviewer"===e.role);if((null==s?void 0:s.role)!==ra.SuperAdmin)return u.jsx(fa,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(d)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const C=(e=null)=>{if(e){N(e);const a={...e,journalAdminId:e.journalAdminId||e.journal_admin,categoryId:e.categoryId||e.category,paymentModel:e.paymentModel||e.payment_model,pricingType:e.pricingType||e.pricing_type,publicationFee:void 0!==e.publicationFee?e.publicationFee:e.publication_fee,pricePerPage:void 0!==e.pricePerPage?e.pricePerPage:e.price_per_page,additionalDocumentConfig:e.additionalDocumentConfig||q.additionalDocumentConfig};T(a)}else N(null),T(q);p(!0)},P=()=>{p(!1),j(!1),y(""),N(null),k(null),A(null),T(e=>({...e,imageUrl:""}))},M=e=>{const{name:a,value:t}=e.target;T(e=>({...e,[a]:t}))},D=e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0];A(a);const t=new FileReader;t.onloadend=()=>{T(e=>({...e,imageUrl:t.result}))},t.readAsDataURL(a)}},O=e=>{const{name:a,value:t,type:s}=e.target,i="checkbox"===s,l=e.target.checked;T(e=>({...e,additionalDocumentConfig:{...e.additionalDocumentConfig,[a]:i?l:t}}))};return u.jsxs(u.Fragment,{children:[u.jsxs(fa,{title:"Jurnallarni Boshqarish",children:[u.jsx("div",{className:"flex justify-end mb-6",children:u.jsxs(ja,{onClick:()=>C(),children:[u.jsx(ke,{className:"mr-2 h-4 w-4"})," Yangi Jurnal Qo'shish"]})}),u.jsx("div",{className:"space-y-4",children:i.map(e=>{const a=e.journalAdminId||e.journal_admin,t=e.categoryId||e.category,s=e.pricingType||e.pricing_type,i=void 0!==e.publicationFee?e.publicationFee:e.publication_fee,l=void 0!==e.pricePerPage?e.pricePerPage:e.price_per_page,n=o.find(e=>e.id===a),c=r.find(e=>e.id===t),d=s===da.Fixed?`${(i||0).toLocaleString()} so'm`:`${(l||0).toLocaleString()} so'm / sahifa`,m=e.imageUrl||e.image_url;return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex flex-col sm:flex-row justify-between sm:items-center",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[m&&u.jsx("img",{src:m,alt:"Jurnal rasmi",className:"h-16 w-16 rounded-lg object-cover flex-shrink-0",onError:e=>{e.target.style.display="none"}}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-lg text-white",children:e.name}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Admin: ",n?`${n.firstName||n.first_name} ${n.lastName||n.last_name}`:"Tayinlanmagan",u.jsx("span",{className:"mx-2 text-gray-600",children:"•"}),"Kategoriya: ",u.jsx("span",{className:"font-medium text-blue-300",children:(null==c?void 0:c.name)||"Noma'lum"}),u.jsx("span",{className:"mx-2 text-gray-600",children:"•"}),"Narx: ",u.jsx("span",{className:"font-medium text-green-400",children:d})]}),u.jsxs("p",{className:"text-xs text-gray-500 font-mono mt-1",children:["ISSN: ",e.issn]})]})]}),u.jsxs("div",{className:"flex items-center space-x-2 mt-3 sm:mt-0",children:[u.jsx("button",{onClick:()=>C(e),className:"text-indigo-400 hover:text-indigo-200 p-2 rounded-md hover:bg-white/10 transition-colors","aria-label":"Tahrirlash",children:u.jsx(F,{size:18})}),u.jsx("button",{onClick:()=>{k(e)},className:"text-red-400 hover:text-red-200 p-2 rounded-md hover:bg-white/10 transition-colors","aria-label":"O'chirish",children:u.jsx(Y,{size:18})})]})]},e.id)})})]}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(fa,{className:"w-full max-w-2xl",title:v?"Jurnalni Tahrirlash":"Yangi Jurnal Qo'shish",children:[v&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Jurnal Rasmi"}),v.imageUrl||v.image_url?u.jsx("img",{src:v.imageUrl||v.image_url,alt:"Jurnal rasmi",className:"h-32 w-32 rounded-lg object-cover",onError:e=>{e.target.style.display="none"}}):u.jsx("p",{className:"text-gray-400 text-sm",children:"Rasm mavjud emas"})]}),u.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),S.name&&S.categoryId&&S.journalAdminId)try{if(v){const e={name:S.name,issn:S.issn||"",description:S.description||"",journal_admin:S.journalAdminId,category:S.categoryId,payment_model:S.paymentModel||ca.PostPayment,pricing_type:S.pricingType||da.Fixed,publication_fee:Number(S.publicationFee)||0,price_per_page:Number(S.pricePerPage)||0};S.additionalDocumentConfig&&(e.additional_document_config={required:Boolean(S.additionalDocumentConfig.required),label:S.additionalDocumentConfig.label||"Taqriz fayli",type:S.additionalDocumentConfig.type||"file"});const a=await We.update(v.id,e,_||void 0),t=i.map(e=>e.id===v.id?a:e);l(t)}else{const e={name:S.name,issn:S.issn||"",description:S.description||"",journal_admin:S.journalAdminId,category:S.categoryId,payment_model:S.paymentModel||ca.PostPayment,pricing_type:S.pricingType||da.Fixed,publication_fee:Number(S.publicationFee)||0,price_per_page:Number(S.pricePerPage)||0};S.additionalDocumentConfig&&(e.additional_document_config={required:Boolean(S.additionalDocumentConfig.required),label:S.additionalDocumentConfig.label||"Taqriz fayli",type:S.additionalDocumentConfig.type||"file"});const a=await We.create(e,_||void 0);l(e=>[a,...e])}A(null),P()}catch(a){console.error("Failed to save journal:",a);let e="Jurnalni saqlashda xatolik yuz berdi";a.message?e+=`: ${a.message}`:"string"==typeof a?e+=`: ${a}`:a.detail?e+=`: ${a.detail}`:a.error&&(e+=`: ${a.error}`),alert(e)}else alert("Iltimos, Jurnal Nomi, Kategoriyasi va Admini maydonlarini to'ldiring.")},className:"space-y-4 max-h-[80vh] overflow-y-auto pr-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Nomi"}),u.jsx("input",{type:"text",name:"name",value:S.name,onChange:M,className:"w-full",placeholder:"Jurnal nomini kiriting...",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Kategoriyasi"}),f?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:b,onChange:e=>y(e.target.value),className:"w-full",placeholder:"Yangi kategoriya nomi",autoFocus:!0}),u.jsx(ja,{type:"button",onClick:async()=>{if(b.trim())try{const e={name:b.trim()},a=await We.createCategory(e);n(e=>[...e,a]),T(e=>({...e,categoryId:a.id})),y(""),j(!1)}catch(e){console.error("Failed to add category:",e),alert(`Kategoriya qo'shishda xatolik yuz berdi: ${e.message||"Unknown error"}`)}else alert("Kategoriya nomini kiriting.")},className:"!p-3 !rounded-lg",children:u.jsx(I,{size:20})}),u.jsx(ja,{type:"button",variant:"secondary",onClick:()=>j(!1),className:"!p-3 !rounded-lg",children:u.jsx(B,{size:20})})]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{name:"categoryId",value:S.categoryId,onChange:M,className:"w-full",required:!0,children:[u.jsx("option",{value:"",disabled:!0,children:"Kategoriyani tanlang"}),r.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]}),u.jsx(ja,{type:"button",onClick:()=>j(!0),className:"!p-2.5 !rounded-lg",title:"Yangi kategoriya qo'shish",children:u.jsx(ke,{size:18})}),S.categoryId&&u.jsx(ja,{type:"button",variant:"danger",onClick:()=>(async e=>{if(i.some(a=>a.categoryId===e))alert("Ushbu kategoriya jurnallar tomonidan ishlatilmoqda va o'chirib bo'lmaydi.");else if(window.confirm("Haqiqatan ham ushbu kategoriyani o'chirmoqchimisiz?"))try{await We.deleteCategory(e),n(a=>a.filter(a=>a.id!==e)),S.categoryId===e&&T(e=>({...e,categoryId:""}))}catch(a){console.error("Failed to delete category:",a),alert(`Kategoriyani o'chirishda xatolik yuz berdi: ${a.message||"Unknown error"}`)}})(S.categoryId),className:"!p-2.5 !rounded-lg",title:"Tanlangan kategoriyani o'chirish",children:u.jsx(Y,{size:18})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Admini"}),u.jsxs("select",{name:"journalAdminId",value:S.journalAdminId,onChange:M,className:"w-full",required:!0,children:[u.jsx("option",{value:"",disabled:!0,children:"Adminni tanlang"}),z.map(e=>u.jsxs("option",{value:e.id,children:[e.firstName||e.first_name," ",e.lastName||e.last_name]},e.id))]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Narx Turi"}),u.jsxs("select",{name:"pricingType",value:S.pricingType,onChange:M,className:"w-full",children:[u.jsx("option",{value:da.Fixed,children:"Qat'iy narx"}),u.jsx("option",{value:da.PerPage,children:"Sahifa uchun"})]})]}),S.pricingType===da.Fixed?u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chop etish narxi (so'm)"}),u.jsx("input",{type:"number",name:"publicationFee",value:S.publicationFee||"",onChange:M,className:"w-full",placeholder:"200000"})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sahifa narxi (so'm)"}),u.jsx("input",{type:"number",name:"pricePerPage",value:S.pricePerPage||"",onChange:M,className:"w-full",placeholder:"15000"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ISSN"}),u.jsx("input",{type:"text",name:"issn",value:S.issn,onChange:M,className:"w-full",placeholder:"XXXX-XXXX"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'lov Turi"}),u.jsxs("select",{name:"paymentModel",value:S.paymentModel,onChange:M,className:"w-full",children:[u.jsx("option",{value:ca.PrePayment,children:"Maqola qabul qilinishidan oldin"}),u.jsx("option",{value:ca.PostPayment,children:"Maqola qabul qilinganidan so'ng"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Rasmi"}),S.imageUrl?u.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[u.jsx("img",{src:S.imageUrl,alt:"Jurnal rasmi",className:"h-24 w-48 rounded-lg object-cover"}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"journal-image-upload",className:"cursor-pointer bg-white/10 rounded-md py-2 px-3 text-sm font-medium text-blue-300 hover:text-blue-400 hover:bg-white/20",children:"O'zgartirish"}),u.jsx("input",{id:"journal-image-upload",name:"journal-image-upload",type:"file",className:"sr-only",accept:"image/png, image/jpeg",onChange:D}),u.jsx("button",{type:"button",onClick:()=>T(e=>({...e,imageUrl:""})),className:"ml-3 text-red-400 hover:text-red-300 text-sm",children:"O'chirish"})]})]}):u.jsx("div",{className:"mt-2",children:u.jsxs("label",{htmlFor:"journal-image-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(R,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Rasm yuklang (JPG, PNG)"})]}),u.jsx("input",{id:"journal-image-upload",name:"journal-image-upload",type:"file",className:"sr-only",accept:"image/png, image/jpeg",onChange:D})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tavsif"}),u.jsx("textarea",{name:"description",value:S.description,onChange:M,className:"w-full",rows:3,placeholder:"Jurnal haqida qisqacha ma'lumot..."})]}),u.jsxs("div",{className:"pt-4 border-t border-white/10",children:[u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",name:"required",checked:null==(a=S.additionalDocumentConfig)?void 0:a.required,onChange:O,className:"h-5 w-5 rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500",style:{boxShadow:"none"}}),u.jsx("span",{className:"font-medium text-gray-200",children:"Qo'shimcha hujjat talab qilish (masalan, taqriz)"})]}),(null==(t=S.additionalDocumentConfig)?void 0:t.required)&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-8",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjat Nomi"}),u.jsx("input",{type:"text",name:"label",value:S.additionalDocumentConfig.label,onChange:O,className:"w-full",placeholder:"Taqriz fayli"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjat Turi"}),u.jsxs("select",{name:"type",value:S.additionalDocumentConfig.type,onChange:O,className:"w-full",children:[u.jsx("option",{value:"file",children:"Fayl yuklash"}),u.jsx("option",{value:"link",children:"Havola kiritish"})]})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-white/10 mt-6",children:[u.jsx(ja,{type:"button",variant:"secondary",onClick:P,children:"Bekor qilish"}),u.jsx(ja,{type:"submit",children:v?"Saqlash":"Qo'shish"})]})]})]})}),w&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(fa,{className:"w-full max-w-md",title:"O'chirishni tasdiqlang",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[w.imageUrl||w.image_url?u.jsx("img",{src:w.imageUrl||w.image_url,alt:"Jurnal rasmi",className:"h-16 w-16 rounded-lg object-cover",onError:e=>{e.target.style.display="none"}}):null,u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white",children:w.name}),u.jsx("p",{className:"text-gray-400 text-sm",children:"Jurnalni o'chirish"})]})]}),u.jsxs("p",{className:"text-gray-300 mb-6",children:["Haqiqatan ham ",u.jsx("strong",{className:"text-white",children:w.name})," jurnalini o'chirmoqchimisiz? Bu harakatni bekor qilib bo'lmaydi."]}),u.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[u.jsx(ja,{variant:"secondary",onClick:()=>k(null),children:"Bekor qilish"}),u.jsx(ja,{variant:"danger",onClick:async()=>{if(w)try{await We.delete(w.id),l(e=>e.filter(e=>e.id!==w.id)),k(null)}catch(e){console.error("Failed to delete journal:",e),alert(`Jurnalni o'chirishda xatolik yuz berdi: ${e.message||"Unknown error"}`)}},children:"O'chirish"})]})]})})]})},Ga=["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentyabr","Oktyabr","Noyabr","Dekabr"],Va=(new Date).getFullYear(),et=Array.from({length:10},(e,a)=>Va-a),at=()=>{const{user:a}=ia(),{addNotification:t}=la(),[s,i]=e.useState([]),[l,r]=e.useState([]),[n,o]=e.useState([]),[c,d]=e.useState(!0),[m,x]=e.useState(null),[h,g]=e.useState([]),p=e.useMemo(()=>(null==a?void 0:a.role)!==ra.JournalAdmin?[]:l.filter(e=>e.journal_admin===a.id),[a,l]),[f,j]=e.useState(""),[b,y]=e.useState(Va),[v,N]=e.useState((new Date).getMonth()),[w,k]=e.useState(""),[q,S]=e.useState(null);e.useEffect(()=>{p.length>0&&!f&&j(p[0].id)},[p,f]),e.useEffect(()=>{(async()=>{if(a&&a.role===ra.JournalAdmin){d(!0),x(null);try{const[e,a,t,s]=await Promise.all([We.listIssues(),We.list(),Ze.list(),Xe.list()]);i(e.results||e),r(a.results||a),o(t.results||t),g(s.results||s)}catch(e){console.error("Failed to fetch data:",e),x("Ma'lumotlarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{d(!1)}}})()},[a]);const T=e.useMemo(()=>s.find(e=>e.journalId===f&&new Date(e.publicationDate).getFullYear()===b&&new Date(e.publicationDate).getMonth()===v),[s,f,b,v]),_=e.useMemo(()=>n.filter(e=>e.journal===f&&"published"===e.status&&new Date(e.submission_date).getFullYear()===b&&new Date(e.submission_date).getMonth()===v),[f,b,v,n]);if(!a||a.role!==ra.JournalAdmin)return u.jsx(fa,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(c)return u.jsx(fa,{title:"Oylik Sonlar va Arxiv",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(O,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})});if(m)return u.jsx(fa,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:m}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})});return u.jsxs(fa,{title:"Oylik Sonlar va Arxiv",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda jurnallaringiz uchun oylik to'plamlarni boshqarishingiz mumkin."}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg mb-6 flex flex-col md:flex-row gap-4",children:[p.length>1&&u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Jurnal"}),u.jsx("select",{value:f,onChange:e=>j(e.target.value),className:"w-full",disabled:c,children:p.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Yil"}),u.jsx("select",{value:b,onChange:e=>y(parseInt(e.target.value)),className:"w-full",disabled:c,children:et.map(e=>u.jsx("option",{value:e,children:e},e))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Oy"}),u.jsx("select",{value:v,onChange:e=>N(parseInt(e.target.value)),className:"w-full",disabled:c,children:Ga.map((e,a)=>u.jsx("option",{value:a,children:e},e))})]})]}),T?u.jsxs("div",{className:"p-6 bg-green-500/10 border border-green-500/20 rounded-lg text-center",children:[u.jsxs("h3",{className:"text-xl font-bold text-green-300",children:[Ga[v]," ",b," soni allaqachon yaratilgan."]}),u.jsx("p",{className:"text-green-400/80 mt-2",children:"Ma'lumotlarni yangilash uchun quyidagi formadan foydalanishingiz mumkin."})]}):null,u.jsxs("div",{className:"mt-6 space-y-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:T?"Ma'lumotlarni Yangilash":"Yangi Son Yaratish"}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Tanlangan oy uchun ",u.jsx("strong",{className:"text-white",children:Array.isArray(_)?_.length:0})," ta nashr etilgan maqola mavjud."]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'plam PDF fayli"}),u.jsxs("label",{htmlFor:"collection-pdf-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(R,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:q?`Tanlangan: ${q.name}`:"PDF faylni tanlang"})]}),u.jsx("input",{id:"collection-pdf-upload",type:"file",className:"sr-only",onChange:e=>S(e.target.files?e.target.files[0]:null),accept:".pdf",disabled:c})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'plam havolasi (ixtiyoriy)"}),u.jsxs("div",{className:"relative",children:[u.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),u.jsx("input",{type:"text",className:"w-full !pl-10",placeholder:"https://jurnal-sayti.uz/arxiv/2025-09.pdf",value:w,onChange:e=>k(e.target.value),disabled:c})]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx(ja,{onClick:async()=>{if(q||w)try{String(v+1).padStart(2,"0");const e=Ga[v],a=l.find(e=>e.id===f),s=Array.isArray(_)?_.map(e=>e.id).filter(e=>void 0!==e):[],r={journal:f,issue_number:`${b}-${e}`,publication_date:new Date(b,v,28).toISOString().split("T")[0],articles:s,collection_url:w||""};T?(await We.updateIssue(T.id,r,q),t({message:`Jurnalning ${e} ${b} soni muvaffaqiyatli yangilandi!`,link:"/published-articles"})):(await We.createIssue(r,q),t({message:`Jurnalning ${e} ${b} soni muvaffaqiyatli yaratildi!`,link:"/published-articles"}));const n=await We.listIssues();i(n.results||n),Array.isArray(_)&&_.forEach(s=>{h.find(e=>e.id===s.author)&&t({message:`Sizning maqolangiz kiritilgan "${null==a?void 0:a.name}" jurnalining ${e} soni to'plami tayyor!`,link:"/my-collections"})}),alert(`Jurnalning ${e} ${b} soni muvaffaqiyatli saqlandi va mualliflarga xabar yuborildi.`),S(null),k("")}catch(e){console.error("Failed to save issue:",e),alert("Sonni saqlashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}else alert("Iltimos, oylik to'plamning PDF faylini yuklang yoki havola kiriting.")},disabled:c||!q&&!w&&!T,children:c?u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"})," Yuklanmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," ",T?"Yangilash":"Sonni Yopish va Saqlash"]})})})]})]})},tt=()=>{const{user:a}=ia(),[t,s]=e.useState([]),[i,l]=e.useState([]),[r,n]=e.useState(""),[o,c]=e.useState({start:"",end:""}),[d,m]=e.useState("all"),[x,h]=e.useState(!0),[g,p]=e.useState(null),[f,j]=e.useState([]);e.useEffect(()=>{(async()=>{if(a)try{h(!0),p(null);const[e,a]=await Promise.all([Ge.listTransactions(),Xe.list()]),t=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],i=Array.isArray(a)?a:(null==a?void 0:a.data)&&Array.isArray(a.data)?a.data:(null==a?void 0:a.results)&&Array.isArray(a.results)?a.results:[];s(t),l(t),j(i)}catch(e){console.error("Failed to fetch data:",e),p("Tranzaksiyalarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{h(!1)}})()},[a]),e.useEffect(()=>{let e=t;if(r){const a=r.toLowerCase();e=e.filter(e=>{var t;const s=f.find(a=>a.id===e.user);return(s?`${s.first_name} ${s.last_name}`.toLowerCase():"").includes(a)||(null==(t=e.service_type)?void 0:t.toLowerCase().includes(a))||e.article&&e.article.toString().includes(a)||e.translation_request&&e.translation_request.toString().includes(a)})}o.start&&o.end&&(e=e.filter(e=>{const a=new Date(e.created_at);return a>=new Date(o.start)&&a<=new Date(o.end)})),"all"!==d&&(e=e.filter(e=>e.service_type===d)),l(e)},[r,o,d,t,f]);const b={"fast-track":"Tezkor ko'rib chiqish",publication_fee:"Nashr haqi",language_editing:"Tilni tahrirlash",top_up:"Hisobni to'ldirish",book_publication:"Kitob nashri",translation:"Tarjima"},y={pending:"bg-yellow-500/20 text-yellow-300",completed:"bg-green-500/20 text-green-300",failed:"bg-red-500/20 text-red-300",cancelled:"bg-gray-500/20 text-gray-300"};if(!a)return u.jsx(fa,{title:"Ruxsat kerak",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun tizimga kirishingiz kerak."})});if(x)return u.jsx(fa,{title:"Moliyaviy tranzaksiyalar",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(O,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})});if(g)return u.jsx(fa,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:g}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})});const v=i.filter(e=>e.amount>0&&"completed"===e.status).reduce((e,a)=>e+a.amount,0),N=i.filter(e=>e.amount<0&&"completed"===e.status).reduce((e,a)=>e+Math.abs(a.amount),0),w={},k={};return i.forEach(e=>{if("completed"===e.status){const a=e.service_type||"other";e.amount>0?w[a]=(w[a]||0)+e.amount:k[a]=(k[a]||0)+Math.abs(e.amount)}}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx(fa,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-green-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-green-400 font-bold text-xl",children:"+"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Jami tushum"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[v.toLocaleString()," so'm"]})]})]})}),u.jsx(fa,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-red-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-red-400 font-bold text-xl",children:"-"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Jami chiqim"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[N.toLocaleString()," so'm"]})]})]})}),u.jsx(fa,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-blue-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-blue-400 font-bold text-xl",children:"="})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Balans"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[(v-N).toLocaleString()," so'm"]})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(fa,{title:"Tushumlar (Xizmat turlari bo'yicha)",children:u.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Object.entries(w).length>0?Object.entries(w).map(([e,a])=>u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:b[e]||e}),u.jsxs("span",{className:"font-medium text-green-400",children:[a.toLocaleString()," so'm"]})]},e)):u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Ma'lumot mavjud emas"})})}),u.jsx(fa,{title:"Chiqimlar (Xizmat turlari bo'yicha)",children:u.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Object.entries(k).length>0?Object.entries(k).map(([e,a])=>u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:b[e]||e}),u.jsxs("span",{className:"font-medium text-red-400",children:[a.toLocaleString()," so'm"]})]},e)):u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Ma'lumot mavjud emas"})})})]}),u.jsxs(fa,{title:"Moliyaviy tranzaksiyalar",children:[u.jsxs("div",{className:"mb-6 flex flex-col lg:flex-row gap-4",children:[u.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Qidirish"}),u.jsxs("div",{className:"relative",children:[u.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),u.jsx("input",{type:"text",placeholder:"Foydalanuvchi yoki xizmat bo'yicha qidirish...",className:"w-full pl-10",value:r,onChange:e=>n(e.target.value)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sana oralig'i"}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsx("input",{type:"date",className:"w-full",value:o.start,onChange:e=>c(a=>({...a,start:e.target.value}))}),u.jsx("input",{type:"date",className:"w-full",value:o.end,onChange:e=>c(a=>({...a,end:e.target.value}))})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Xizmat turi"}),u.jsxs("select",{className:"w-full",value:d,onChange:e=>m(e.target.value),children:[u.jsx("option",{value:"all",children:"Barcha xizmatlar"}),Object.entries(b).map(([e,a])=>u.jsx("option",{value:e,children:a},e))]})]})]}),u.jsx("div",{className:"flex items-end",children:u.jsxs(ja,{onClick:()=>{const e=[["Foydalanuvchi","Xizmat","Miqdor","Valyuta","Sana","Holat"].join(","),...i.map(e=>{const a=f.find(a=>a.id===e.user),t=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi",s=b[e.service_type]||e.service_type||"Noma'lum",i=`${e.amount>=0?"+":""}${e.amount}`,l=new Date(e.created_at).toLocaleDateString();return`"${t}","${s}","${i}","${e.currency}","${l}","${e.status}"`})].join("\n"),a=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=URL.createObjectURL(a),s=document.createElement("a");s.setAttribute("href",t),s.setAttribute("download",`tranzaksiyalar_${(new Date).toISOString().split("T")[0]}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)},variant:"secondary",disabled:0===i.length,children:[u.jsx(he,{className:"mr-2 h-4 w-4"})," Eksport"]})})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/10",children:u.jsxs("table",{className:"w-full text-left",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Foydalanuvchi"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Xizmat"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Miqdor"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Sana"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Holat"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:i.length>0?i.map(e=>{const a=f.find(a=>a.id===e.user),t=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi";return u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:t}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:b[e.service_type]||e.service_type||"Noma'lum"}),u.jsx("td",{className:"px-4 py-4 text-sm font-medium",children:u.jsxs("span",{className:e.amount>=0?"text-green-400":"text-red-400",children:[e.amount>=0?"+":"",e.amount.toLocaleString()," ",e.currency]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:new Date(e.created_at).toLocaleDateString()}),u.jsx("td",{className:"px-4 py-4 text-sm",children:u.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${y[e.status]||"bg-gray-500/20 text-gray-300"}`,children:e.status})})]},e.id)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center",children:[u.jsx(qe,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-white",children:"Tranzaksiyalar topilmadi"}),u.jsx("p",{className:"mt-1 text-sm text-gray-400",children:r||o.start||o.end||"all"!==d?"Tanlangan filtrlar bo'yicha hech narsa topilmadi.":"Hozircha tranzaksiyalar mavjud emas."})]})})})]})})]})]})},st={"1-10":{eco:125,standart:150},"11-100":{eco:100,standart:125},"101-300":{eco:80,standart:100},"301-1000":{eco:75,standart:80}},it={"1-10":{soft:15e3,hard:2e4},"11-100":{soft:1e4,hard:15e3},"101-300":{soft:8e3,hard:1e4},"301-1000":{soft:6e3,hard:8e3}},lt={"1-10":300,"11-100":300,"101-300":250,"301-1000":200},rt=6e5,nt=({label:e,value:a,onChange:t,min:s,max:i,step:l,icon:r})=>u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-300",children:[u.jsx(r,{className:"w-4 h-4 mr-2"}),e]}),u.jsx("span",{className:"text-sm font-medium text-blue-300 bg-blue-900/30 px-2 py-1 rounded",children:a})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:()=>t(Math.max(s,a-l)),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",type:"button",children:u.jsx(Ae,{className:"w-4 h-4 text-gray-400"})}),u.jsx("input",{type:"range",min:s,max:i,step:l,value:a,onChange:e=>t(parseInt(e.target.value,10)||s),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-500"}),u.jsx("button",{onClick:()=>t(Math.min(i,a+l)),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",type:"button",children:u.jsx(L,{className:"w-4 h-4 text-gray-400"})}),u.jsx("input",{type:"number",min:s,max:i,value:a,onChange:e=>t(parseInt(e.target.value,10)||s),className:"w-24 text-center !py-2"})]})]}),ot=({label:e,options:a,selected:t,onSelect:s})=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e}),u.jsx("div",{className:"flex bg-white/5 rounded-lg p-1",children:a.map(e=>u.jsx("button",{type:"button",onClick:()=>s(e.value),className:"w-full text-center px-4 py-2 rounded-md text-sm font-semibold transition-colors duration-200 "+(t===e.value?"bg-blue-600 text-white shadow":"text-gray-300 hover:bg-white/10"),children:e.label},e.value))})]}),ct=({title:e,description:a,price:t,checked:s,onChange:i})=>u.jsx("div",{onClick:()=>i(!s),className:"p-4 rounded-lg bg-white/5 border-2 cursor-pointer transition-all "+(s?"border-blue-500 bg-blue-500/10":"border-transparent hover:border-white/10"),children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1 pr-4",children:[u.jsx("p",{className:"font-semibold text-white",children:e}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a})]}),u.jsxs("div",{className:"flex flex-col items-end",children:[u.jsx("div",{className:"w-5 h-5 rounded-md flex items-center justify-center border-2 transition-all "+(s?"bg-blue-600 border-blue-500":"bg-white/10 border-white/20"),children:s&&u.jsx(I,{className:"w-3 h-3 text-white"})}),u.jsxs("p",{className:"text-sm font-medium text-blue-300 mt-2 whitespace-nowrap",children:[t.toLocaleString()," so'm"]})]})]})}),dt=()=>u.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center shadow-lg",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:u.jsx("path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"})})}),mt=()=>{const t=a(),{user:s}=ia(),{addNotification:i}=la(),[l,r]=e.useState(150),[n,c]=e.useState(50),[d,m]=e.useState("standart"),[x,h]=e.useState("soft"),[g,p]=e.useState({isbn:!1,design:!1}),[f,j]=e.useState(""),[b,y]=e.useState(""),[v,N]=e.useState(null),[w,k]=e.useState(null),[S,T]=e.useState(!1),[_,A]=e.useState("idle"),[z,C]=e.useState(null),P=e.useRef(null);e.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]);const I=e.useMemo(()=>{const e=(a=n)>=1&&a<=10?"1-10":a>=11&&a<=100?"11-100":a>=101&&a<=300?"101-300":a>=301?"301-1000":null;var a;if(!e||l<=0||n<=0)return{printing:0,cover:0,binding:0,isbn:0,design:0,total:0};const t=st[e][d],s=it[e][x],i=l*n*t,r=n*s,o=n*lt[e],c=g.isbn?rt:0,m=g.design?75e3:0;return{printing:i,cover:r,binding:o,isbn:c,design:m,total:i+r+o+c+m}},[l,n,d,x,g]),M=async e=>{e&&(e.preventDefault(),e.stopPropagation()),C(null),A("processing"),P.current&&clearTimeout(P.current);try{const e=await Ia.createTransactionAndPay(I.total,"UZS","book_publication",void 0,void 0);if(e&&!0===e.success&&e.payment_url)T(!1),i({message:"To'lov sahifasiga yo'naltirilmoqdasiz. To'lovni tugallang."}),setTimeout(()=>{e.payment_url?(e.payment_url,Ia.redirectToPayment(e.payment_url)):(console.error("Payment URL is missing"),A("failed"),C("To'lov URL topilmadi. Iltimos, qayta urinib ko'ring."),T(!0))},500);else{const a=(null==e?void 0:e.user_message)||(null==e?void 0:e.error_note)||(null==e?void 0:e.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";A("failed"),C(a),i({message:a})}}catch(a){console.error("Payment failed:",a);const e=a.message||a.error_note||a.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";A("failed"),C(e),i({message:e})}},F=()=>T(!1),D=e=>`${new Intl.NumberFormat("uz-UZ").format(e)} so'm`;return u.jsxs(u.Fragment,{children:[u.jsx(fa,{title:"Kitob Nashr Etish Kalkulyatori",children:u.jsxs("form",{onSubmit:e=>{e.preventDefault(),I.total<=0?alert("Iltimos, sahifa va nusxalar sonini to'g'ri kiriting."):(A("idle"),C(null),T(!0))},children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-white border-b border-white/10 pb-3",children:"1. Asosiy Parametrlar"}),u.jsx(nt,{label:"Sahifalar soni",value:l,onChange:r,min:16,max:1e3,step:4,icon:Se}),u.jsx(nt,{label:"Nusxalar soni",value:n,onChange:c,min:1,max:1e3,step:1,icon:Te}),u.jsx(ot,{label:"Qog'oz sifati",options:[{value:"eco",label:"Eco"},{value:"standart",label:"Standart"}],selected:d,onSelect:e=>m(e)}),u.jsx(ot,{label:"Muqova turi",options:[{value:"soft",label:"Yumshoq"},{value:"hard",label:"Qattiq"}],selected:x,onSelect:e=>h(e)}),u.jsx("h3",{className:"text-lg font-semibold text-white border-b border-white/10 pb-3 pt-4",children:"2. Qo'shimcha Xizmatlar"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx(ct,{title:"ISBN raqami olish",description:"Kitobingizga xalqaro standart raqamini oling.",price:rt,checked:g.isbn,onChange:e=>p(a=>({...a,isbn:e}))}),u.jsx(ct,{title:"Professional muqova dizayni",description:"Tajribali dizaynerlar tomonidan muqova tayyorlash.",price:75e3,checked:g.design,onChange:e=>p(a=>({...a,design:e}))})]})]}),u.jsx("div",{className:"space-y-6",children:u.jsx("div",{className:"sticky top-24",children:u.jsx(fa,{title:"Hisob-kitob",className:"!bg-black/40",children:I.total>0?u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Chop etish:"}),u.jsx("span",{className:"font-medium text-white",children:D(I.printing)})]}),u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Muqova:"}),u.jsx("span",{className:"font-medium text-white",children:D(I.cover)})]}),u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Tikish:"}),u.jsx("span",{className:"font-medium text-white",children:D(I.binding)})]}),g.isbn&&u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"ISBN:"}),u.jsx("span",{className:"font-medium text-white",children:D(I.isbn)})]}),g.design&&u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Dizayn:"}),u.jsx("span",{className:"font-medium text-white",children:D(I.design)})]}),u.jsxs("div",{className:"flex justify-between items-center pt-4",children:[u.jsx("span",{className:"text-lg font-bold text-white",children:"JAMI:"}),u.jsx("span",{className:"text-2xl font-bold text-blue-300",children:D(I.total)})]})]}):u.jsxs("div",{className:"text-center py-8 text-gray-400",children:[u.jsx(_e,{className:"mx-auto h-8 w-8 mb-2"}),"Narxni hisoblash uchun parametrlarni kiriting."]})})})})]}),u.jsxs("div",{className:"mt-10 pt-6 border-t border-white/10",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"3. Kitob Ma'lumotlari va Fayllar"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kitob Sarlavhasi"}),u.jsx("input",{type:"text",value:f,onChange:e=>j(e.target.value),required:!0,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Annotatsiya / Synopsis"}),u.jsx("textarea",{value:b,onChange:e=>y(e.target.value),required:!0,className:"w-full",rows:4})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Qo'lyozma Fayli (.docx, .pdf)"}),u.jsxs("label",{htmlFor:"manuscript-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors h-full flex flex-col justify-center",children:[u.jsx(R,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:v?v.name:"Faylni yuklang"})]}),u.jsx("input",{id:"manuscript-upload",type:"file",className:"sr-only",onChange:e=>N(e.target.files?e.target.files[0]:null),accept:".doc,.docx,.pdf",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Muqova Rasmi (ixtiyoriy)"}),u.jsxs("label",{htmlFor:"cover-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors h-full flex flex-col justify-center",children:[u.jsx(R,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:w?w.name:"Rasm yuklang"})]}),u.jsx("input",{id:"cover-upload",type:"file",className:"sr-only",onChange:e=>k(e.target.files?e.target.files[0]:null),accept:"image/*"})]})]})]})]})]}),u.jsx("div",{className:"mt-10 pt-6 border-t border-white/10 flex justify-end",children:u.jsx(ja,{type:"submit",disabled:!f||!v||l<=0||n<=0,children:"To'lovga o'tish va Yuborish"})})]})}),S&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(fa,{className:"w-full max-w-sm text-center",children:["idle"===_&&u.jsxs(u.Fragment,{children:[u.jsx(dt,{}),u.jsx("h3",{className:"text-xl font-semibold text-white",children:"To'lovni tasdiqlash"}),u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Kitob nashr etish"}),u.jsx("p",{className:"text-4xl font-bold my-4 text-white",children:D(I.total)}),u.jsx(ja,{onClick:e=>M(e),className:"w-full",type:"button",children:"To'lash"}),u.jsx(ja,{variant:"secondary",onClick:F,className:"w-full mt-3",children:"Bekor qilish"})]}),"processing"===_&&u.jsxs("div",{className:"py-8",children:[u.jsx(O,{className:"mx-auto h-16 w-16 text-blue-500 animate-spin"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===_&&u.jsxs("div",{className:"py-8",children:[u.jsx(o,{className:"mx-auto h-16 w-16 text-green-500"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Kitobingiz ko'rib chiqish uchun yuborildi."}),u.jsx(ja,{onClick:()=>{F(),t("/articles")},className:"w-full mt-6",children:"Yopish"})]}),"failed"===_&&u.jsxs("div",{className:"py-8",children:[u.jsx(q,{className:"mx-auto h-16 w-16 text-red-500"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto",children:z}),u.jsxs("div",{className:"flex space-x-2 mt-6",children:[u.jsx(ja,{onClick:e=>M(e),className:"w-full",type:"button",children:"Qayta urinish"}),u.jsx(ja,{variant:"secondary",onClick:F,className:"w-1/2",type:"button",children:"Yopish"})]})]})]})})]})},xt=()=>{const{user:a}=ia(),[t,s]=e.useState([]),[i,l]=e.useState([]),[r,n]=e.useState([]),[o,c]=e.useState(!0),[m,x]=e.useState(null);e.useEffect(()=>{(async()=>{if(a){c(!0),x(null);try{const[e,a,t]=await Promise.all([We.listIssues(),We.list(),Ze.list()]),i=e=>Array.isArray(e)?e:(null==e?void 0:e.results)||(null==e?void 0:e.data)||[];s(i(e)),l(i(a)),n(i(t))}catch(e){console.error("Failed to fetch data:",e),x("Ma'lumotlarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{c(!1)}}})()},[a]);const h=e.useMemo(()=>a?r.filter(e=>e.author===a.id&&"published"===e.status).map(e=>e.id):[],[a,r]),g=e.useMemo(()=>t.filter(e=>(Array.isArray(e.articles)?e.articles:[]).some(e=>h.includes(e))&&e.collection_url).sort((e,a)=>new Date(a.publication_date).getTime()-new Date(e.publication_date).getTime()),[t,h]);return a?o?u.jsx(fa,{title:"Mening To'plamlarim",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(O,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})}):m?u.jsx(fa,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:m}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})}):u.jsxs(fa,{title:"Mening To'plamlarim",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda sizning maqolalaringiz kiritilgan jurnallarning oylik to'plamlarini topishingiz mumkin."}),u.jsx("div",{className:"space-y-4",children:g.length>0?g.map(e=>{const a=i.find(a=>a.id===e.journal);return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl border border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-white",children:null==a?void 0:a.name}),u.jsxs("p",{className:"font-semibold text-blue-300 mt-1",children:[e.issue_number," soni"]}),u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Nashr sanasi: ",new Date(e.publication_date).toLocaleDateString()]})]}),e.collection_url&&u.jsx("a",{href:e.collection_url,target:"_blank",rel:"noopener noreferrer",className:"w-full sm:w-auto",children:u.jsxs(ja,{variant:"secondary",className:"w-full",children:[u.jsx(he,{className:"mr-2 h-4 w-4"})," To'plamni Yuklash"]})})]})},e.id)}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(d,{className:"mx-auto h-16 w-16 text-gray-500"}),u.jsx("h3",{className:"mt-4 text-xl font-semibold text-white",children:"To'plamlar Hozircha Mavjud Emas"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Maqolangiz biror sonda nashr etilganda va admin to'plam havolasini yuborganda, u shu yerda paydo bo'ladi."})]})})]}):u.jsx(fa,{title:"Xatolik",children:u.jsx("p",{children:"Foydalanuvchi topilmadi."})})},ut=()=>{const{user:a}=ia(),{addNotification:t}=la(),[s,i]=e.useState(null),[r,n]=e.useState("uz"),[d,x]=e.useState("en"),[h,g]=e.useState(null),[p,f]=e.useState(!1),[j,b]=e.useState(!1),y=e.useRef(null),[v,N]=e.useState(!1),[w,k]=e.useState("idle"),[q,S]=e.useState(null),[T,_]=e.useState(null),A=e.useRef(null),z=[{code:"uz",name:"O'zbekcha"},{code:"en",name:"Inglizcha"},{code:"ru",name:"Ruscha"},{code:"fr",name:"Fransuzcha"},{code:"de",name:"Nemischa"},{code:"es",name:"Ispancha"},{code:"ar",name:"Arabcha"}];Q.useEffect(()=>()=>{A.current&&clearTimeout(A.current)},[]);const C=()=>{N(!1),A.current&&clearTimeout(A.current),k("idle"),S(null)},P=async()=>{if(s&&h&&a&&T){S(null),k("processing"),A.current&&clearTimeout(A.current);try{const e=await Ia.createTransactionAndPay(h.cost,"UZS","translation",void 0,T);if(e&&!0===e.success&&e.payment_url)N(!1),t({message:"To'lov sahifasiga yo'naltirilmoqdasiz. To'lovni tugallang."}),setTimeout(()=>{e.payment_url?(e.payment_url,Ia.redirectToPayment(e.payment_url)):(console.error("Payment URL is missing"),k("failed"),S("To'lov URL topilmadi. Iltimos, qayta urinib ko'ring."),N(!0))},500);else{const a=(null==e?void 0:e.user_message)||(null==e?void 0:e.error_note)||(null==e?void 0:e.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";k("failed"),S(a),t({message:a})}}catch(e){console.error("Payment failed:",e);const a=e.message||e.error_note||e.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";k("failed"),S(a)}}},I=async(e=!1)=>{if(s&&h&&a){b(!0);try{const l=await(async e=>{if(a&&e&&h)try{const a={title:e.name,source_language:r,target_language:d,status:oa.Yangi,word_count:h.wordCount,cost:h.cost,submission_date:(new Date).toISOString().split("T")[0]},s=await Ve.create({...a,file:e});return t({message:`"${a.title}" uchun tarjima so'rovi qabul qilindi.`,link:"/my-translations"}),s}catch(s){throw console.error("Failed to create translation request:",s),t({message:"Tarjima so'rovi yuborishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring."}),s}})(s);if(l&&l.id&&_(l.id),!e)return N(!0),void b(!1);Z.success("Tarjima so'rovi muvaffaqiyatli yuborildi va to'lov tasdiqlandi!"),i(null),g(null),_(null),y.current&&(y.current.value="")}catch(l){Z.error("So'rov yuborishda xatolik yuz berdi")}finally{b(!1)}}else Z.error("Barcha maydonlarni to'ldiring")};return u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx(fa,{title:"Ilmiy Tarjima Xizmati",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjatni Yuklash"}),u.jsx("div",{className:"flex items-center justify-center w-full",children:u.jsxs("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed rounded-lg cursor-pointer border-gray-600 hover:border-gray-500 transition-colors",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[u.jsx(c,{className:"w-10 h-10 text-gray-400"}),u.jsxs("p",{className:"mb-2 text-sm text-gray-400",children:[u.jsx("span",{className:"font-semibold",children:"Fayl tanlash"})," yoki olib keling"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"DOC, DOCX, PDF (MAX. 10MB)"}),s&&u.jsxs("p",{className:"mt-2 text-sm text-green-400 flex items-center",children:[u.jsx(o,{className:"w-4 h-4 mr-1"}),s.name]})]}),u.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0];i(a),g(null),_(null)}},accept:".pdf,.doc,.docx,.txt",ref:y})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Manba Tili"}),u.jsx("select",{value:r,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:z.map(e=>u.jsx("option",{value:e.code,children:e.name},e.code))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Maqsad Tili"}),u.jsx("select",{value:d,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 bg-white/10 border border-white/20 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:z.map(e=>u.jsx("option",{value:e.code,children:e.name},e.code))})]})]}),s&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-center",children:u.jsx(ja,{onClick:async()=>{if(s){f(!0);try{const e=s.size/1024,a=Math.round(150*e);g({wordCount:a,cost:500*a,fileName:s.name}),Z.success("Fayl tahlili tugallandi!")}catch(e){console.error("Error analyzing file:",e),Z.error("Fayl tahlilida xatolik yuz berdi")}finally{f(!1)}}else Z.error("Iltimos, fayl tanlang")},disabled:p,variant:"secondary",className:"w-full max-w-xs",children:p?u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Tahlil qilinmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(l,{className:"mr-2 h-4 w-4"}),"Hujjatni Tahlil Qilish"]})})}),h&&u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[u.jsxs("h3",{className:"font-medium text-white mb-3 flex items-center",children:[u.jsx(m,{className:"mr-2 h-5 w-5 text-blue-400"}),"Tahlil Natijalari"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"p-3 bg-blue-900/20 rounded border border-blue-700/30",children:[u.jsx("p",{className:"text-sm text-blue-300",children:"Fayl nomi"}),u.jsx("p",{className:"font-medium text-white truncate",children:h.fileName})]}),u.jsxs("div",{className:"p-3 bg-green-900/20 rounded border border-green-700/30",children:[u.jsx("p",{className:"text-sm text-green-300",children:"So'zlar soni"}),u.jsx("p",{className:"font-medium text-white",children:h.wordCount.toLocaleString()})]}),u.jsxs("div",{className:"p-3 bg-yellow-900/20 rounded border border-yellow-700/30",children:[u.jsx("p",{className:"text-sm text-yellow-300",children:"Taxminiy narx"}),u.jsxs("p",{className:"font-medium text-white",children:[h.cost.toLocaleString()," so'm"]})]})]}),u.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsx(ja,{onClick:()=>I(!1),disabled:j,className:"flex-1",children:j?u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Yuborilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(X,{className:"mr-2 h-4 w-4"}),"To'lov va Yuborish"]})}),u.jsx(ja,{onClick:()=>{g(null),_(null),y.current&&(y.current.value=""),i(null)},variant:"secondary",children:"Bekor qilish"})]})})]})]}),u.jsx("div",{className:"p-4 bg-blue-900/10 border border-blue-700/30 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx(ze,{className:"h-5 w-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-blue-300",children:"Muhim Ma'lumot"}),u.jsx("p",{className:"mt-1 text-sm text-gray-300",children:"Tarjima xizmati uchun narx so'zlar soniga qarab hisoblanadi. Hozirgi narx: 500 so'm har bir so'z uchun. Sifatli tarjima mutaxassislarning qo'lidan chiqadi."})]})]})})]})}),v&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full border border-white/10",children:["idle"===w&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"To'lovni tasdiqlash"}),u.jsx("p",{className:"text-gray-300 mb-2",children:"Tarjima xizmati uchun to'lov:"}),u.jsxs("div",{className:"p-3 bg-blue-900/20 rounded border border-blue-700/30 mb-4",children:[u.jsxs("p",{className:"text-sm text-blue-300",children:["So'zlar soni: ",null==h?void 0:h.wordCount.toLocaleString()]}),u.jsxs("p",{className:"text-lg font-bold text-white mt-1",children:[null==h?void 0:h.cost.toLocaleString()," so'm"]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs(ja,{onClick:P,className:"flex-1",children:[u.jsx(X,{className:"mr-2 h-4 w-4"}),"To'lovni Amalga Oshirish"]}),u.jsx(ja,{variant:"secondary",onClick:C,className:"flex-1",children:"Bekor qilish"})]})]}),"processing"===w&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===w&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-green-500 text-4xl mb-4",children:"✓"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx(ja,{onClick:()=>{C(),I(!0)},className:"w-full mt-6",children:"So'rovni Davom Ettirish"})]}),"failed"===w&&u.jsxs("div",{children:[u.jsx("div",{className:"text-red-500 text-4xl mb-4 text-center",children:"✗"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200 text-center",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto text-center mb-4",children:q}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(ja,{onClick:P,className:"flex-1",children:"Qayta Urinish"}),u.jsx(ja,{variant:"secondary",onClick:C,className:"flex-1",children:"Yopish"})]})]})]})})]})},ht=()=>{const{user:a}=ia(),[t,s]=e.useState([]),[i,r]=e.useState(!0),[n,c]=e.useState(null);e.useEffect(()=>{(async()=>{if(a)try{r(!0),c(null);const e=await Ve.list(),a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[];s(a)}catch(e){console.error("Failed to fetch translation requests:",e),c("Tarjima so'rovlari ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{r(!1)}})()},[a]);const d=e.useMemo(()=>a?t.filter(e=>e.author===a.id).sort((e,a)=>new Date(a.submission_date).getTime()-new Date(e.submission_date).getTime()):[],[a,t]);return a?i?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):n?u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:n}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]}):u.jsxs(fa,{title:"Mening Tarjimalarim",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda siz buyurtma qilgan tarjimalaringiz holatini kuzatib borishingiz mumkin."}),u.jsx("div",{className:"space-y-4",children:d.length>0?d.map(e=>{const a=(e=>{switch(e){case oa.Yangi:return{text:"Yangi",color:"text-blue-400",icon:k};case oa.Jarayonda:return{text:"Jarayonda",color:"text-yellow-400",icon:Ce};case oa.Bajarildi:return{text:"Bajarildi",color:"text-green-400",icon:o};case oa.BekorQilindi:return{text:"Bekor Qilindi",color:"text-red-400",icon:q};default:return{text:e,color:"text-gray-400",icon:l}}})(e.status),t=a.icon;return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl border border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-3",children:[u.jsx(m,{className:"text-indigo-400"}),e.title]}),u.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[e.source_language.toUpperCase()," → ",e.target_language.toUpperCase()]}),u.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[u.jsxs("span",{children:["Yuborilgan sana: ",new Date(e.submission_date).toLocaleDateString()]}),e.status===oa.Jarayonda&&e.reviewer_name&&u.jsxs("span",{className:"ml-2 pl-2 border-l border-gray-600",children:["Tarjimon: ",e.reviewer_name]})]})]}),u.jsxs("div",{className:"flex flex-col sm:items-end gap-2 w-full sm:w-auto",children:[u.jsxs("div",{className:`flex items-center gap-2 font-semibold ${a.color}`,children:[u.jsx(t,{className:"w-5 h-5 "+(e.status===oa.Jarayonda?"animate-spin":"")}),u.jsx("span",{children:a.text})]}),e.status===oa.Bajarildi&&e.translated_file_path&&u.jsx("a",{href:aa(e.translated_file_path),download:!0,children:u.jsxs(ja,{variant:"secondary",className:"w-full",children:[u.jsx(he,{className:"mr-2 h-4 w-4"})," Tarjimani Yuklash"]})})]})]})},e.id)}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(m,{className:"mx-auto h-16 w-16 text-gray-500"}),u.jsx("h3",{className:"mt-4 text-xl font-semibold text-white",children:"Sizda Hozircha Tarjima Buyurtmalari Yo'q"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:'"Xizmatlar" bo\'limi orqali yangi tarjima buyurtma qilishingiz mumkin.'})]})})]}):u.jsx(fa,{title:"Xatolik",children:u.jsx("p",{children:"Foydalanuvchi topilmadi."})})},gt=()=>{var t,s,i,r;const{id:n}=ue(),o=a(),{user:c}=ia(),{addNotification:d}=la(),[x,h]=e.useState(null),[g,p]=e.useState(!0),[f,j]=e.useState(null),[b,y]=e.useState(null),[v,w]=e.useState(!1);if(e.useEffect(()=>{(async()=>{if(n&&c)try{p(!0),j(null);const e=await Ve.get(n),a=e.data||e;h(a)}catch(e){console.error("Failed to fetch translation request:",e),j("Tarjima so'rovi ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{p(!1)}})()},[n,c]),!c||c.role!==ra.Reviewer)return u.jsx(fa,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda ruxsat yo'q."})});if(g)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(f)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:f}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});if(!x)return u.jsx(fa,{title:"Xatolik",children:u.jsx("p",{children:"Tarjima so'rovi topilmadi."})});return u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsxs(fa,{children:[u.jsxs("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-white/10",children:[u.jsx(m,{className:"w-10 h-10 text-indigo-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:x.title}),u.jsxs("p",{className:"text-lg font-semibold text-indigo-300",children:[(null==(t=x.source_language)?void 0:t.toUpperCase())||"Noma'lum"," ",u.jsx(N,{size:16,className:"inline-block mx-2"})," ",(null==(s=x.target_language)?void 0:s.toUpperCase())||"Noma'lum"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm mt-6",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(S,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Muallif"}),u.jsx("p",{className:"font-semibold text-white",children:x.author_name||"Noma'lum"})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(Pe,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Sana"}),u.jsx("p",{className:"font-semibold text-white",children:x.submission_date?new Date(x.submission_date).toLocaleDateString():"Noma'lum"})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(l,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"So'zlar soni"}),u.jsxs("p",{className:"font-semibold text-white",children:[(null==(i=x.word_count)?void 0:i.toLocaleString())||0," ta"]})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(l,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Narxi"}),u.jsxs("p",{className:"font-semibold text-white",children:[(null==(r=x.cost)?void 0:r.toLocaleString())||0," so'm"]})]})]})]})]})}),u.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u.jsx(fa,{title:"Asosiy hujjat",children:x.source_file_path?u.jsx("a",{href:aa(x.source_file_path),download:!0,children:u.jsxs(ja,{variant:"secondary",className:"w-full",children:[u.jsx(he,{className:"mr-2 h-4 w-4"})," Hujjatni yuklab olish"]})}):u.jsx("p",{className:"text-gray-400 text-center py-4",children:"Hujjat mavjud emas"})}),x.status===oa.Yangi&&u.jsx(fa,{title:"Harakatlar",children:u.jsxs(ja,{onClick:async()=>{try{const e={...x,status:oa.Jarayonda,reviewer:c.id},a=await Ve.update(n,e),t=a.data||a;h(t),d({message:`"${t.title}" tarjima so'rovingiz ishga qabul qilindi.`,link:"/my-translations"})}catch(e){console.error("Failed to accept translation request:",e),alert("Tarjima so'rovini qabul qilishda xatolik yuz berdi.")}},className:"w-full",children:[u.jsx(I,{className:"mr-2 h-4 w-4"})," Ishga qabul qilish"]})}),x.status===oa.Jarayonda&&u.jsxs(fa,{title:"Tarjimani yuklash",children:[u.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(R,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:b?`Tanlandi: ${b.name}`:"Tayyor faylni tanlang"})]}),u.jsx("input",{id:"file-upload",type:"file",className:"sr-only",onChange:e=>{e.target.files&&y(e.target.files[0])}})]}),u.jsx(ja,{onClick:async()=>{if(b)try{w(!0);const e={...x,status:oa.Bajarildi,completion_date:(new Date).toISOString(),file:b},a=await Ve.update(n,e),t=a.data||a;h(t),d({message:`Sizning "${x.title}" nomli tarjima so'rovingiz bajarildi va tayyor faylni yuklab olishingiz mumkin.`,link:"/my-translations"}),alert("Tarjima muvaffaqiyatli yakunlandi va muallifga xabar yuborildi."),o("/articles")}catch(e){console.error("Failed to complete translation:",e),alert("Tarjimani yakunlashda xatolik yuz berdi.")}finally{w(!1)}else alert("Iltimos, avval tarjima qilingan faylni yuklang.")},disabled:!b||v,className:"w-full mt-4",children:v?u.jsxs(u.Fragment,{children:[u.jsx(O,{className:"mr-2 h-4 w-4 animate-spin"}),"Yuklanmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," Yakunlash va yuborish"]})})]}),x.status===oa.Bajarildi&&x.translated_file_path&&u.jsx(fa,{title:"Tarjimani yuklab olish",children:u.jsx("a",{href:aa(x.translated_file_path),download:!0,children:u.jsxs(ja,{variant:"primary",className:"w-full",children:[u.jsx(he,{className:"mr-2 h-4 w-4"})," Tarjimani Yuklash"]})})})]})]})},pt=()=>{const[a,t]=e.useState("10000"),[s,i]=e.useState("top_up"),[l,r]=e.useState(null),[n,o]=e.useState(!1);return u.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Click To'lov Test"}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-4",children:"To'lovni amalga oshirish"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Summa (UZS)"}),u.jsx("input",{type:"number",value:a,onChange:e=>t(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Summani kiriting",min:"1000",step:"1000"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xizmat turi"}),u.jsxs("select",{value:s,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"top_up",children:"Hisobni to'ldirish"}),u.jsx("option",{value:"publication_fee",children:"Nashr to'lovi"}),u.jsx("option",{value:"fast-track",children:"Tezkor nashr"}),u.jsx("option",{value:"language_editing",children:"Til tahriri"}),u.jsx("option",{value:"translation",children:"Tarjima"}),u.jsx("option",{value:"book_publication",children:"Kitob nashri"})]})]}),u.jsx("button",{onClick:async()=>{if(!a||parseFloat(a)<=0)Z.error("Iltimos, to'g'ri summani kiriting");else{o(!0),r(null);try{const e=await Ia.createTransactionAndPay(parseFloat(a),"UZS",s);if(r(e),e.success&&e.payment_url)Z.success("To'lov sahifasiga o'tmoqdasiz..."),setTimeout(()=>{Ia.redirectToPayment(e.payment_url)},1e3);else{const a=e.error_note||e.error||"To'lovni amalga oshirishda xatolik yuz berdi";Z.error(a)}}catch(e){console.error("Error processing payment:",e),r({success:!1,error:e.message||"Noma'lum xatolik yuz berdi"}),Z.error("To'lovni amalga oshirishda xatolik yuz berdi")}finally{o(!1)}}},disabled:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Jarayonda...":"To'lovni amalga oshirish"})]})]}),l&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Natija"}),u.jsx("div",{className:"mb-2",children:u.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium "+(l.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:l.success?"Muvaffaqiyatli":"Xatolik"})}),l.payment_url&&u.jsx("div",{className:"mb-4",children:u.jsx("a",{href:l.payment_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"To'lov sahifasiga o'tish"})}),u.jsx("pre",{className:"bg-gray-100 p-4 rounded-md overflow-x-auto text-sm",children:JSON.stringify(l,null,2)})]})]})},ft=()=>{const{user:t}=ia(),s=a(),[i,r]=e.useState([]),[n,c]=e.useState([]),[d,m]=e.useState(!0),[x,h]=e.useState(null),[g,p]=e.useState(""),[f,j]=e.useState("new");e.useEffect(()=>{(null==t?void 0:t.role)===ra.JournalAdmin&&(async()=>{if(t)try{m(!0),h(null);const e=await We.list();let a=[];Array.isArray(e)?a=e:e&&"object"==typeof e&&(a=Array.isArray(e.data)?e.data:Array.isArray(e.results)?e.results:[e]);const s=a.filter(e=>{const a=e;return(e.journalAdminId||e.journal_admin||a.admin_id||a.admin&&a.admin.id)===t.id}),i=s.map(e=>e.id),l=await Ze.list();let n=[];Array.isArray(l)?n=l:l&&"object"==typeof l&&(n=Array.isArray(l.data)?l.data:Array.isArray(l.results)?l.results:[l]);const o=n.filter(e=>i.includes(e.journalId));r(o),c(s)}catch(e){console.error("Failed to fetch admin data:",e),h("Ma'lumotlarni yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[t]);const b=e.useMemo(()=>{let e=i;if("new"===f?e=i.filter(e=>e.status===na.Yangi):"pending"===f&&(e=i.filter(e=>e.status===na.WithEditor||e.status===na.QabulQilingan)),g){const a=g.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a)||e.abstract.toLowerCase().includes(a)||e.keywords.some(e=>e.toLowerCase().includes(a)))}return e},[i,f,g]),y=e.useMemo(()=>({new:i.filter(e=>e.status===na.Yangi).length,pending:i.filter(e=>e.status===na.WithEditor||e.status===na.QabulQilingan).length,all:i.length}),[i]);if((null==t?void 0:t.role)!==ra.JournalAdmin)return u.jsx(fa,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(d)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(fa,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(ja,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const v=async(e,a)=>{try{await Ze.updateStatus(e,a);const t=i.map(t=>t.id===e?{...t,status:a}:t);r(t)}catch(t){console.error("Failed to update article status:",t),h("Maqola holatini yangilashda xatolik yuz berdi.")}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[u.jsxs(fa,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(l,{className:"h-8 w-8 text-blue-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.new}),u.jsx("p",{className:"text-gray-400",children:"Yangi Kelganlar"})]}),u.jsxs(fa,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(k,{className:"h-8 w-8 text-yellow-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.pending}),u.jsx("p",{className:"text-gray-400",children:"Nashrni kutmoqda"})]}),u.jsxs(fa,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(pe,{className:"h-8 w-8 text-green-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.all}),u.jsx("p",{className:"text-gray-400",children:"Jami nashrlar"})]})]}),u.jsxs(fa,{title:"Jurnal Administratori Paneli",children:[u.jsxs("div",{className:"mb-6 border-b border-white/10 flex",children:[u.jsxs("button",{onClick:()=>j("new"),className:"px-4 py-3 font-medium text-sm transition-colors "+("new"===f?"border-b-2 border-blue-400 text-blue-400":"text-gray-400 hover:text-white"),children:["Yangi Kelganlar ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("new"===f?"bg-blue-500/20 text-blue-300":"bg-white/10 text-gray-300"),children:y.new})]}),u.jsxs("button",{onClick:()=>j("pending"),className:"px-4 py-3 font-medium text-sm transition-colors "+("pending"===f?"border-b-2 border-yellow-400 text-yellow-400":"text-gray-400 hover:text-white"),children:["Nashrni kutmoqda ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("pending"===f?"bg-yellow-500/20 text-yellow-300":"bg-white/10 text-gray-300"),children:y.pending})]}),u.jsxs("button",{onClick:()=>j("all"),className:"px-4 py-3 font-medium text-sm transition-colors "+("all"===f?"border-b-2 border-green-400 text-green-400":"text-gray-400 hover:text-white"),children:["Barcha Maqolalar ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("all"===f?"bg-green-500/20 text-green-300":"bg-white/10 text-gray-300"),children:y.all})]})]}),u.jsxs("div",{className:"flex items-center bg-white/5 border border-white/10 rounded-xl mb-6 focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all",children:[u.jsx(z,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Maqola sarlavhasi bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:g,onChange:e=>p(e.target.value)})]}),u.jsx("div",{className:"space-y-4",children:b.length>0?b.map(e=>{const a={[na.Draft]:{text:"Qoralama",color:"bg-gray-500/20 text-gray-300"},[na.Yangi]:{text:"Yangi",color:"bg-blue-500/20 text-blue-300"},[na.WithEditor]:{text:"Redaktorda",color:"bg-indigo-500/20 text-indigo-300"},[na.QabulQilingan]:{text:"Qabul Qilingan",color:"bg-yellow-500/20 text-yellow-300"},[na.Revision]:{text:"Tahrirga qaytarilgan",color:"bg-orange-500/20 text-orange-300"},[na.Accepted]:{text:"Qabul qilingan",color:"bg-teal-500/20 text-teal-300"},[na.Published]:{text:"Nashr etilgan",color:"bg-green-500/20 text-green-300"},[na.Rejected]:{text:"Rad etilgan",color:"bg-red-500/20 text-red-300"},[na.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"bg-purple-500/20 text-purple-300"},[na.WritingInProgress]:{text:"Yozilmoqda",color:"bg-cyan-500/20 text-cyan-300"}}[e.status]||{text:e.status,color:"bg-gray-500/20 text-gray-300"};return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 border border-transparent hover:border-white/10",children:u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"text-lg font-semibold text-white",children:e.title}),u.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:e.abstract}),u.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:e.keywords.map((e,a)=>u.jsx("span",{className:"text-xs px-2 py-1 bg-white/10 text-gray-300 rounded",children:e},a))}),u.jsxs("div",{className:"flex justify-between items-center mt-4 text-xs text-gray-500",children:[u.jsx("span",{children:new Date(e.submissionDate).toLocaleDateString()}),u.jsxs("span",{children:["Sahifalar: ",e.pageCount||0]})]})]}),u.jsxs("div",{className:"flex flex-col items-end gap-2",children:[u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${a.color}`,children:a.text}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{return a=e.id,void s(`/articles/${a}`);var a},className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Ko'rish",children:u.jsx(J,{className:"h-4 w-4 text-blue-400"})}),u.jsx("button",{onClick:()=>{return a=e.id,void s(`/articles/${a}`);var a},className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Tahrirlash",children:u.jsx(A,{className:"h-4 w-4 text-yellow-400"})}),e.status!==na.Accepted&&e.status!==na.Published&&u.jsx("button",{onClick:()=>v(e.id,na.Accepted),className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Qabul qilish",children:u.jsx(o,{className:"h-4 w-4 text-green-400"})}),e.status!==na.Rejected&&u.jsx("button",{onClick:()=>v(e.id,na.Rejected),className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Rad etish",children:u.jsx(q,{className:"h-4 w-4 text-red-400"})})]})]})]})},e.id)}):u.jsx("p",{className:"text-center text-gray-400 py-8",children:g?`"${g}" bo'yicha hech narsa topilmadi.`:"Ushbu bo'limda hozircha maqolalar mavjud emas."})})]})]})},jt=({children:e})=>{const{user:a,loading:t}=ia();return t?u.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"inline-block w-10 h-10 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Yuklanmoqda..."})]})}):a?u.jsx(u.Fragment,{children:e}):u.jsx(Re,{to:"/login",replace:!0})},bt=()=>{const{user:e}=ia();return u.jsxs(Fe,{children:[u.jsx(De,{path:"/login",element:u.jsx(Ka,{})}),u.jsx(De,{path:"/register",element:u.jsx(Xa,{})}),u.jsx(De,{path:"/payment/click",element:u.jsx(Za,{})}),u.jsxs(De,{path:"/",element:u.jsx(jt,{children:u.jsx(pa,{})}),children:[u.jsx(De,{index:!0,element:u.jsx(Re,{to:"/dashboard",replace:!0})}),u.jsx(De,{path:"dashboard",element:u.jsx(ya,{})}),u.jsx(De,{path:"articles",element:u.jsx(Ca,{})}),u.jsx(De,{path:"articles/:id",element:u.jsx(Qa,{})}),u.jsx(De,{path:"translations/:id",element:u.jsx(gt,{})}),u.jsx(De,{path:"published-articles",element:u.jsx(at,{})}),u.jsx(De,{path:"my-collections",element:u.jsx(xt,{})}),u.jsx(De,{path:"my-translations",element:u.jsx(ht,{})}),u.jsx(De,{path:"submit",element:u.jsx(Fa,{})}),u.jsx(De,{path:"submit-book",element:u.jsx(mt,{})}),u.jsx(De,{path:"users",element:u.jsx(Da,{})}),u.jsx(De,{path:"journal-management",element:u.jsx(Wa,{})}),u.jsx(De,{path:"journal-admin-panel",element:u.jsx(ft,{})}),u.jsx(De,{path:"udk-requests",element:u.jsx(Ra,{})}),u.jsx(De,{path:"services",element:u.jsx(Ja,{})}),u.jsx(De,{path:"translation-service",element:u.jsx(ut,{})}),u.jsx(De,{path:"plagiarism-check",element:u.jsx(Ea,{})}),u.jsx(De,{path:"profile",element:u.jsx(Ya,{})}),u.jsx(De,{path:"financials",element:u.jsx(tt,{})}),u.jsx(De,{path:"payment-test",element:u.jsx(pt,{})})]}),u.jsx(De,{path:"*",element:u.jsx(Re,{to:e?"/dashboard":"/login",replace:!0})})]})},yt=()=>u.jsx(Ie,{children:u.jsxs(sa,{children:[u.jsx(bt,{}),u.jsx(Me,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}),vt=document.getElementById("root");if(!vt)throw new Error("Could not find root element to mount to");Oe.createRoot(vt).render(u.jsx(Q.StrictMode,{children:u.jsx(yt,{})}));
