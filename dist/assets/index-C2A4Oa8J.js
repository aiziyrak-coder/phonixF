import{r as e,u as a,L as s,D as t,U as i,F as l,B as r,a as n,C as o,b as d,A as c,c as m,S as x,j as u,d as h,N as g,e as p,f as j,g as b,O as f,W as y,T as v,h as N,I as w,i as k,k as _,l as q,m as S,n as z,o as C,E as A,p as T,R as I,P as M,q as P,s as F,t as D,v as O,Z as $,w as E,x as R,y as U,z as L,G as J,X as Y,H as B,J as Q,K,M as H,Q as X,V as Z,Y as W,_ as G,$ as V,a0 as ee,a1 as ae,a2 as se,a3 as te,a4 as ie,a5 as le,a6 as re,a7 as ne,a8 as oe,a9 as de,aa as ce,ab as me,ac as xe,ad as ue,ae as he,af as ge,ag as pe,ah as je,ai as be,aj as fe,ak as ye,al as ve,am as Ne,an as we,ao as ke,ap as _e,aq as qe,ar as Se,as as ze,at as Ce,au as Ae,av as Te,aw as Ie,ax as Me,ay as Pe,az as Fe,aA as De,aB as Oe,aC as $e,aD as Ee,aE as Re,aF as Ue,aG as Le,aH as Je,aI as Ye,aJ as Be}from"./react-vendor-yBNXSLly.js";import"./vendor-C8MmXo7E.js";function Qe(e,a){var s;if(null==(s=null==e?void 0:e.response)?void 0:s[a]){const s=e.response[a];return Array.isArray(s)&&s.length>0?s[0]:"string"==typeof s?s:null}if(null==e?void 0:e[a]){const s=e[a];return Array.isArray(s)&&s.length>0?s[0]:"string"==typeof s?s:null}return null}function Ke(e){return function(e){var a,s;const t=(null==(a=null==e?void 0:e.message)?void 0:a.toLowerCase())||"",i=(null==(s=null==e?void 0:e.name)?void 0:s.toLowerCase())||"";return t.includes("network")||t.includes("failed to fetch")||t.includes("networkerror")||t.includes("load failed")||t.includes("network request failed")||"typeerror"===i||"NETWORK_ERROR"===(null==e?void 0:e.code)||"ERR_NETWORK"===(null==e?void 0:e.code)||!(null==e?void 0:e.response)}(e)?"Serverga ulanib bo'lmadi. Iltimos, internet aloqasini tekshiring yoki keyinroq urinib ko'ring.":function(e){var a,s,t;return 401===(null==e?void 0:e.status)||401===(null==(a=null==e?void 0:e.response)?void 0:a.status)||(null==(s=null==e?void 0:e.message)?void 0:s.includes("Unauthorized"))||(null==(t=null==e?void 0:e.message)?void 0:t.includes("authentication"))}(e)?"Sizning sessiyangiz muddati tugagan. Iltimos, qayta kiring.":403===(null==e?void 0:e.status)?"Siz bu amalni bajarish huquqiga egasiz.":404===(null==e?void 0:e.status)?"Ma'lumot topilmadi.":500===(null==e?void 0:e.status)?"Server xatosi. Iltimos, keyinroq urinib ko'ring.":function(e){if("string"==typeof e)return e;if(null==e?void 0:e.response){const a=e.response;if(a.non_field_errors&&Array.isArray(a.non_field_errors)&&a.non_field_errors.length>0)return a.non_field_errors[0];if(a.detail)return"string"==typeof a.detail?a.detail:JSON.stringify(a.detail);if(a.error_note)return a.error_note;if(a.error)return"string"==typeof a.error?a.error:JSON.stringify(a.error);if(a.message)return a.message}return(null==e?void 0:e.detail)?"string"==typeof e.detail?e.detail:JSON.stringify(e.detail):(null==e?void 0:e.error_note)?e.error_note:(null==e?void 0:e.error)?"string"==typeof e.error?e.error:JSON.stringify(e.error):(null==e?void 0:e.message)?e.message:"Xatolik yuz berdi. Iltimos, qayta urinib ko'ring."}(e)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)}).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const He="https://api.ilmiyfaoliyat.uz/api/v1",Xe=()=>localStorage.getItem("access_token"),Ze=e=>localStorage.setItem("access_token",e),We=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},Ge=async(e,a={})=>{var s,t,i,l;const r=Xe(),n="undefined"!=typeof FormData&&a.body instanceof FormData,o=new Headers(a.headers||{});n||o.has("Content-Type")||o.set("Content-Type","application/json"),r&&!o.has("Authorization")&&o.set("Authorization",`Bearer ${r}`);const d={...a,headers:o};try{const a=`${He}${e}`;0;const s=await fetch(a,d);if(401===s.status)throw We(),window.location.href="/#/login",new Error("Sizning sessiyangiz muddati tugagan. Iltimos, qayta kiring.");if(!s.ok){const e=await s.text();let a;try{a=JSON.parse(e)}catch(c){if(e.includes("<!DOCTYPE html>")||e.includes("<html")){const t=e.match(/<pre class="exception_value">(.*?)<\/pre>/s);a=t?{detail:t[1].trim(),html:!0}:{detail:`Server xatosi (Status: ${s.status})`,html:!0}}else a={detail:e||"Noma'lum xatolik"}}const t=Ke({response:a,status:s.status}),i=new Error(t);throw i.status=s.status,i.response=a,i}const t=await s.text();if(!t)return{};try{return JSON.parse(t)}catch(c){throw new Error("Invalid response format")}}catch(m){const a=`${He}${e}`;if("TypeError"===(null==m?void 0:m.name)&&((null==(s=null==m?void 0:m.message)?void 0:s.includes("fetch"))||(null==(t=null==m?void 0:m.message)?void 0:t.includes("Failed")))){const e=new Error("Serverga ulanib bo'lmadi.");throw e.name="NetworkError",e.code="NETWORK_ERROR",e.originalError=m,e.url=a,e}if((null==(i=null==m?void 0:m.message)?void 0:i.includes("CORS"))||(null==(l=null==m?void 0:m.message)?void 0:l.includes("cors"))){const e=new Error("Server CORS sozlamalari noto'g'ri. Iltimos, administratorga murojaat qiling.");throw e.name="CORS_ERROR",e.code="CORS_ERROR",e}throw m}},Ve={login:async(e,a)=>{const s=await Ge("/auth/login/",{method:"POST",body:JSON.stringify({phone:e,password:a})});return s.access&&(Ze(s.access),localStorage.setItem("refresh_token",s.refresh)),s},register:async e=>{const a=await Ge("/auth/register/",{method:"POST",body:JSON.stringify(e)});return a.access&&(Ze(a.access),localStorage.setItem("refresh_token",a.refresh)),a},logout:()=>{We()},getProfile:()=>Ge("/auth/profile/"),updateProfile:e=>Ge("/auth/update_profile/",{method:"PUT",body:JSON.stringify(e)}),stats:()=>Ge("/auth/stats/")},ea={list:()=>Ge("/auth/"),get:e=>Ge(`/auth/${e}/`),create:e=>Ge("/auth/",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>Ge(`/auth/${e}/`,{method:"PUT",body:JSON.stringify(a)}),delete:e=>Ge(`/auth/${e}/`,{method:"DELETE"}),stats:()=>Ge("/auth/stats/")},aa={list:e=>{const a=e?`?${new URLSearchParams(e)}`:"";return Ge(`/articles/${a}`)},get:e=>Ge(`/articles/${e}/`),getPublic:e=>Ge(`/articles/public/${e}/`),create:async(e,a)=>{if(!a||!a.mainFile&&!a.additionalFile)return Ge("/articles/",{method:"POST",body:JSON.stringify(e)});{const t=new FormData;Object.keys(e).forEach(a=>{const s=e[a];null!=s&&(Array.isArray(s)||"object"==typeof s?t.append(a,JSON.stringify(s)):t.append(a,s))}),a.mainFile&&t.append("final_pdf_path",a.mainFile),a.additionalFile&&t.append("additional_document_path",a.additionalFile);const i=Xe(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${He}/articles/`,{method:"POST",headers:l,body:t});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(s){throw new Error("Invalid response format")}}},update:async(e,a,s)=>{if(!s||!s.mainFile&&!s.additionalFile)return Ge(`/articles/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const s=a[e];null!=s&&(Array.isArray(s)||"object"==typeof s?i.append(e,JSON.stringify(s)):i.append(e,s))}),s.mainFile&&i.append("final_pdf_path",s.mainFile),s.additionalFile&&i.append("additional_document_path",s.additionalFile);const l=Xe(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${He}/articles/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(t){throw new Error("Invalid response format")}}},delete:e=>Ge(`/articles/${e}/`,{method:"DELETE"}),incrementViews:e=>Ge(`/articles/${e}/increment_views/`,{method:"POST"}),incrementDownloads:e=>Ge(`/articles/${e}/increment_downloads/`,{method:"POST"}),updateStatus:(e,a,s)=>Ge(`/articles/${e}/update_status/`,{method:"POST",body:JSON.stringify({status:a,reason:s})}),checkPlagiarism:e=>Ge(`/articles/${e}/check_plagiarism/`,{method:"POST"})},sa={listCategories:()=>Ge("/journals/categories/"),list:()=>Ge("/journals/journals/"),get:e=>Ge(`/journals/journals/${e}/`),create:async(e,a)=>{if(!a)return Ge("/journals/journals/",{method:"POST",body:JSON.stringify(e)});{const t=new FormData;Object.keys(e).forEach(a=>{const s=e[a];null!=s&&(Array.isArray(s)||"object"==typeof s?t.append(a,JSON.stringify(s)):t.append(a,s))}),t.append("image_url",a);const i=Xe(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${He}/journals/journals/`,{method:"POST",headers:l,body:t});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(s){throw new Error("Invalid response format")}}},update:async(e,a,s)=>{if(!s)return Ge(`/journals/journals/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const s=a[e];null!=s&&(Array.isArray(s)||"object"==typeof s?i.append(e,JSON.stringify(s)):i.append(e,s))}),i.append("image_url",s);const l=Xe(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${He}/journals/journals/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(t){throw new Error("Invalid response format")}}},delete:e=>Ge(`/journals/journals/${e}/`,{method:"DELETE"}),createCategory:e=>Ge("/journals/categories/",{method:"POST",body:JSON.stringify(e)}),deleteCategory:e=>Ge(`/journals/categories/${e}/`,{method:"DELETE"}),listIssues:()=>Ge("/journals/issues/"),createIssue:async(e,a)=>{if(!a)return Ge("/journals/issues/",{method:"POST",body:JSON.stringify(e)});{const t=new FormData;Object.keys(e).forEach(a=>{const s=e[a];null!=s&&(Array.isArray(s)||"object"==typeof s?t.append(a,JSON.stringify(s)):t.append(a,s))}),t.append("collection_file",a);const i=Xe(),l={};i&&(l.Authorization=`Bearer ${i}`),delete l["Content-Type"];const r=await fetch(`${He}/journals/issues/`,{method:"POST",headers:l,body:t});if(!r.ok){const e=await r.text();let a;try{a=JSON.parse(e)}catch(s){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${r.status}`)}const n=await r.text();if(!n)return{};try{return JSON.parse(n)}catch(s){throw new Error("Invalid response format")}}},updateIssue:async(e,a,s)=>{if(!s)return Ge(`/journals/issues/${e}/`,{method:"PUT",body:JSON.stringify(a)});{const i=new FormData;Object.keys(a).forEach(e=>{const s=a[e];null!=s&&(Array.isArray(s)||"object"==typeof s?i.append(e,JSON.stringify(s)):i.append(e,s))}),i.append("collection_file",s);const l=Xe(),r={};l&&(r.Authorization=`Bearer ${l}`),delete r["Content-Type"];const n=await fetch(`${He}/journals/issues/${e}/`,{method:"PUT",headers:r,body:i});if(!n.ok){const e=await n.text();let a;try{a=JSON.parse(e)}catch(t){a={detail:e||"Unknown error"}}throw new Error(a.detail||a.message||`API request failed with status ${n.status}`)}const o=await n.text();if(!o)return{};try{return JSON.parse(o)}catch(t){throw new Error("Invalid response format")}}},deleteIssue:e=>Ge(`/journals/issues/${e}/`,{method:"DELETE"})},ta={listTransactions:()=>Ge("/payments/transactions/"),getTransaction:e=>Ge(`/payments/transactions/${e}/`),createTransaction:e=>Ge("/payments/transactions/",{method:"POST",body:JSON.stringify(e)}),processPayment:(e,a="click")=>Ge(`/payments/transactions/${e}/process_payment/?provider=${a}`,{method:"POST"}),preparePayment:e=>Ge(`/payments/transactions/${e}/prepare_payment/`,{method:"POST"}),checkStatus:e=>Ge(`/payments/transactions/${e}/check_status/`,{method:"POST"})},ia={list:()=>Ge("/translations/"),get:e=>Ge(`/translations/${e}/`),create:e=>{if(e.file){const a=new FormData;return a.append("source_file_path",e.file),Object.keys(e).forEach(s=>{"file"!==s&&a.append(s,e[s])}),Ge("/translations/",{method:"POST",body:a,headers:{}})}return Ge("/translations/",{method:"POST",body:JSON.stringify(e)})},update:(e,a)=>{if(a.file){const s=new FormData;return a.file&&s.append("translated_file_path",a.file),Object.keys(a).forEach(e=>{"file"!==e&&s.append(e,a[e])}),Ge(`/translations/${e}/`,{method:"PUT",body:s,headers:{}})}return Ge(`/translations/${e}/`,{method:"PUT",body:JSON.stringify(a)})},delete:e=>Ge(`/translations/${e}/`,{method:"DELETE"})},la={list:()=>Ge("/notifications/"),markRead:e=>Ge(`/notifications/${e}/mark_read/`,{method:"POST"}),markAllRead:()=>Ge("/notifications/mark_all_read/",{method:"POST"}),unreadCount:()=>Ge("/notifications/unread_count/")},ra=e=>e?e.startsWith("http")?e:`https://api.ilmiyfaoliyat.uz/media/${e}`:"",na={list:()=>Ge("/journals/scientific-fields/"),get:e=>Ge(`/journals/scientific-fields/${e}/`),create:e=>Ge("/journals/scientific-fields/",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>Ge(`/journals/scientific-fields/${e}/`,{method:"PUT",body:JSON.stringify(a)}),delete:e=>Ge(`/journals/scientific-fields/${e}/`,{method:"DELETE"})},oa={list:e=>{const a=e?`?${new URLSearchParams(e)}`:"";return Ge(`/journals/author-publications/${a}`)},get:e=>Ge(`/journals/author-publications/${e}/`),create:e=>Ge("/journals/author-publications/",{method:"POST",body:JSON.stringify(e)}),update:(e,a)=>Ge(`/journals/author-publications/${e}/`,{method:"PUT",body:JSON.stringify(a)}),delete:e=>Ge(`/journals/author-publications/${e}/`,{method:"DELETE"}),myPublications:()=>Ge("/journals/author-publications/my_publications/"),publicationTypes:()=>Ge("/journals/author-publications/publication_types/"),statistics:()=>Ge("/journals/author-publications/statistics/")},da=e.createContext({user:null,login:async()=>!1,logout:()=>{},loading:!1,error:null,notifications:[],addNotification:()=>{},markAsRead:()=>{},markAllAsRead:()=>{},unreadCount:0}),ca=({children:s})=>{const t=a(),[i,l]=e.useState(null),[r,n]=e.useState(!0),[o,d]=e.useState(null),[c,m]=e.useState([]),x=e.useRef(Date.now());e.useEffect(()=>{(async()=>{try{if(!localStorage.getItem("access_token"))return void n(!1);try{const a=await Ve.getProfile(),s=(null==a?void 0:a.data)||a;if(!s)throw new Error("No user data in response");const t={id:s.id||"",firstName:s.first_name||s.firstName||"",lastName:s.last_name||s.lastName||"",patronymic:s.patronymic||"",email:s.email||"",phone:s.phone||"",role:s.role||"author",affiliation:s.affiliation||"",gamificationProfile:s.gamification_profile||{level:"Beginner",badges:[],points:0},avatarUrl:s.avatar_url||s.avatarUrl||"",telegramUsername:s.telegram_username||s.telegramUsername||""};l(t);try{const e=await la.list(),a=(Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:[]).map(e=>({id:e.id,message:e.message,read:e.read,link:e.link||void 0}));m(a)}catch(e){console.error("Failed to fetch notifications:",e)}}catch(a){console.error("Failed to fetch user profile:",a),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),t("/login")}}catch(s){console.error("Error in loadUser:",s),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),t("/login")}finally{n(!1)}})()},[t]);const u=e.useCallback(()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),l(null),Ve.logout(),t("/login")},[t]),h=e.useCallback(e=>{const a={...e,id:x.current++,read:!1};m(e=>[a,...e].slice(0,20))},[]),g=e.useCallback(e=>{m(a=>a.map(a=>a.id===e?{...a,read:!0}:a)),la.markRead(e.toString()).catch(e=>{console.error("Failed to mark notification as read on backend:",e)})},[]),p=e.useCallback(()=>{m(e=>e.map(e=>({...e,read:!0}))),la.markAllRead().catch(e=>{console.error("Failed to mark all notifications as read on backend:",e)})},[]),j=c.filter(e=>!e.read).length,b={user:i,login:async(e,a)=>{var s;n(!0),d(null);try{const s=e.replace(/^\+/,"").replace(/\s/g,"").replace(/\D/g,"");if(!s||s.length<9||s.length>12)return d("Iltimos, to'g'ri telefon raqamni kiriting (9-12 ta raqam)."),n(!1),!1;if(!a||0===a.trim().length)return d("Iltimos, parolni kiriting."),n(!1),!1;const r=await Ve.login(s,a),o=(null==r?void 0:r.data)||r,c=(null==o?void 0:o.access)||(null==o?void 0:o.access_token),m=(null==o?void 0:o.refresh)||(null==o?void 0:o.refresh_token),x=(null==o?void 0:o.user)||o;if(c){if(localStorage.setItem("access_token",c),m&&localStorage.setItem("refresh_token",m),null==x?void 0:x.id){const a={id:x.id,firstName:x.first_name||x.firstName||"",lastName:x.last_name||x.lastName||"",patronymic:x.patronymic||"",email:x.email||"",phone:x.phone||e,role:x.role||"author",affiliation:x.affiliation||"",gamificationProfile:x.gamification_profile||x.gamificationProfile||{level:"Beginner",badges:[],points:0},avatarUrl:x.avatar_url||x.avatarUrl||"",telegramUsername:x.telegram_username||x.telegramUsername||""};return l(a),t("/dashboard"),!0}try{const a=await Ve.getProfile();if(null==a?void 0:a.data){const s=a.data,t={id:s.id,firstName:s.first_name||s.firstName||"",lastName:s.last_name||s.lastName||"",patronymic:s.patronymic||"",email:s.email||"",phone:s.phone||e,role:s.role||"author",affiliation:s.affiliation||"",gamificationProfile:s.gamification_profile||{level:"Beginner",badges:[],points:0},avatarUrl:s.avatar_url||s.avatarUrl||"",telegramUsername:s.telegram_username||s.telegramUsername||""};l(t)}return t("/dashboard"),!0}catch(i){return console.error("Failed to fetch user profile:",i),t("/dashboard"),!0}}return d("Server response did not include access token"),!1}catch(r){let e="Login failed. Please check your credentials.";if(null==(s=null==r?void 0:r.response)?void 0:s.data){const a=r.response.data;e=a.detail||a.message||JSON.stringify(a)}else(null==r?void 0:r.message)?e=r.message:"string"==typeof r&&(e=r);return d(e),!1}finally{n(!1)}},logout:u,loading:r,error:o,notifications:c,addNotification:h,markAsRead:g,markAllAsRead:p,unreadCount:j};return e.createElement(da.Provider,{value:b},s)},ma=()=>{const a=e.useContext(da);if(!a)throw new Error("useAuth must be used within an AuthProvider");return a},xa=()=>{const{notifications:e,addNotification:a,markAsRead:s,markAllAsRead:t,unreadCount:i}=ma();return{notifications:e,addNotification:a,markAsRead:s,markAllAsRead:t,unreadCount:i}};var ua=(e=>(e.Author="author",e.Reviewer="reviewer",e.JournalAdmin="journal_admin",e.SuperAdmin="super_admin",e.Accountant="accountant",e))(ua||{}),ha=(e=>(e.Draft="Qoralama",e.Yangi="Yangi",e.WithEditor="Redaktorda",e.QabulQilingan="Qabul Qilingan",e.WritingInProgress="Yozish jarayonida",e.NashrgaYuborilgan="Nashrga Yuborilgan",e.Revision="Tahrirga qaytarilgan",e.Accepted="Qabul qilingan",e.Rejected="Rad etilgan",e.Published="Nashr etilgan",e))(ha||{}),ga=(e=>(e.Yangi="Yangi",e.Jarayonda="Jarayonda",e.Bajarildi="Bajarildi",e.BekorQilindi="Bekor Qilindi",e))(ga||{}),pa=(e=>(e.PrePayment="pre-payment",e.PostPayment="post-payment",e))(pa||{}),ja=(e=>(e.Fixed="fixed",e.PerPage="per_page",e))(ja||{});const ba={[ua.Author]:"Muallif",[ua.Reviewer]:"Taqrizchi",[ua.JournalAdmin]:"Jurnal administratori",[ua.SuperAdmin]:"Bosh administrator",[ua.Accountant]:"Moliyachi"},fa={[ua.Author]:[{to:"/dashboard",icon:s,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Maqolalarim"},{to:"/submit",icon:d,label:"Maqola yuborish"},{to:"/my-collections",icon:c,label:"To'plamlarim"},{to:"/my-translations",icon:m,label:"Tarjimalarim"},{to:"/services",icon:x,label:"Xizmatlar"}],[ua.Reviewer]:[{to:"/dashboard",icon:s,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Taqrizga kelganlar"}],[ua.JournalAdmin]:[{to:"/dashboard",icon:s,label:"Boshqaruv paneli"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/published-articles",icon:o,label:"Nashr etilganlar"}],[ua.SuperAdmin]:[{to:"/dashboard",icon:s,label:"Boshqaruv paneli"},{to:"/users",icon:i,label:"Foydalanuvchilar"},{to:"/articles",icon:l,label:"Barcha maqolalar"},{to:"/journal-management",icon:r,label:"Jurnallar"},{to:"/udk-requests",icon:n,label:"UDK so'rovlari"}],[ua.Accountant]:[{to:"/dashboard",icon:s,label:"Boshqaruv paneli"},{to:"/financials",icon:t,label:"Moliya"}]},ya=()=>{var s,t;const{user:i,logout:l}=ma(),{notifications:r,unreadCount:n,markAsRead:o,markAllAsRead:d}=xa(),[c,m]=e.useState(!1),x=a(),b=e.useRef(null),f=i&&fa[i.role]||[];if(e.useEffect(()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[b]),!i)return null;return u.jsxs("header",{className:"flex-shrink-0 flex items-center justify-between px-4 sm:px-6 h-20 bg-black/20 backdrop-blur-lg border-b border-white/10 sticky top-0 z-30",children:[u.jsxs("div",{className:"flex items-center gap-6",children:[u.jsxs(h,{to:"/dashboard",className:"text-2xl font-bold text-white tracking-wider flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center text-xl shadow-md",children:"P"}),u.jsx("span",{className:"hidden lg:block",children:"PINM"})]}),u.jsx("nav",{className:"hidden md:flex items-center gap-2",children:f.map(e=>u.jsxs(g,{to:e.to,className:({isActive:e})=>e?"flex items-center px-3 py-2 text-sm font-medium text-white bg-blue-500/20 rounded-lg":"flex items-center px-3 py-2 text-sm font-medium text-gray-300 rounded-lg hover:bg-white/10 transition-colors",children:[u.jsx(e.icon,{className:"w-5 h-5 mr-2"}),u.jsx("span",{children:e.label})]},e.to))})]}),u.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>m(e=>!e),className:"text-gray-300 hover:text-white focus:outline-none transition-colors p-2 rounded-full hover:bg-white/10","aria-label":"Bildirishnomalar",children:[u.jsx(p,{size:22}),n>0&&u.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-red-500"})]})]}),c&&u.jsxs("div",{ref:b,className:"absolute right-0 mt-3 w-80 max-h-96 overflow-y-auto bg-black/50 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl z-50",children:[u.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[u.jsx("h4",{className:"font-semibold text-white",children:"Bildirishnomalar"}),r.length>0&&u.jsx("button",{onClick:e=>{e.stopPropagation(),d()},className:"text-xs text-blue-400 hover:text-blue-300 transition-colors",children:"Hammasini o'qilgan deb belgilash"})]}),r.length>0?u.jsx("ul",{className:"divide-y divide-white/10",children:r.map(e=>u.jsx("li",{onClick:()=>{return o((a=e).id),a.link&&x(a.link),void m(!1);var a},className:"p-4 text-sm cursor-pointer hover:bg-white/5 transition-colors "+(e.read?"":"bg-blue-500/10"),children:u.jsx("p",{className:"text-gray-200 leading-relaxed",children:e.message})},e.id))}):u.jsx("p",{className:"p-6 text-center text-sm text-gray-400",children:"Yangi bildirishnomalar yo'q."})]})]}),u.jsxs(h,{to:"/profile",className:"flex items-center p-1.5 rounded-full hover:bg-white/10 transition-colors",children:[i.avatarUrl?u.jsx("img",{className:"h-9 w-9 sm:h-10 sm:w-10 rounded-full object-cover border-2 border-white/20",src:i.avatarUrl,alt:`${i.firstName} ${i.lastName}`}):u.jsxs("div",{className:"h-9 w-9 sm:h-10 sm:w-10 rounded-full bg-blue-500/20 border-2 border-white/20 flex items-center justify-center text-white font-semibold",children:[null==(s=i.firstName)?void 0:s.charAt(0),(null==(t=i.lastName)?void 0:t.charAt(0))||"U"]}),u.jsxs("div",{className:"mx-2 sm:mx-4 text-right hidden md:block",children:[u.jsxs("p",{className:"text-sm font-semibold text-white",children:[i.firstName," ",i.lastName]}),u.jsx("p",{className:"text-xs text-gray-400",children:ba[i.role]})]})]}),u.jsx("button",{onClick:l,className:"text-gray-300 hover:text-red-400 focus:outline-none transition-colors p-2.5 rounded-full hover:bg-white/10","aria-label":"Chiqish",children:u.jsx(j,{size:20})})]})]})},va=()=>{const{user:e}=ma();if(!e)return null;const a={[ua.Author]:[{to:"/dashboard",icon:s,label:"Asosiy"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/submit",icon:d,label:"Yuborish"},{to:"/my-translations",icon:m,label:"Tarjimalar"},{to:"/profile",icon:b,label:"Profilim"}],[ua.Reviewer]:[{to:"/dashboard",icon:s,label:"Asosiy"},{to:"/articles",icon:l,label:"Taqrizlar"},{to:"/profile",icon:b,label:"Profilim"}],[ua.JournalAdmin]:[{to:"/dashboard",icon:s,label:"Asosiy"},{to:"/articles",icon:l,label:"Kutayotganlar"},{to:"/published-articles",icon:o,label:"Nashrlar"}],[ua.SuperAdmin]:[{to:"/dashboard",icon:s,label:"Asosiy"},{to:"/articles",icon:l,label:"Maqolalar"},{to:"/users",icon:i,label:"Foydalanuvchilar"},{to:"/journal-management",icon:r,label:"Jurnallar"}],[ua.Accountant]:[{to:"/dashboard",icon:s,label:"Asosiy"},{to:"/financials",icon:t,label:"Moliya"},{to:"/profile",icon:b,label:"Profilim"}]}[e.role]||[];return u.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-20 bg-black/30 backdrop-blur-xl border-t border-white/10 flex justify-around items-center z-40",children:a.map(e=>u.jsxs(g,{to:e.to,className:({isActive:e})=>"flex flex-col items-center justify-center text-center text-gray-400 hover:text-blue-400 transition-colors w-full h-full "+(e?"text-blue-400":""),children:[u.jsx(e.icon,{className:"w-7 h-7 mb-1"}),u.jsx("span",{className:"text-xs font-medium",children:e.label})]},e.to))})},Na=()=>{const e="DIQQAT! Phoenix Ilmiy Nashriyot Markazining yangi platformasi sinov (demo) rejimida ishlamoqda. Taklif va kamchiliklar yuzasidan murojaat uchun telefon: +998 (94) 743-09-12";return u.jsx("div",{className:"scrolling-banner-container","aria-live":"polite",children:u.jsxs("div",{className:"scrolling-banner-inner",children:[u.jsx("span",{children:e}),u.jsx("span",{"aria-hidden":"true",children:e})]})})},wa=()=>u.jsxs("div",{className:"flex flex-col h-screen bg-transparent",children:[u.jsx(Na,{}),u.jsx(ya,{}),u.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto p-3 sm:p-6 md:p-8 pb-24 md:pb-8",children:u.jsx(f,{})}),u.jsx("div",{className:"md:hidden",children:u.jsx(va,{})})]}),ka=({children:e,className:a="",title:s,onClick:t})=>u.jsxs("div",{className:`bg-black/20 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-lg p-6 sm:p-8 transition-all duration-300 hover:shadow-2xl hover:border-white/20 ${a}`,onClick:t,children:[s&&u.jsx("h3",{className:"text-xl font-bold text-white mb-6 border-b border-white/10 pb-4",children:s}),e]}),_a=({children:e,variant:a="primary",isLoading:s=!1,...t})=>u.jsxs("button",{className:`px-6 py-3 font-semibold rounded-full focus:outline-none focus:ring-4 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed inline-flex items-center justify-center transform active:scale-95 shadow-md hover:shadow-lg ${{primary:"bg-blue-600 text-white hover:bg-blue-500 focus:ring-blue-500/50",secondary:"bg-white/10 text-white hover:bg-white/20 focus:ring-white/30 backdrop-blur-md border border-white/10",danger:"bg-red-600 text-white hover:bg-red-500 focus:ring-red-500/50"}[a]}`,disabled:s||t.disabled,...t,children:[s&&u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e]}),qa=({icon:e,title:a,value:s,gradient:t,to:i})=>{const l=u.jsxs(ka,{className:"!p-0 overflow-hidden relative h-full transition-transform transform hover:scale-105 hover:shadow-xl",children:[u.jsx("div",{className:`absolute -top-4 -right-4 w-20 h-20 opacity-10 ${t} rounded-full blur-2xl`}),u.jsxs("div",{className:"p-4 sm:p-6 flex items-center",children:[u.jsx("div",{className:"p-2.5 sm:p-3 rounded-xl mr-3 sm:mr-5 bg-white/10 shrink-0",children:u.jsx(e,{className:"h-5 w-5 sm:h-7 sm:w-7 text-white"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-white truncate",children:s}),u.jsx("p",{className:"text-xs sm:text-sm text-gray-400 capitalize truncate",children:a})]})]}),u.jsx("div",{className:`h-1.5 ${t}`})]});return i?u.jsx(h,{to:i,className:"block",children:l}):l},Sa=()=>{const{user:s}=ma(),r=a(),[n,d]=e.useState([]),[c,m]=e.useState([]),[x,g]=e.useState([]),[p,j]=e.useState([]),[b,f]=e.useState(null),[P,F]=e.useState(!0),[D,O]=e.useState(null);if(e.useEffect(()=>{(async()=>{if(s)try{F(!0),O(null);let a=[];if(s.role===ua.SuperAdmin)try{const e=await ea.list();a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:[]}catch(e){console.error("Failed to fetch users:",e),a=[]}const[t,i,l]=await Promise.all([aa.list(),sa.list(),ta.listTransactions()]),r=e=>Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],n=r(t),o=r(i),c=r(l),x=r(a);if(d(n),m(o),g(x),j(c),s.role===ua.SuperAdmin)try{const e=await ea.stats();f(e)}catch(e){console.error("Failed to fetch stats:",e)}}catch(a){O((null==a?void 0:a.message)||"Boshqaruv paneli ma'lumotlarini yuklashda xatolik. Iltimos, keyinroq urinib ko'ring.")}finally{F(!1)}})()},[s]),!s)return null;if(P)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(D)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:D}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const $={"fast-track":"Tezkor ko'rib chiqish",publication_fee:"Nashr haqi",language_editing:"Tilni tahrirlash",top_up:"Hisobni to'ldirish",book_publication:"Kitob nashri",translation:"Tarjima"};switch(s.role){case"author":return(()=>{const e=(Array.isArray(n)?n:[]).filter(e=>e.author===s.id),a=e.filter(e=>"QabulQilingan"===e.status).length,t=e.filter(e=>"Published"===e.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",s.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Bu yerdan o'z faoliyatingizni kuzatib borishingiz mumkin."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(qa,{icon:l,title:"Jami maqolalar",value:e.length,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(qa,{icon:M,title:"Ko'rib chiqilmoqda",value:a,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(qa,{icon:o,title:"Nashr etilgan",value:t,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/articles"})]})]})})();case"reviewer":return(()=>{const e=Array.isArray(n)?n:[],a=e.filter(e=>"QabulQilingan"===e.status).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0)),t=e.filter(e=>"QabulQilingan"===e.status);return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",s.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Taqrizchi sifatida faoliyatingizni boshqaring."}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx(qa,{icon:w,title:"Yangi so'rovlar",value:a.length,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(qa,{icon:k,title:"Jarayonda",value:t.length,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(qa,{icon:o,title:"Bajarilgan",value:s.reviewsCompleted||0,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/profile"}),u.jsx(qa,{icon:v,title:"O'rtacha vaqt",value:`${s.averageReviewTime||0} kun`,gradient:"bg-gradient-to-r from-purple-500 to-indigo-400",to:"/profile"})]}),u.jsx(ka,{title:"Yangi so'rovlar",children:u.jsx("div",{className:"space-y-4",children:a.length>0?a.map(e=>{const a=x.find(a=>a.id===e.author),s=c.find(a=>a.id===e.journal);return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-3",children:[e.fast_track&&u.jsxs("span",{className:"text-xs font-bold px-2.5 py-1 rounded-full whitespace-nowrap bg-yellow-500/20 text-yellow-300 flex items-center gap-1.5",children:[u.jsx(I,{size:14})," TOP"]}),u.jsx("p",{className:"font-semibold text-blue-400",children:e.title})]}),u.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["Muallif: ",a?`${a.first_name} ${a.last_name}`:"Noma'lum"," | Jurnal: ",s?s.name:"Noma'lum"]})]}),u.jsxs(_a,{onClick:()=>r(`/articles/${e.id}`),variant:"secondary",className:"w-full sm:w-auto",children:["Ko'rib chiqish ",u.jsx(N,{className:"ml-2 h-4 w-4"})]})]},e.id)}):u.jsx("p",{className:"text-center text-gray-400 py-8",children:"Hozircha ko'rib chiqish uchun yangi so'rovlar yo'q."})})})]})})();case"journal_admin":return(()=>{const e=c.filter(e=>e.journal_admin===s.id).map(e=>e.id),a=Array.isArray(n)?n:[],t=a.filter(a=>e.includes(a.journal)&&"NashrgaYuborilgan"===a.status).length,i=a.filter(a=>e.includes(a.journal)&&"Yangi"===a.status).length,l=a.filter(a=>e.includes(a.journal)&&"Published"===a.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Jurnal administratori paneli"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx(qa,{icon:w,title:"Yangi Kelganlar",value:i,gradient:"bg-gradient-to-r from-cyan-500 to-blue-400",to:"/articles"}),u.jsx(qa,{icon:k,title:"Nashrni kutmoqda",value:t,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(qa,{icon:o,title:"Jami nashrlar",value:l,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/published-articles"})]})]})})();case"super_admin":return(()=>{var e,a,s,r,d,m,g,j,f,y,v,N,I,M;const P=Array.isArray(p)?p:[],F=(null==(e=null==b?void 0:b.finance)?void 0:e.total_revenue)||P.filter(e=>"top_up"!==e.service_type&&"completed"===e.status).reduce((e,a)=>e+Math.abs(a.amount),0),D=P.filter(e=>"book_publication"===e.service_type),O=(null==(a=null==b?void 0:b.finance)?void 0:a.book_orders_total)??D.length,$=(null==(s=null==b?void 0:b.finance)?void 0:s.book_orders_completed)??D.filter(e=>"completed"===e.status).length,E=(null==(r=null==b?void 0:b.finance)?void 0:r.book_orders_pending)??D.filter(e=>"pending"===e.status).length,R=(null==(d=null==b?void 0:b.finance)?void 0:d.book_orders_failed)??D.filter(e=>"failed"===e.status).length,U=(null==(m=null==b?void 0:b.finance)?void 0:m.book_total_revenue)??D.filter(e=>"completed"===e.status).reduce((e,a)=>e+Math.abs(a.amount),0),L=(null==(g=null==b?void 0:b.users)?void 0:g.total)||x.length,J=(null==(j=null==b?void 0:b.users)?void 0:j.authors)||x.filter(e=>e.role===ua.Author||"author"===e.role).length,Y=(null==(f=null==b?void 0:b.users)?void 0:f.reviewers)||x.filter(e=>e.role===ua.Reviewer||"reviewer"===e.role).length,B=Array.isArray(n)?n:[],Q=(null==(y=null==b?void 0:b.articles)?void 0:y.total)||B.length,K=(null==(v=null==b?void 0:b.articles)?void 0:v.new_submissions)||B.filter(e=>"Yangi"===e.status||"WithEditor"===e.status).length,H=(null==(N=null==b?void 0:b.articles)?void 0:N.in_review)||B.filter(e=>"QabulQilingan"===e.status).length,X=(null==(I=null==b?void 0:b.articles)?void 0:I.published)||B.filter(e=>"Published"===e.status).length,Z=(null==(M=null==b?void 0:b.articles)?void 0:M.rejected)||B.filter(e=>"Rejected"===e.status).length;return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Umumiy platforma statistikasi"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(qa,{icon:t,title:"Jami tushum",value:`${(F/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/financials"}),u.jsx(qa,{icon:i,title:"Jami foydalanuvchilar",value:L,gradient:"bg-gradient-to-r from-indigo-500 to-violet-400",to:"/users"}),u.jsx(qa,{icon:l,title:"Jami maqolalar",value:Q,gradient:"bg-gradient-to-r from-purple-500 to-pink-400",to:"/articles"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Maqolalar holati bo'yicha statistika"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[u.jsx(qa,{icon:w,title:"Yangi kelganlar",value:K,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/articles"}),u.jsx(qa,{icon:k,title:"Taqrizda",value:H,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/articles"}),u.jsx(qa,{icon:o,title:"Nashr etilgan",value:X,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/articles"}),u.jsx(qa,{icon:_,title:"Rad etilgan",value:Z,gradient:"bg-gradient-to-r from-red-500 to-rose-400",to:"/articles"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Kitob nashri buyurtmalari"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-5 gap-6",children:[u.jsx(qa,{icon:l,title:"Jami buyurtmalar",value:O,gradient:"bg-gradient-to-r from-cyan-500 to-blue-400",to:"/financials"}),u.jsx(qa,{icon:o,title:"Muvaffaqiyatli",value:$,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/financials"}),u.jsx(qa,{icon:k,title:"Kutilmoqda",value:E,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/financials"}),u.jsx(qa,{icon:_,title:"Muvaffaqiyatsiz",value:R,gradient:"bg-gradient-to-r from-red-500 to-rose-400",to:"/financials"}),u.jsx(qa,{icon:t,title:"Kitob tushumi",value:`${(U/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-indigo-500 to-violet-400",to:"/financials"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Foydalanuvchilar taqsimoti"}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[u.jsx(qa,{icon:q,title:"Mualliflar",value:J,gradient:"bg-gradient-to-r from-gray-500 to-gray-400",to:"/users"}),u.jsx(qa,{icon:S,title:"Taqrizchilar",value:Y,gradient:"bg-gradient-to-r from-gray-500 to-gray-400",to:"/users"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Antiplagiat va AI tahlili"}),(()=>{const e=B.filter(e=>null!=e.plagiarism_percentage&&Number(e.plagiarism_percentage)>0),a=e.length>0?(e.reduce((e,a)=>e+Number(a.plagiarism_percentage||0),0)/e.length).toFixed(1):"0",s=e.length>0?(e.reduce((e,a)=>e+Number(a.ai_content_percentage||0),0)/e.length).toFixed(1):"0",t=e.filter(e=>Number(e.plagiarism_percentage)>=50).length;return u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-4 gap-6",children:[u.jsx(qa,{icon:z,title:"O'rtacha plagiat",value:`${a}%`,gradient:"bg-gradient-to-r from-orange-500 to-red-400"}),u.jsx(qa,{icon:C,title:"O'rtacha AI",value:`${s}%`,gradient:"bg-gradient-to-r from-purple-500 to-pink-400"}),u.jsx(qa,{icon:A,title:"Tekshirilgan",value:e.length,gradient:"bg-gradient-to-r from-cyan-500 to-blue-400"}),u.jsx(qa,{icon:T,title:"Yuqori plagiat",value:t,gradient:"bg-gradient-to-r from-red-500 to-rose-400"})]})})()]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Eng ko'p ko'rilgan maqolalar"}),u.jsx("div",{className:"space-y-3",children:[...B].sort((e,a)=>(a.views_count||0)-(e.views_count||0)).slice(0,5).map((e,a)=>u.jsxs(h,{to:`/articles/${e.id}`,className:"flex items-center justify-between p-3 bg-white/5 rounded-lg hover:bg-white/10 transition-colors",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("span",{className:"text-lg font-bold text-gray-500 w-6",children:a+1}),u.jsx("span",{className:"text-sm text-white truncate",children:e.title})]}),u.jsxs("span",{className:"flex items-center gap-1 text-sm text-blue-400 shrink-0 ml-2",children:[u.jsx(A,{size:14})," ",e.views_count||0]})]},e.id))})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Jurnal administratorlari statistikasi"}),u.jsx("div",{className:"space-y-4",children:x.filter(e=>e.role===ua.JournalAdmin||"journal_admin"===e.role).map(e=>{const a=c.filter(a=>a.journal_admin===e.id||a.journalAdminId===e.id).map(e=>e.id),s=B.filter(e=>a.includes(e.journal)&&"Published"===e.status).length;return u.jsx(ka,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("img",{src:e.avatar_url||e.avatarUrl,className:"h-12 w-12 rounded-full object-cover",alt:`${e.firstName||e.first_name} avatar`}),u.jsxs("div",{className:"ml-4",children:[u.jsxs("p",{className:"font-semibold text-white",children:[e.firstName||e.first_name," ",e.lastName||e.last_name]}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Nashrlar soni: ",u.jsx("span",{className:"font-bold text-white",children:s})]})]})]})},e.id)})})]})]})})();case"accountant":return(()=>{const e=Array.isArray(p)?p:[],a=e.filter(e=>"completed"===e.status&&"top_up"!==e.service_type),s=a.reduce((e,a)=>e+Math.abs(a.amount),0),i=(new Date).toISOString().split("T")[0],n=a.filter(e=>new Date(e.created_at).toISOString().split("T")[0]===i),o=n.reduce((e,a)=>e+Math.abs(a.amount),0),d=new Date;d.setDate(d.getDate()-7);const c=a.filter(e=>new Date(e.created_at)>=d).reduce((e,a)=>e+Math.abs(a.amount),0);return u.jsxs("div",{className:"space-y-8",children:[u.jsx("h2",{className:"text-3xl font-bold text-white",children:"Moliyachi Boshqaruv Paneli"}),u.jsx("p",{className:"text-gray-300 -mt-6",children:"Platformaning moliyaviy holatini kuzatib boring."}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx(qa,{icon:t,title:"Jami Tushum",value:`${(s/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-green-500 to-emerald-400",to:"/financials"}),u.jsx(qa,{icon:y,title:"Bugungi Tushum",value:`${o.toLocaleString()} so'm`,gradient:"bg-gradient-to-r from-blue-500 to-cyan-400",to:"/financials"}),u.jsx(qa,{icon:l,title:"Bugungi Tranzaksiyalar",value:n.length,gradient:"bg-gradient-to-r from-yellow-500 to-orange-400",to:"/financials"}),u.jsx(qa,{icon:v,title:"Haftalik Tushum",value:`${(c/1e3).toFixed(0)}k so'm`,gradient:"bg-gradient-to-r from-purple-500 to-indigo-400",to:"/financials"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx(ka,{title:"So'ngi Tranzaksiyalar",children:u.jsxs("div",{className:"space-y-4",children:[e.slice(0,5).map(e=>{const a=x.find(a=>a.id===e.user),s=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi";return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-white",children:s}),u.jsx("p",{className:"text-sm text-gray-400",children:$[e.service_type]||e.service_type||"Noma'lum xizmat"})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-medium "+(e.amount>=0?"text-green-400":"text-red-400"),children:[e.amount>=0?"+":"",e.amount.toLocaleString()," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id)}),0===e.length&&u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Hozircha tranzaksiyalar mavjud emas."})]})}),u.jsx(ka,{title:"To'lov Statistikasi",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Muvaffaqiyatli to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"completed"===e.status).length})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Kutilayotgan to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"pending"===e.status).length})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Muvaffaqiyatsiz to'lovlar"}),u.jsx("span",{className:"font-medium text-white",children:e.filter(e=>"failed"===e.status).length})]}),u.jsx("div",{className:"pt-4 mt-4 border-t border-white/10",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:"Umumiy tranzaksiyalar"}),u.jsx("span",{className:"font-bold text-white",children:e.length})]})})]})})]}),u.jsx(ka,{title:"Tezkor Amallar",children:u.jsx("div",{className:"flex flex-wrap gap-4 justify-center",children:u.jsxs(_a,{onClick:()=>r("/financials"),variant:"secondary",children:["Batafsil Moliyaviy Hisobot ",u.jsx(N,{className:"ml-2 h-4 w-4"})]})})})]})})();default:return u.jsxs(ka,{children:[u.jsxs("h2",{className:"text-3xl font-bold text-white",children:["Xush kelibsiz, ",s.firstName,"!"]}),u.jsx("p",{className:"text-gray-300 mt-2",children:"PINM tizimiga xush kelibsiz. Ishlaringizni boshqarish uchun yon menyudan foydalaning."})]})}},za=()=>u.jsx("div",{className:"flex flex-col items-center w-20 h-20 justify-center",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:"logoGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#0D2A4F"}),u.jsx("stop",{offset:"100%",stopColor:"#3A527A"})]})}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"url(#logoGrad)"}),u.jsx("path",{d:"M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z",fill:"#C09D58"})]})}),Ca=()=>u.jsxs("div",{className:"relative w-32 h-32 flex items-center justify-center drop-shadow-lg",children:[u.jsxs("svg",{viewBox:"0 0 100 100",className:"absolute w-full h-full text-[#C09D58]",children:[u.jsxs("defs",{children:[u.jsxs("radialGradient",{id:"sealGrad",cx:"50%",cy:"50%",r:"50%",fx:"25%",fy:"25%",children:[u.jsx("stop",{offset:"0%",stopColor:"#FDEEBE"}),u.jsx("stop",{offset:"100%",stopColor:"#A47D3A"})]}),u.jsx("filter",{id:"sealShadow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:u.jsx("feDropShadow",{dx:"1",dy:"2",stdDeviation:"1",floodColor:"#000",floodOpacity:"0.3"})})]}),u.jsx("path",{d:"M50 0 L61.8 38.2 L100 38.2 L69.1 61.8 L80.9 100 L50 76.4 L19.1 100 L30.9 61.8 L0 38.2 L38.2 38.2 Z",fill:"url(#sealGrad)",filter:"url(#sealShadow)"})]}),u.jsx("div",{className:"absolute w-[80%] h-[80%] rounded-full bg-gradient-to-br from-[#d4af6a] to-[#b48c4a]",style:{boxShadow:"inset 0 0 10px rgba(0,0,0,0.3)"}}),u.jsxs("svg",{viewBox:"0 0 100 100",className:"absolute w-[75%] h-[75%]",children:[u.jsx("path",{id:"circlePath",d:"M 10, 50 a 40,40 0 1,1 80,0 a 40,40 0 1,1 -80,0",fill:"none"}),u.jsx("text",{fill:"#8b6b33",className:"text-[7px] font-bold tracking-widest uppercase",children:u.jsx("textPath",{href:"#circlePath",startOffset:"50%",textAnchor:"middle",children:"PHOENIX SCIENTIFIC • AUTHENTIC DOCUMENT •"})})]}),u.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute text-[#8b6b33]/80",children:u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z",fill:"currentColor"})})]}),Aa=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsxs("defs",{children:[u.jsx("pattern",{id:"guilloche1",patternUnits:"userSpaceOnUse",width:"50",height:"50",children:u.jsx("path",{d:"M 50,25 C 50,38.807 38.807,50 25,50 C 11.193,50 0,38.807 0,25 C 0,11.193 11.193,0 25,0 C 38.807,0 50,11.193 50,25 Z M 25,10 a 15,15 0 1,0 0,30 a 15,15 0 1,0 0,-30",stroke:"#0D2A4F",strokeWidth:"0.25",fill:"none",opacity:"0.1"})}),u.jsx("pattern",{id:"guilloche2",patternUnits:"userSpaceOnUse",width:"30",height:"30",patternTransform:"rotate(45)",children:u.jsx("path",{d:"M0 0 H15 V15 H0Z M15 15 H30 V30 H15Z",fill:"#C09D58",opacity:"0.05"})}),u.jsxs("radialGradient",{id:"parchment",children:[u.jsx("stop",{offset:"0%",stopColor:"#FDFBF5"}),u.jsx("stop",{offset:"100%",stopColor:"#F5F1E8"})]}),u.jsxs("linearGradient",{id:"borderGrad",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:"#0D2A4F"}),u.jsx("stop",{offset:"100%",stopColor:"#3A527A"})]}),u.jsx("path",{id:"microtextPath",d:"M60 40 H1120 V750 H60 Z"})]}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#parchment)"}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#guilloche1)"}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#guilloche2)"}),u.jsx("g",{transform:"translate(595 395) scale(6)",opacity:"0.03",fill:"#0D2A4F",children:u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M17.5,8.5c-1.66,0-3.16,0.83-4.06,2.09c-0.9-1.26-2.4-2.09-4.06-2.09C6.98,8.5,5,10.48,5,12.88c0,2.69,2.67,4.88,5.4,6.91l1.6,1.21l1.6-1.21c2.73-2.03,5.4-4.22,5.4-6.91C19.02,10.48,17.02,8.5,17.5,8.5z"})}),u.jsxs("g",{stroke:"url(#borderGrad)",fill:"none",strokeWidth:"1",children:[u.jsx("rect",{x:"30",y:"25",width:"1120",height:"740",rx:"10"}),u.jsx("path",{d:"M 40,35 H 1110 V 730 H 40 Z",strokeWidth:"0.5",strokeDasharray:"5 5",opacity:"0.5"}),u.jsx("path",{d:"M 50,45 a 10,10 0 0,1 10,-10 H 1100 a 10,10 0 0,1 10,10 V 720 a 10,10 0 0,1 -10,10 H 60 a 10,10 0 0,1 -10,-10 Z",strokeWidth:"2.5"})]}),u.jsxs("g",{fill:"url(#borderGrad)",opacity:"0.8",children:[u.jsx("path",{transform:"translate(50, 45)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(1130, 45) scale(-1, 1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(50, 755) scale(1, -1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"}),u.jsx("path",{transform:"translate(1130, 755) scale(-1, -1)",d:"M0,0 l20,0 a-20,-20 0 0 0 -20,-20 v20z"})]}),u.jsx("text",{fill:"#0D2A4F",fontSize:"3",opacity:"0.5",letterSpacing:"1",children:u.jsxs("textPath",{href:"#microtextPath",children:[u.jsx("tspan",{children:"PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"}),u.jsx("tspan",{children:" PHOENIX ILMIY NASHRLAR MARKAZI AUTHENTIC DOCUMENT"})]})})]}),Ta=[{id:"journal-1",name:"Iqtisodiyot va Innovatsion Texnologiyalar",issn:"2091-5946",description:"Iqtisodiyot sohasidagi ilmiy tadqiqotlar va zamonaviy texnologiyalarning iqtisodiy jarayonlarga ta'siri.",journalAdminId:"user-4",publicationFee:2e5,categoryId:"cat-1",imageUrl:"https://picsum.photos/seed/journal1/400/200",paymentModel:pa.PostPayment,pricingType:ja.Fixed,additionalDocumentConfig:{required:!0,label:"Taqriz fayli",type:"file"},issueIds:["issue-1"]},{id:"journal-2",name:"Texnika Fanlari Axborotnomasi",issn:"1234-5678",description:"Muhandislik va texnika sohasidagi yangiliklar, ixtirolar va ilmiy-texnikaviy yechimlar tahlili.",journalAdminId:"user-4",pricePerPage:15e3,categoryId:"cat-2",imageUrl:"https://picsum.photos/seed/journal2/400/200",paymentModel:pa.PrePayment,pricingType:ja.PerPage,additionalDocumentConfig:{required:!1,label:"",type:"file"}},{id:"journal-3",name:"Tibbiyot va Salomatlik",issn:"8765-4321",description:"Sog'liqni saqlash sohasidagi eng so'nggi yutuqlar, klinik tadqiqotlar va tibbiy amaliyotga oid maqolalar.",journalAdminId:"user-4",publicationFee:25e4,categoryId:"cat-3",imageUrl:"https://picsum.photos/seed/journal3/400/200",paymentModel:pa.PostPayment,pricingType:ja.Fixed,additionalDocumentConfig:{required:!0,label:"Tavsiyanoma havolasi",type:"link"}},{id:"journal-4",name:"Filologiya Masalalari",issn:"4567-1238",description:"Tilshunoslik va adabiyotshunoslikka oid ilmiy maqolalar, tahliliy sharhlar va tadqiqotlar majmuasi.",journalAdminId:"user-4",pricePerPage:12e3,categoryId:"cat-4",imageUrl:"https://picsum.photos/seed/journal4/400/200",paymentModel:pa.PrePayment,pricingType:ja.PerPage,additionalDocumentConfig:{required:!1,label:"",type:"file"}}];ha.Published,ha.QabulQilingan,ha.Yangi,ha.NashrgaYuborilgan,ga.Bajarildi,ga.Jarayonda,ga.Yangi,[{id:"log-1-1",articleId:"article-1",timestamp:"2025-09-15T10:00:00Z",userId:"user-1",action:"Maqola yuborildi"},{id:"log-1-2",articleId:"article-1",timestamp:"2025-09-16T14:30:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.QabulQilingan}`},{id:"log-1-3",articleId:"article-1",timestamp:"2025-09-22T09:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.Accepted}`},{id:"log-1-4",articleId:"article-1",timestamp:"2025-09-22T11:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.NashrgaYuborilgan}`},{id:"log-1-5",articleId:"article-1",timestamp:"2025-09-25T18:00:00Z",userId:"user-4",action:"Maqola nashr etildi"},{id:"log-2-1",articleId:"article-2",timestamp:"2025-10-20T11:20:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-2-2",articleId:"article-2",timestamp:"2025-10-21T16:00:00Z",userId:"user-2",action:"So'rov qabul qilindi",details:"Taqrizchi Gulnora Saidova"},{id:"log-2-3",articleId:"article-2",timestamp:"2025-10-21T16:05:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.QabulQilingan}`},{id:"log-3-1",articleId:"article-3",timestamp:"2025-11-10T08:45:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-4-1",articleId:"article-4",timestamp:"2025-11-15T12:00:00Z",userId:"user-1",action:"Yangi so'rov kelib tushdi"},{id:"log-4-2",articleId:"article-4",timestamp:"2025-11-16T10:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.QabulQilingan}`},{id:"log-4-3",articleId:"article-4",timestamp:"2025-11-20T15:00:00Z",userId:"user-2",action:`Holat o'zgartirildi: ${ha.NashrgaYuborilgan}`}].sort((e,a)=>new Date(a.timestamp).getTime()-new Date(e.timestamp).getTime());const Ia=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsx("rect",{width:"100%",height:"100%",fill:"#ffffff"}),u.jsx("g",{transform:"translate(420 297) rotate(15) scale(2.5)",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-[#3A527A]",opacity:"0.03",children:[u.jsx("path",{d:"M16.88,7.31c-2.39-2.39-6.26-2.39-8.65,0L12,11.06L16.88,7.31z",fill:"currentColor",opacity:"0.5"}),u.jsx("path",{d:"M11.06,12l-3.75,3.75c2.39,2.39,6.26,2.39,8.65,0l-4.9-4.9V12z",fill:"currentColor"}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"currentColor"})]})})]}),Ma=({articles:e,author:a})=>u.jsxs("div",{className:"bg-white text-gray-800 aspect-[210/297] w-full max-w-4xl mx-auto shadow-lg overflow-hidden relative font-sans p-2 print:shadow-none",children:[u.jsx(Ia,{}),u.jsx("div",{className:"absolute inset-4 border border-gray-400 p-1",children:u.jsx("div",{className:"w-full h-full border border-gray-300"})}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-16 py-12",children:[u.jsxs("header",{className:"flex flex-col items-center w-full pb-4",children:[u.jsx(za,{}),u.jsx("p",{className:"font-serif text-md text-slate-700 tracking-widest uppercase mt-2",children:"Phoenix Ilmiy Nashrlar Markazi"})]}),u.jsx("h1",{className:"font-serif text-4xl font-bold text-[#3A527A] tracking-wide my-6 text-center",children:"MAQOLALAR BO'YICHA MA'LUMOTNOMA"}),u.jsxs("main",{className:"flex-grow text-base text-slate-800",children:[u.jsxs("div",{className:"mb-6 text-sm",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Muallif:"})," ",a.lastName," ",a.firstName," ",a.patronymic]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Tashkilot:"})," ",a.affiliation]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Sana:"})," ",(new Date).toLocaleDateString("uz-UZ")]})]}),u.jsx("div",{className:"overflow-auto border border-gray-300 rounded-lg",children:u.jsxs("table",{className:"min-w-full text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700 w-8",children:"№"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Sarlavha"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Jurnal"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700 whitespace-nowrap",children:"Sana"}),u.jsx("th",{className:"p-2 text-left font-semibold text-gray-700",children:"Holati"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map((e,a)=>{const s=Ta.find(a=>a.id===e.journalId),t=(i=e.status,{[ha.Draft]:{text:"Qoralama",color:"text-gray-600"},[ha.Yangi]:{text:"Yangi",color:"text-blue-600"},[ha.WithEditor]:{text:"Redaktorda",color:"text-indigo-600"},[ha.QabulQilingan]:{text:"Qabul Qilingan",color:"text-yellow-700"},[ha.Revision]:{text:"Tahrirda",color:"text-orange-600"},[ha.Accepted]:{text:"Ma'qullangan",color:"text-teal-600"},[ha.Published]:{text:"Nashr etilgan",color:"text-green-700"},[ha.Rejected]:{text:"Rad etilgan",color:"text-red-600"},[ha.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"text-purple-600"},[ha.WritingInProgress]:{text:"Yozilmoqda",color:"text-cyan-600"}}[i]||{text:i,color:"text-gray-600"});var i;return u.jsxs("tr",{children:[u.jsx("td",{className:"p-2 align-top",children:a+1}),u.jsx("td",{className:"p-2 align-top font-medium text-gray-800",children:e.title}),u.jsx("td",{className:"p-2 align-top text-gray-600",children:(null==s?void 0:s.name)||"-"}),u.jsx("td",{className:"p-2 align-top text-gray-600 whitespace-nowrap",children:new Date(e.submissionDate).toLocaleDateString("uz-UZ")}),u.jsx("td",{className:`p-2 align-top font-semibold ${t.color}`,children:t.text})]},e.id)})})]})})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-6 mt-auto",children:[u.jsx("div",{className:"text-left text-xs text-slate-500",children:u.jsx("p",{children:"PINM tizimi orqali yaratildi."})}),u.jsx(Ca,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-12 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"})]})]})]})]}),Pa=e=>Math.max(0,Math.min(100,e)),Fa=e=>"high"===e?"text-red-400":"medium"===e?"text-yellow-400":"text-green-400",Da=e=>"high"===e?"bg-red-500/15 border-red-500/30":"medium"===e?"bg-yellow-500/15 border-yellow-500/30":"bg-green-500/15 border-green-500/30",Oa=e=>"high"===e?"Yuqori xavf":"medium"===e?"O'rtacha xavf":"Past xavf",$a=({value:e,label:a,color:s,size:t=120})=>{const i=Pa(e),l=(t-16)/2,r=2*Math.PI*l,n=r-i/100*r,o=t/2;return u.jsxs("div",{className:"flex flex-col items-center gap-2",children:[u.jsxs("svg",{width:t,height:t,className:"transform -rotate-90",children:[u.jsx("circle",{cx:o,cy:o,r:l,fill:"none",stroke:"rgba(255,255,255,0.08)",strokeWidth:"8"}),u.jsx("circle",{cx:o,cy:o,r:l,fill:"none",stroke:s,strokeWidth:"8",strokeLinecap:"round",strokeDasharray:r,strokeDashoffset:n,className:"transition-all duration-1000 ease-out"})]}),u.jsx("div",{className:"absolute flex flex-col items-center justify-center",style:{width:t,height:t},children:u.jsxs("span",{className:"text-2xl font-bold text-white",children:[i.toFixed(1),"%"]})}),u.jsx("span",{className:"text-xs text-gray-400 font-medium mt-1",children:a})]})},Ea=({value:e,label:a,color:s,max:t=100})=>{const i=Pa(e/t*100);return u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex justify-between text-xs",children:[u.jsx("span",{className:"text-gray-400",children:a}),u.jsxs("span",{className:"text-gray-300 font-medium",children:[e.toFixed(1),"%"]})]}),u.jsx("div",{className:"w-full h-2 bg-white/10 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full rounded-full transition-all duration-700 ease-out",style:{width:`${i}%`,backgroundColor:s}})})]})},Ra=({plagiarism:e,ai:a,checkedAt:s})=>{if(!s)return u.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-gray-500/15 text-gray-400 border border-gray-500/30 text-xs",children:[u.jsx(z,{size:12})," Tekshirilmagan"]});const t=e>50?"bg-red-500/15 text-red-300 border-red-500/30":e>25?"bg-yellow-500/15 text-yellow-300 border-yellow-500/30":"bg-green-500/15 text-green-300 border-green-500/30",i=a>50?"bg-purple-500/15 text-purple-300 border-purple-500/30":a>25?"bg-cyan-500/15 text-cyan-300 border-cyan-500/30":"bg-green-500/15 text-green-300 border-green-500/30";return u.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[u.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full border text-xs font-medium ${t}`,children:[u.jsx(z,{size:12})," ",e.toFixed(1),"%"]}),u.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full border text-xs font-medium ${i}`,children:[u.jsx(C,{size:12})," ",a.toFixed(1),"%"]})]})},Ua=({plagiarismPercentage:a,aiContentPercentage:s,checkedAt:t,report:i,compact:r=!1})=>{const[n,d]=e.useState(!1),[c,m]=e.useState(!1);if(!t)return u.jsxs("div",{className:"p-6 rounded-xl bg-white/5 border border-white/10 text-center",children:[u.jsx(z,{className:"mx-auto h-10 w-10 text-gray-500 mb-3"}),u.jsx("p",{className:"text-gray-400 text-sm",children:"Antiplagiat tekshiruvi hali amalga oshirilmagan"})]});const x=Pa(a),h=Pa(s),g=Pa(i?100-.6*x-.4*h:100-x),p=(null==i?void 0:i.overall_risk)||(Math.max(x,h)>60?"high":Math.max(x,h)>30?"medium":"low");if(r)return u.jsx("div",{className:`p-4 rounded-xl border ${Da(p)}`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(z,{size:16,className:"text-red-400"}),u.jsxs("span",{className:"text-sm text-gray-300",children:["Plagiat: ",u.jsxs("strong",{className:"text-white",children:[x.toFixed(1),"%"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(C,{size:16,className:"text-purple-400"}),u.jsxs("span",{className:"text-sm text-gray-300",children:["AI: ",u.jsxs("strong",{className:"text-white",children:[h.toFixed(1),"%"]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(P,{size:16,className:"text-green-400"}),u.jsxs("span",{className:"text-sm text-gray-300",children:["Original: ",u.jsxs("strong",{className:"text-white",children:[g.toFixed(1),"%"]})]})]})]}),u.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-full ${Da(p)} ${Fa(p)}`,children:Oa(p)})]})});const j=null==i?void 0:i.plagiarism_breakdown,b=null==i?void 0:i.ai_detection,f=null==i?void 0:i.stylometric,y=(null==i?void 0:i.sections)||[],v=(null==i?void 0:i.recommendations)||[],N=(null==i?void 0:i.confidence)||0;return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:`p-4 rounded-xl border flex items-center justify-between ${Da(p)}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:["high"===p?u.jsx(_,{className:"text-red-400",size:24}):"medium"===p?u.jsx(F,{className:"text-yellow-400",size:24}):u.jsx(o,{className:"text-green-400",size:24}),u.jsxs("div",{children:[u.jsx("p",{className:`font-bold text-lg ${Fa(p)}`,children:Oa(p)}),u.jsxs("p",{className:"text-xs text-gray-400",children:["Tekshiruv vaqti: ",new Date(t).toLocaleString()," · Ishonchlilik: ",N,"%"]})]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"text-xs text-gray-500",children:[(null==i?void 0:i.word_count)||0," so'z · ",(null==i?void 0:i.sentence_count)||0," gap"]})})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsx("div",{className:"flex flex-col items-center p-5 rounded-xl bg-white/5 border border-white/10 relative",children:u.jsx($a,{value:x,label:"Plagiat",color:x>50?"#ef4444":x>25?"#eab308":"#22c55e"})}),u.jsx("div",{className:"flex flex-col items-center p-5 rounded-xl bg-white/5 border border-white/10 relative",children:u.jsx($a,{value:h,label:"AI kontent",color:h>50?"#a855f7":h>25?"#06b6d4":"#22c55e"})}),u.jsx("div",{className:"flex flex-col items-center p-5 rounded-xl bg-white/5 border border-white/10 relative",children:u.jsx($a,{value:g,label:"Originallik",color:g>70?"#22c55e":g>40?"#eab308":"#ef4444"})})]}),j&&u.jsxs("div",{className:"p-5 rounded-xl bg-white/5 border border-white/10",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2 mb-4",children:[u.jsx(D,{size:16,className:"text-red-400"})," Plagiat turlari bo'yicha taqsimot"]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx(Ea,{value:j.direct_copy,label:"To'g'ridan-to'g'ri ko'chirish",color:"#ef4444"}),u.jsx(Ea,{value:j.paraphrase,label:"Parafraz (qayta ifodalash)",color:"#f97316"}),u.jsx(Ea,{value:j.mosaic,label:"Mozaik plagiat (patchwork)",color:"#eab308"}),u.jsx(Ea,{value:j.self_citation,label:"O'z-o'zini iqtibos qilish",color:"#06b6d4"})]})]}),b&&u.jsxs("div",{className:"p-5 rounded-xl bg-white/5 border border-white/10",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2 mb-4",children:[u.jsx(O,{size:16,className:"text-purple-400"})," AI detektor tahlili"]}),u.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[u.jsxs("div",{className:"p-3 rounded-lg bg-purple-500/10 border border-purple-500/20 text-center",children:[u.jsxs("p",{className:"text-xl font-bold text-purple-300",children:[b.overall_ai_probability.toFixed(1),"%"]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"AI ehtimoli"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-green-500/10 border border-green-500/20 text-center",children:[u.jsxs("p",{className:"text-xl font-bold text-green-300",children:[b.human_probability.toFixed(1),"%"]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Inson ehtimoli"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-cyan-500/10 border border-cyan-500/20 text-center",children:[u.jsxs("p",{className:"text-xl font-bold text-cyan-300",children:[b.mixed_probability.toFixed(1),"%"]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Aralash"})]})]}),u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400 mb-3",children:[u.jsx($,{size:12}),"Model ishonchliligi: ",u.jsx("span",{className:"font-semibold "+("high"===b.model_confidence?"text-green-400":"medium"===b.model_confidence?"text-yellow-400":"text-gray-400"),children:(w=b.model_confidence,"high"===w?"Yuqori":"medium"===w?"O'rtacha":"Past")})]}),b.patterns&&b.patterns.length>0&&u.jsxs("div",{children:[u.jsxs("button",{onClick:()=>m(!c),className:"flex items-center gap-2 text-xs text-blue-400 hover:text-blue-300 transition-colors",children:[c?u.jsx(E,{size:14}):u.jsx(R,{size:14}),"Aniqlangan AI patternlar (",b.patterns.length,")"]}),c&&u.jsx("div",{className:"mt-2 space-y-1.5",children:b.patterns.map((e,a)=>u.jsxs("div",{className:"flex items-start gap-2 text-xs text-gray-300 p-2 rounded bg-white/5",children:[u.jsx(F,{size:12,className:"text-yellow-400 mt-0.5 shrink-0"}),e]},a))})]})]}),f&&u.jsxs("div",{className:"p-5 rounded-xl bg-white/5 border border-white/10",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2 mb-4",children:[u.jsx(P,{size:16,className:"text-cyan-400"})," Stilometrik tahlil"]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[{label:"Lug'at boyligi",value:`${f.vocabulary_richness.toFixed(1)}%`,icon:u.jsx(U,{size:14,className:"text-blue-400"})},{label:"O'rtacha gap uzunligi",value:`${f.avg_sentence_length.toFixed(1)} so'z`,icon:u.jsx(l,{size:14,className:"text-green-400"})},{label:"Gap uzunligi variatsiyasi",value:f.sentence_length_variance.toFixed(1),icon:u.jsx(D,{size:14,className:"text-yellow-400"})},{label:"O'qilish darajasi",value:`${f.readability_score.toFixed(1)}`,icon:u.jsx(A,{size:14,className:"text-purple-400"})},{label:"Passiv ovoz nisbati",value:`${f.passive_voice_ratio.toFixed(1)}%`,icon:u.jsx($,{size:14,className:"text-orange-400"})},{label:"Bog'lovchi so'z zichligi",value:`${f.transition_density.toFixed(1)}%`,icon:u.jsx(O,{size:14,className:"text-cyan-400"})}].map((e,a)=>u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.icon,u.jsx("span",{className:"text-xs text-gray-400",children:e.label})]}),u.jsx("p",{className:"text-sm font-semibold text-white",children:e.value})]},a))})]}),y.length>0&&u.jsxs("div",{className:"p-5 rounded-xl bg-white/5 border border-white/10",children:[u.jsxs("button",{onClick:()=>d(!n),className:"w-full flex items-center justify-between",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2",children:[u.jsx(l,{size:16,className:"text-blue-400"})," Bo'limlar bo'yicha tahlil (",y.length," bo'lim)"]}),n?u.jsx(E,{size:16,className:"text-gray-400"}):u.jsx(R,{size:16,className:"text-gray-400"})]}),n&&u.jsx("div",{className:"mt-4 space-y-2",children:y.map(e=>u.jsxs("div",{className:`p-3 rounded-lg border ${Da(e.risk)}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("span",{className:"text-xs font-medium text-gray-300",children:["Bo'lim ",e.index," · ",e.word_count," so'z"]}),u.jsx("span",{className:`text-xs font-bold px-2 py-0.5 rounded-full ${Da(e.risk)} ${Fa(e.risk)}`,children:Oa(e.risk)})]}),u.jsxs("p",{className:"text-xs text-gray-400 mb-2 italic line-clamp-2",children:['"',e.preview,'"']}),u.jsxs("div",{className:"flex gap-4 text-xs",children:[u.jsxs("span",{className:"text-gray-400",children:["Plagiat: ",u.jsxs("strong",{className:"text-red-300",children:[e.plagiarism_score.toFixed(1),"%"]})]}),u.jsxs("span",{className:"text-gray-400",children:["AI: ",u.jsxs("strong",{className:"text-purple-300",children:[e.ai_score.toFixed(1),"%"]})]})]}),e.note&&u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.note})]},e.index))})]}),v.length>0&&u.jsxs("div",{className:"p-5 rounded-xl bg-blue-500/5 border border-blue-500/20",children:[u.jsxs("h3",{className:"text-sm font-semibold text-white flex items-center gap-2 mb-3",children:[u.jsx(o,{size:16,className:"text-blue-400"})," Tavsiyalar"]}),u.jsx("div",{className:"space-y-2",children:v.map((e,a)=>u.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-300",children:[u.jsxs("span",{className:"text-blue-400 font-bold mt-0.5",children:[a+1,"."]}),e]},a))})]})]});var w},La=e=>({id:e.id,title:e.title,abstract:e.abstract,keywords:e.keywords,status:e.status,authorId:e.author,journalId:e.journal,submissionDate:e.submission_date,fastTrack:e.fast_track,versions:[],analytics:{views:e.views,downloads:e.downloads,citations:0}}),Ja=e=>({[ha.Draft]:{text:"Qoralama",color:"bg-gray-500/20 text-gray-300"},[ha.Yangi]:{text:"Yangi",color:"bg-blue-500/20 text-blue-300"},[ha.WithEditor]:{text:"Redaktorda",color:"bg-indigo-500/20 text-indigo-300"},[ha.QabulQilingan]:{text:"Qabul Qilingan",color:"bg-yellow-500/20 text-yellow-300"},[ha.Revision]:{text:"Tahrirga qaytarilgan",color:"bg-orange-500/20 text-orange-300"},[ha.Accepted]:{text:"Ma'qullangan",color:"bg-teal-500/20 text-teal-300"},[ha.Published]:{text:"Nashr etilgan",color:"bg-green-500/20 text-green-300"},[ha.Rejected]:{text:"Rad etilgan",color:"bg-red-500/20 text-red-300"},[ha.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"bg-purple-500/20 text-purple-300"},[ha.WritingInProgress]:{text:"Yozilmoqda",color:"bg-cyan-500/20 text-cyan-300"},[ga.Jarayonda]:{text:"Jarayonda",color:"bg-yellow-500/20 text-yellow-300"},[ga.Bajarildi]:{text:"Bajarildi",color:"bg-green-500/20 text-green-300"},[ga.BekorQilindi]:{text:"Bekor Qilindi",color:"bg-red-500/20 text-red-300"}}[e]||{text:e,color:"bg-gray-500/20 text-gray-300"}),Ya=({article:s,isAdmin:t=!1,isJournalAdmin:i=!1,userId:l,journalIds:r,onStatusUpdate:n})=>{const o=a(),{user:d}=ma(),[c,m]=e.useState(!1),[x,h]=e.useState(s.status),[g,p]=e.useState(!1),j=Ja(x),b=t||i&&r&&r.includes(s.journal);return u.jsxs("div",{className:"p-4 sm:p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 cursor-pointer border border-transparent hover:border-white/10",onClick:()=>o(`/articles/${s.id}`),children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2 sm:gap-4",children:[u.jsx("h4",{className:"text-base sm:text-lg font-semibold text-blue-400 leading-snug",children:s.title}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[s.fast_track&&u.jsxs("span",{className:"text-xs font-bold px-3 py-1 rounded-full whitespace-nowrap bg-yellow-500/20 text-yellow-300 flex items-center gap-1.5",children:[u.jsx(I,{size:14})," TOP"]}),u.jsx("div",{className:"relative",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${j.color}`,children:j.text}),b&&u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:e=>{e.stopPropagation(),m(!c)},className:"text-xs bg-gray-700 hover:bg-gray-600 rounded-full p-1.5 transition-colors",children:u.jsx(R,{size:14})}),c&&u.jsx("div",{className:"absolute right-0 mt-1 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10",children:u.jsx("div",{className:"py-1 max-h-60 overflow-y-auto",children:[ha.Draft,ha.Yangi,ha.WithEditor,ha.QabulQilingan,ha.Revision,ha.Accepted,ha.Published,ha.Rejected,ha.NashrgaYuborilgan,ha.WritingInProgress].map(e=>u.jsxs("button",{onClick:a=>{a.stopPropagation(),(async e=>{if(b)try{if(p(!0),!e)return void console.error("Status is null or undefined, cannot update");const a=String(e);await aa.updateStatus(s.id,a),h(e),m(!1),n&&n()}catch(a){console.error("Failed to update article status:",a)}finally{p(!1)}})(e)},disabled:g,className:"w-full text-left px-3 py-2 text-sm flex items-center gap-2 "+(x===e?"bg-blue-600/30 text-blue-300":"text-gray-300 hover:bg-gray-700/50"),children:[u.jsx(Q,{size:14,className:x===e?"opacity-100":"opacity-0"}),Ja(e).text]},e))})})]})]})})]})]}),u.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:s.abstract}),"author"!==(null==d?void 0:d.role)&&u.jsx("div",{className:"mt-3",children:u.jsx(Ra,{plagiarism:Number(s.plagiarism_percentage??0),ai:Number(s.ai_content_percentage??0),checkedAt:s.plagiarism_checked_at||null})}),u.jsxs("div",{className:"flex flex-wrap justify-between items-center mt-4 text-xs text-gray-500 gap-1",children:[u.jsx("span",{className:"truncate max-w-[60%]",children:s.author_name||"Noma'lum muallif"}),u.jsx("span",{children:new Date(s.submission_date).toLocaleDateString()})]})]})},Ba=({request:e})=>{var s,t,i;const l=a(),r=Ja(e.status);return u.jsxs("div",{className:"p-4 sm:p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 cursor-pointer border border-transparent hover:border-white/10",onClick:()=>l(`/translations/${e.id}`),children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-2 sm:gap-4",children:[u.jsxs("h4",{className:"text-base sm:text-lg font-semibold text-indigo-400 flex items-center gap-2 min-w-0",children:[u.jsx(m,{size:18,className:"shrink-0"})," ",u.jsx("span",{className:"truncate",children:e.title})]}),u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${r.color}`,children:r.text})]}),u.jsxs("div",{className:"flex justify-between items-end mt-4",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[(null==(s=e.source_language)?void 0:s.toUpperCase())||"Noma'lum"," ",u.jsx(N,{size:14,className:"inline-block mx-1"})," ",(null==(t=e.target_language)?void 0:t.toUpperCase())||"Noma'lum"]}),u.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[u.jsxs("span",{children:["Muallif: ",e.author_name||"Noma'lum"]}),u.jsx("span",{className:"mx-2",children:"|"}),u.jsxs("span",{children:["Sana: ",new Date(e.submission_date).toLocaleDateString()]})]})]}),u.jsxs("span",{className:"text-sm font-semibold text-green-400",children:[(null==(i=e.cost)?void 0:i.toLocaleString())||0," so'm"]})]})]})},Qa=()=>{const{user:a}=ma(),s="string"==typeof(null==a?void 0:a.role)?a.role.toLowerCase():null==a?void 0:a.role,t=s===ua.JournalAdmin||"journal_admin"===s||"journaladmin"===s,[i,r]=e.useState(""),[n,o]=e.useState((null==a?void 0:a.role)===ua.Reviewer?"reviews":t?"new":"all"),[d,c]=e.useState(!1),[m,x]=e.useState(!1),[h,g]=e.useState(""),[p,j]=e.useState(""),[b,f]=e.useState(""),[y,v]=e.useState(""),[N,w]=e.useState([]),[k,_]=e.useState([]),[q,S]=e.useState([]),[z,C]=e.useState(!0),[A,T]=e.useState(null),I=!!(h||p||b||y),M=[{id:"reviews",label:"Maqola Taqrizlari",statuses:[ha.QabulQilingan]},{id:"translations",label:"Tarjimalar",statuses:[ga.Yangi,ga.Jarayonda]}],P=[{id:"new",label:"Yangi Kelganlar",statuses:[ha.Yangi]},{id:"with-editor",label:"Redaktorda",statuses:[ha.WithEditor]},{id:"in-review",label:"Tekshiruvda",statuses:[ha.QabulQilingan]},{id:"ready",label:"Nashrga Tayyorlar",statuses:[ha.NashrgaYuborilgan]},{id:"published",label:"Nashr etilgan",statuses:[ha.Published]},{id:"all",label:"Barcha Maqolalar",statuses:[]}];let F="Maqolalar";switch(s){case ua.Author:case"author":F="Mening Maqolalarim";break;case ua.Reviewer:case"reviewer":F="Ish Stoli";break;case ua.JournalAdmin:case"journal_admin":case"journaladmin":F="Jurnal Maqolalari";break;case ua.SuperAdmin:case"super_admin":case"superadmin":F="Tizimdagi Barcha Maqolalar"}const D=e.useMemo(()=>{if(t){const e=a.id||a.userId||a.user_id,s=q.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e).map(e=>e.id),t=P.find(e=>e.id===n);return t?N.filter(e=>{const a=s.includes(e.journal),i="all"===t.id||(null==t?void 0:t.statuses.includes(e.status));return a&&i}).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0)):[]}switch(a.role){case ua.Author:return N;case ua.Reviewer:if("reviews"===n){const e=M.find(e=>e.id===n);return N.filter(a=>null==e?void 0:e.statuses.includes(a.status)).sort((e,a)=>(a.fast_track?1:0)-(e.fast_track?1:0))}return[];case ua.SuperAdmin:return N;default:return[]}},[a,n,N,q,t]),O=e.useMemo(()=>a.role!==ua.Reviewer||"translations"!==n?[]:k.filter(e=>e.status===ga.Yangi||e.reviewer===a.id&&e.status===ga.Jarayonda),[a,n,k]),$=e.useMemo(()=>{if(!i)return O;const e=i.toLowerCase();return O.filter(a=>a.title.toLowerCase().includes(e))},[i,O]),E=e.useMemo(()=>{let e=D;if(i){const a=i.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a)||e.keywords&&e.keywords.join(" ").toLowerCase().includes(a)||e.author_name&&e.author_name.toLowerCase().includes(a))}if(h&&(e=e.filter(e=>e.journal===h)),p&&(e=e.filter(e=>{const a=Number(e.plagiarism_percentage??0);return"low"===p?a<20:"medium"===p?a>=20&&a<50:"high"!==p||a>=50})),b){const a=new Date(b);e=e.filter(e=>new Date(e.submission_date)>=a)}if(y){const a=new Date(y);a.setHours(23,59,59),e=e.filter(e=>new Date(e.submission_date)<=a)}return e},[i,D,h,p,b,y]),R=e.useMemo(()=>M.map(e=>{let s=0;return"translations"===e.id?s=k.filter(s=>e.statuses.includes(s.status)&&(!s.reviewer||s.reviewer===a.id)).length:e.statuses&&(s=N.filter(a=>{const s=e.statuses.includes(a.status);return e.id,s}).length),{id:e.id,count:s}}),[N,k,M]),U=e.useMemo(()=>{const e=a.id||a.userId||a.user_id,s=q.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e).map(e=>e.id);return P.map(e=>{let a=0;return void 0!==e.statuses&&(a=N.filter(a=>("all"===e.id||e.statuses.includes(a.status))&&s.includes(a.journal)).length),{id:e.id,count:a}})},[a,N,q,P]),Q=e.useCallback(async()=>{if(a)try{C(!0),T(null);const[e,s,t]=await Promise.all([a.role===ua.Author?aa.list({author:a.id}):aa.list(),ia.list(),sa.list()]);let i=[];Array.isArray(e)?i=e:e&&"object"==typeof e&&"results"in e&&Array.isArray(e.results)?i=e.results:(null==e?void 0:e.data)&&Array.isArray(e.data)&&(i=e.data);const l=Array.isArray(s)?s:(null==s?void 0:s.data)&&Array.isArray(s.data)?s.data:(null==s?void 0:s.results)&&Array.isArray(s.results)?s.results:[],r=Array.isArray(t)?t:(null==t?void 0:t.data)&&Array.isArray(t.data)?t.data:(null==t?void 0:t.results)&&Array.isArray(t.results)?t.results:[];w(i),_(l),S(r)}catch(e){T((null==e?void 0:e.message)||"Maqolalar ma'lumotlarini yuklashda xatolik. Iltimos, keyinroq urinib ko'ring.")}finally{C(!1)}},[a]);if(e.useEffect(()=>{Q()},[Q]),!a)return null;if(z)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(A)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:A}),u.jsx(_a,{onClick:()=>{T(null),Q()},className:"mt-4",children:"Qayta urinish"})]});const K=(e,a)=>u.jsx("div",{className:"mb-6 border-b border-white/10 flex",children:e.map(e=>{var s;const t=(null==(s=a.find(a=>a.id===e.id))?void 0:s.count)||0;return u.jsxs("button",{onClick:()=>o(e.id),className:"px-4 py-3 font-medium text-sm transition-colors "+(n===e.id?"border-b-2 border-blue-400 text-blue-400":"text-gray-400 hover:text-white"),children:[e.label," ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+(n===e.id?"bg-blue-500/20 text-blue-300":"bg-white/10 text-gray-300"),children:t})]},e.id)})});return u.jsxs(u.Fragment,{children:[u.jsxs(ka,{title:F,children:[a.role===ua.Author&&u.jsx("div",{className:"mb-6 flex justify-end",children:u.jsxs(_a,{onClick:()=>c(!0),variant:"secondary",children:[u.jsx(l,{className:"mr-2 h-4 w-4"})," Barcha maqolalar bo'yicha ma'lumotnoma"]})}),a.role===ua.Reviewer&&K(M,R),t&&K(P,U),u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsxs("div",{className:"flex-1 flex items-center bg-white/5 border border-white/10 rounded-xl focus-within:border-accent-color focus-within:ring-2 focus-within:ring-accent-color-glow transition-all",children:[u.jsx(L,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Sarlavha, muallif yoki kalit so'z bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:i,onChange:e=>r(e.target.value)})]}),u.jsx("button",{onClick:()=>x(!m),className:"p-3 rounded-xl border transition-all "+(I?"bg-blue-500/20 border-blue-500/40 text-blue-300":"bg-white/5 border-white/10 text-gray-400 hover:text-white"),children:u.jsx(J,{size:20})}),I&&u.jsx("button",{onClick:()=>{g(""),j(""),f(""),v("")},className:"p-3 rounded-xl bg-red-500/10 border border-red-500/30 text-red-400 hover:text-red-300 transition-all",children:u.jsx(Y,{size:20})})]}),m&&u.jsxs("div",{className:"mb-6 p-4 bg-white/5 border border-white/10 rounded-xl grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Jurnal"}),u.jsxs("select",{value:h,onChange:e=>g(e.target.value),className:"w-full bg-gray-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white",children:[u.jsx("option",{value:"",children:"Barchasi"}),q.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Plagiat darajasi"}),u.jsxs("select",{value:p,onChange:e=>j(e.target.value),className:"w-full bg-gray-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white",children:[u.jsx("option",{value:"",children:"Barchasi"}),u.jsx("option",{value:"low",children:"Past (<20%)"}),u.jsx("option",{value:"medium",children:"O'rtacha (20-50%)"}),u.jsx("option",{value:"high",children:"Yuqori (>50%)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Sanadan"}),u.jsx("input",{type:"date",value:b,onChange:e=>f(e.target.value),className:"w-full bg-gray-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs text-gray-400 mb-1 block",children:"Sanagacha"}),u.jsx("input",{type:"date",value:y,onChange:e=>v(e.target.value),className:"w-full bg-gray-800 border border-white/10 rounded-lg px-3 py-2 text-sm text-white"})]})]}),I&&u.jsxs("p",{className:"text-xs text-gray-400 mb-4",children:["Natijalar: ",E.length," ta maqola topildi"]}),(()=>{if(a.role===ua.Reviewer&&"translations"===n)return u.jsx("div",{className:"space-y-4",children:$.length>0?$.map(e=>u.jsx(Ba,{request:e},e.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Yangi tarjima so'rovlari mavjud emas."})});const e=a.role===ua.SuperAdmin,t=s===ua.JournalAdmin||"journal_admin"===s||"journaladmin"===s;let l=[];if(t){const e=a.id||a.userId||a.user_id,s=q.filter(a=>(a.journal_admin||a.journalAdminId||a.journalAdmin||a.admin_id||a.admin&&a.admin.id)===e);l=s.map(e=>e.id)}return u.jsx("div",{className:"space-y-4",children:E.length>0?E.map(s=>u.jsx(Ya,{article:s,isAdmin:e,isJournalAdmin:t,userId:a.id,journalIds:l,onStatusUpdate:Q},s.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Ushbu bo'limda hozircha maqolalar mavjud emas."})})})()]}),d&&a&&u.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4 no-print",children:u.jsxs("div",{className:"w-full max-w-4xl h-[90vh] bg-gray-800 rounded-lg shadow-2xl flex flex-col",children:[u.jsxs("div",{className:"p-4 border-b border-white/10 flex justify-between items-center",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:"Maqolalar bo'yicha ma'lumotnoma"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(_a,{onClick:()=>{window.print()},variant:"primary",children:[u.jsx(B,{className:"mr-2 h-4 w-4"})," Chop Etish"]}),u.jsx(_a,{onClick:()=>c(!1),variant:"secondary",children:"Yopish"})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsx("div",{id:"author-report-print-area",children:u.jsx(Ma,{articles:D.map(La),author:a})})})]})})]})},Ka=()=>{var a;const{user:s}=ma(),{showNotification:t}=xa(),[r,n]=e.useState(1),[d,c]=e.useState(!1),m=e.useRef(null),[x,h]=e.useState({title:"",authorName:"",file:null,abstract:"",keywords:"",references:"",coAuthors:[]}),[g,p]=e.useState(0),[j,b]=e.useState(0),[f,y]=e.useState(null),[v,N]=e.useState(!1),[w,k]=e.useState({}),q=[{id:1,title:"Fayl yuklash",icon:K},{id:2,title:"Maqola tavsifi",icon:l},{id:3,title:"Hammualliflar",icon:i},{id:4,title:"Tasdiqlash",icon:A}],S=e=>{const a={};return 1===e?x.file||(a.file="Faylni tanlang"):2===e&&(x.title.trim()||(a.title="Maqola mavzusini kiriting"),x.authorName.trim()||(a.authorName="Muallif ism-familiyasini kiriting"),x.abstract.trim()||(a.abstract="Abstraktni kiriting"),x.keywords.trim()||(a.keywords="Kalit so'zlarni kiriting")),k(a),0===Object.keys(a).length},z=(e,a,s)=>{const t=[...x.coAuthors];t[e][a]=s,h({...x,coAuthors:t})};return u.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Maqola yuborish"}),u.jsx("p",{className:"text-gray-400",children:"Maqolangizni nashr qilish uchun yuboring"})]}),u.jsxs("div",{className:"mb-8",children:[u.jsx("div",{className:"flex justify-between",children:q.map(e=>{const a=e.icon,s=r===e.id,t=r>e.id;return u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mb-2 "+(t?"bg-green-600":s?"bg-blue-600":"bg-gray-600"),children:t?u.jsx(o,{className:"w-6 h-6 text-white"}):u.jsx(a,{className:"w-6 h-6 text-white"})}),u.jsx("span",{className:"text-sm font-medium "+(s?"text-blue-400":t?"text-green-400":"text-gray-400"),children:e.title})]},e.id)})}),u.jsx("div",{className:"mt-4 bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:(r-1)/(q.length-1)*100+"%"}})})]}),u.jsxs(ka,{className:"p-6",children:[1===r&&u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Fayl yuklash"}),u.jsx("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center cursor-pointer hover:border-gray-500 transition-colors",onClick:()=>{var e;return null==(e=m.current)?void 0:e.click()},children:x.file?u.jsxs("div",{className:"space-y-2",children:[u.jsx(o,{className:"w-12 h-12 text-green-500 mx-auto"}),u.jsx("p",{className:"text-white font-medium",children:x.file.name}),u.jsxs("p",{className:"text-gray-400 text-sm",children:[(x.file.size/1024/1024).toFixed(2)," MB"]})]}):u.jsxs("div",{className:"space-y-2",children:[u.jsx(K,{className:"w-12 h-12 text-gray-400 mx-auto"}),u.jsx("p",{className:"text-white font-medium",children:"Faylni tanlang"}),u.jsx("p",{className:"text-gray-400 text-sm",children:"DOCX yoki PDF, maksimal 10MB"})]})}),u.jsx("input",{ref:m,type:"file",accept:".docx,.pdf",onChange:e=>{var a;const s=null==(a=e.target.files)?void 0:a[0];if(s){if(!s.name.toLowerCase().endsWith(".docx")&&!s.name.toLowerCase().endsWith(".pdf"))return void t("Faqat DOCX yoki PDF fayllarini yuklash mumkin","error");if(s.size>10485760)return void t("Fayl hajmi 10MB dan oshmasligi kerak","error");h({...x,file:s})}},className:"hidden"}),w.file&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:w.file})]})}),2===r&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Maqola tavsifi"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Maqola mavzusi *"}),u.jsx("input",{type:"text",value:x.title,onChange:e=>h({...x,title:e.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Maqola mavzusini kiriting"}),w.title&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.title})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Muallif ism-familiyasi *"}),u.jsx("input",{type:"text",value:x.authorName,onChange:e=>h({...x,authorName:e.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Ism familiyani kiriting"}),w.authorName&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.authorName})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Abstrakt *"}),u.jsx("textarea",{value:x.abstract,onChange:e=>h({...x,abstract:e.target.value}),rows:4,className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Maqola abstraktini kiriting"}),w.abstract&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.abstract})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kalit so'zlar *"}),u.jsx("input",{type:"text",value:x.keywords,onChange:e=>h({...x,keywords:e.target.value}),className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Kalit so'zlarni vergul bilan ajratib kiriting"}),w.keywords&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.keywords})]}),u.jsxs("div",{className:"border-t border-gray-600 pt-6",children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Antiplagiat tekshiruvi"}),u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs(_a,{onClick:async()=>{if(x.abstract.trim()){N(!0);try{await new Promise(e=>setTimeout(e,2e3));const e=30*Math.random(),a=20*Math.random();p(e),b(a),y((new Date).toISOString()),t("Antiplagiat tekshiruvi tugadi","success")}catch(e){t("Tekshiruvda xatolik yuz berdi","error")}finally{N(!1)}}else t("Avval abstraktni kiriting","error")},disabled:v||!x.abstract.trim(),variant:"secondary",className:"flex items-center gap-2",children:[v?u.jsx(H,{className:"w-4 h-4 animate-spin"}):u.jsx(F,{className:"w-4 h-4"}),v?"Tekshirilmoqda...":"Antiplagiat tekshiruvi"]}),f&&u.jsx(Ra,{plagiarism:g,ai:j,checkedAt:f})]}),f&&u.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-4",children:[u.jsxs("p",{className:"text-blue-300 text-sm",children:[u.jsx("strong",{children:"Plagiat foizi:"})," ",g.toFixed(1),"% |",u.jsx("strong",{children:" AI kontent:"})," ",j.toFixed(1),"%"]}),u.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["Tekshiruv vaqti: ",new Date(f).toLocaleString()]})]}),u.jsx("div",{className:"mt-4 p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:u.jsxs("p",{className:"text-yellow-300 text-sm",children:[u.jsx("strong",{children:"Qanday hisoblanadi?"})," Antiplagiat tekshiruvi maqola matnini millionlab ilmiy manbalar bilan solishtiradi. Plagiat foizi - matnning qanchalik mos kelishi, AI kontent - sun'iy intellekt tomonidan yaratilganlik darajasi. Odatda plagiat 15% dan kam, AI kontent 10% dan kam bo'lishi kerak."]})})]})]}),3===r&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Hammualliflar"}),x.coAuthors.map((e,a)=>u.jsxs("div",{className:"flex gap-4 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hammuallif ismi"}),u.jsx("input",{type:"text",value:e.name,onChange:e=>z(a,"name",e.target.value),className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"Ism familiyani kiriting"})]}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:e.email,onChange:e=>z(a,"email",e.target.value),className:"w-full px-3 py-2 bg-white/5 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-blue-500",placeholder:"email@example.com"})]}),u.jsx(_a,{onClick:()=>(e=>{h({...x,coAuthors:x.coAuthors.filter((a,s)=>s!==e)})})(a),variant:"secondary",className:"mb-0",children:u.jsx(_,{className:"w-4 h-4"})})]},a)),u.jsx(_a,{onClick:()=>{h({...x,coAuthors:[...x.coAuthors,{name:"",email:""}]})},variant:"secondary",className:"w-full",children:"+ Hammuallif qo'shish"})]}),4===r&&u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Tasdiqlash"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Fayl"}),u.jsx("p",{className:"text-gray-300",children:null==(a=x.file)?void 0:a.name})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Maqola ma'lumotlari"}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-4 space-y-2",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Mavzu:"})," ",x.title]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Muallif:"})," ",x.authorName]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Kalit so'zlar:"})," ",x.keywords]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Abstrakt:"})," ",x.abstract.substring(0,100),"..."]})]})]}),f&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Antiplagiat natijalari"}),u.jsx(Ra,{plagiarism:g,ai:j,checkedAt:f})]}),x.coAuthors.length>0&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Hammualliflar"}),u.jsx("div",{className:"space-y-2",children:x.coAuthors.map((e,a)=>u.jsx("div",{className:"bg-white/5 rounded-lg p-3",children:u.jsxs("p",{children:[e.name," - ",e.email]})},a))})]})]})]}),u.jsxs("div",{className:"flex justify-between mt-8 pt-6 border-t border-gray-600",children:[u.jsx(_a,{onClick:()=>{n(r-1)},disabled:1===r,variant:"secondary",children:"Orqaga"}),r<q.length?u.jsx(_a,{onClick:()=>{S(r)&&n(r+1)},children:"Keyingi"}):u.jsxs(_a,{onClick:async()=>{if(S(4)){c(!0);try{const e=new FormData;e.append("title",x.title),e.append("author_name",x.authorName),e.append("abstract",x.abstract),e.append("keywords",x.keywords),e.append("references",x.references),e.append("file",x.file),e.append("co_authors",JSON.stringify(x.coAuthors)),e.append("plagiarism_percentage",g.toString()),e.append("ai_content_percentage",j.toString()),e.append("plagiarism_checked_at",f||""),await aa.create(e),t("Maqola muvaffaqiyatli yuborildi","success"),h({title:"",authorName:"",file:null,abstract:"",keywords:"",references:"",coAuthors:[]}),p(0),b(0),y(null),n(1)}catch(e){t("Maqola yuborishda xatolik yuz berdi","error")}finally{c(!1)}}},disabled:d,className:"flex items-center gap-2",children:[d&&u.jsx(H,{className:"w-4 h-4 animate-spin"}),"Yuborish"]})]})]})]})},Ha=()=>{const{user:a}=ma(),[s,t]=e.useState([]),[i,l]=e.useState(""),[r,n]=e.useState(!0),[o,d]=e.useState(null),[c,m]=e.useState(!1),[x,h]=e.useState(!1),[g,p]=e.useState({first_name:"",last_name:"",email:"",phone:"",role:ua.Author,password:"",affiliation:""});e.useEffect(()=>{(async()=>{if(a)try{n(!0),d(null);const e=await ea.list(),a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[];t(a)}catch(e){console.error("Failed to fetch users:",e),d("Foydalanuvchilarni yuklashda xatolik yuz berdi.")}finally{n(!1)}})()},[a]);const j=()=>{m(!1)},b=e=>{const{name:a,value:s}=e.target;p(e=>({...e,[a]:s}))},f={author:"Muallif",reviewer:"Taqrizchi",journal_admin:"Jurnal administratori",super_admin:"Bosh administrator",accountant:"Moliyachi"},y={author:"bg-blue-500/20 text-blue-300",reviewer:"bg-purple-500/20 text-purple-300",journal_admin:"bg-indigo-500/20 text-indigo-300",super_admin:"bg-red-500/20 text-red-300",accountant:"bg-green-500/20 text-green-300"};if(r)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(o)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:o}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const v=(Array.isArray(s)?s:[]).filter(e=>{var a,s,t,l;return(null==(a=e.first_name)?void 0:a.toLowerCase().includes(i.toLowerCase()))||(null==(s=e.last_name)?void 0:s.toLowerCase().includes(i.toLowerCase()))||(null==(t=e.email)?void 0:t.toLowerCase().includes(i.toLowerCase()))||(null==(l=e.phone)?void 0:l.includes(i))});return u.jsxs(u.Fragment,{children:[u.jsxs(ka,{title:"Foydalanuvchilar boshqaruvi",children:[u.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center bg-white/5 border border-white/10 rounded-xl focus-within:border-accent-color focus-within:ring-2 focus-within:ring-accent-color-glow transition-all",children:[u.jsx(L,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Ism, familiya, email yoki telefon bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:i,onChange:e=>l(e.target.value)})]})}),u.jsxs(_a,{onClick:()=>{p({first_name:"",last_name:"",email:"",phone:"",role:ua.Author,password:"",affiliation:""}),m(!0)},children:[u.jsx(X,{className:"mr-2 h-4 w-4"})," Yangi foydalanuvchi"]})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/10",children:u.jsxs("table",{className:"w-full text-left",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Foydalanuvchi"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Rol"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Telefon"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Tashkilot"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Ro'yxatdan o'tgan"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Amallar"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:v.map(e=>u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-4 py-4",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.avatar_url?u.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:e.avatar_url,alt:e.first_name}):u.jsx("div",{className:"h-10 w-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center",children:u.jsx(q,{className:"h-5 w-5 text-white"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsxs("div",{className:"text-sm font-medium text-white",children:[e.first_name," ",e.last_name]}),u.jsx("div",{className:"text-sm text-gray-400",children:e.email})]})]})}),u.jsx("td",{className:"px-4 py-4",children:u.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${y[e.role]}`,children:f[e.role]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:e.phone}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:e.affiliation}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:new Date(e.date_joined).toLocaleDateString()}),u.jsx("td",{className:"px-4 py-4 text-sm",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(_a,{variant:"secondary",children:u.jsx(A,{className:"h-4 w-4"})}),u.jsx(_a,{variant:"secondary",children:u.jsx(Z,{className:"h-4 w-4"})}),u.jsx(_a,{variant:"danger",children:u.jsx(W,{className:"h-4 w-4"})})]})})]},e.id))})]})}),0===v.length&&u.jsxs("div",{className:"text-center py-12",children:[u.jsx(q,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-white",children:"Foydalanuvchilar topilmadi"}),u.jsx("p",{className:"mt-1 text-sm text-gray-400",children:i?`"${i}" bo'yicha hech narsa topilmadi.`:"Hozircha foydalanuvchilar mavjud emas."})]})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(ka,{className:"w-full max-w-2xl",title:"Yangi foydalanuvchi qo'shish",children:[u.jsx("button",{onClick:j,className:"absolute top-4 right-4 text-gray-400 hover:text-white",children:u.jsx(Y,{size:24})}),u.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g.first_name&&g.last_name&&g.email&&g.phone&&g.password)try{h(!0);const e={first_name:g.first_name,last_name:g.last_name,email:g.email,phone:g.phone,role:g.role,password:g.password,affiliation:g.affiliation},a=await ea.create(e);t(e=>[...e,a]),j(),alert("Foydalanuvchi muvaffaqiyatli qo'shildi!")}catch(a){console.error("Failed to create user:",a),alert("Foydalanuvchi yaratishda xatolik yuz berdi: "+(a.message||"Noma'lum xatolik"))}finally{h(!1)}else alert("Iltimos, barcha majburiy maydonlarni to'ldiring.")},className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism *"}),u.jsx("input",{type:"text",name:"first_name",value:g.first_name,onChange:b,className:"w-full",placeholder:"Ism",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya *"}),u.jsx("input",{type:"text",name:"last_name",value:g.last_name,onChange:b,className:"w-full",placeholder:"Familiya",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),u.jsx("input",{type:"email",name:"email",value:g.email,onChange:b,className:"w-full",placeholder:"email@example.com",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon *"}),u.jsx("input",{type:"tel",name:"phone",value:g.phone,onChange:b,className:"w-full",placeholder:"+998 XX XXX XXXX",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tashkilot"}),u.jsx("input",{type:"text",name:"affiliation",value:g.affiliation,onChange:b,className:"w-full",placeholder:"Tashkilot nomi"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Rol *"}),u.jsxs("select",{name:"role",value:g.role,onChange:b,className:"w-full",required:!0,children:[u.jsx("option",{value:ua.Author,children:"Muallif"}),u.jsx("option",{value:ua.Reviewer,children:"Taqrizchi"}),u.jsx("option",{value:ua.JournalAdmin,children:"Jurnal administratori"}),u.jsx("option",{value:ua.Accountant,children:"Moliyachi"}),u.jsx("option",{value:ua.SuperAdmin,children:"Bosh administrator"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol *"}),u.jsx("input",{type:"password",name:"password",value:g.password,onChange:b,className:"w-full",placeholder:"Parol",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-white/10 mt-6",children:[u.jsx(_a,{type:"button",variant:"secondary",onClick:j,disabled:x,children:"Bekor qilish"}),u.jsx(_a,{type:"submit",disabled:x,children:x?"Yaratilmoqda...":"Foydalanuvchi qo'shish"})]})]})]})})]})},Xa=()=>{const{user:a}=ma(),{addNotification:s}=xa(),[t,i]=e.useState(!0),[l,r]=e.useState(null),[n,o]=e.useState([]),[d,c]=e.useState({}),[m,x]=e.useState([]);if(e.useEffect(()=>{(async()=>{if(a&&a.role===ua.SuperAdmin)try{i(!0),r(null);const[e,a]=await Promise.all([aa.list(),ea.list()]),s=Array.isArray(e)?e:[],t=Array.isArray(a)?a:[];x(t);const l=s.filter(e=>e.status===ha.Yangi).slice(0,2).map(e=>{const a=t.find(a=>a.id===e.author);return{id:e.id,author:a?`${a.firstName} ${a.lastName}`:"Noma'lum",title:e.title}});o(l)}catch(e){console.error("Failed to fetch UDK requests:",e),r("UDK so'rovlarni yuklashda xatolik yuz berdi.")}finally{i(!1)}})()},[a]),(null==a?void 0:a.role)!==ua.SuperAdmin)return u.jsx(ka,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(t)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(l)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:l}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});return u.jsx(ka,{title:"UDK Kod So'rovlarini Boshqarish",children:u.jsx("div",{className:"space-y-4",children:n.length>0?n.map(e=>u.jsxs("div",{className:"p-4 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 dark:border-gray-700",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-semibold",children:e.title}),u.jsx("p",{className:"text-sm text-gray-500",children:e.author})]}),u.jsxs("div",{className:"flex items-center space-x-2 w-full sm:w-auto",children:[u.jsx("input",{type:"text",placeholder:"UDK kodini kiriting...",className:"w-full sm:w-48",value:d[e.id]||"",onChange:a=>{return s=e.id,t=a.target.value,void c(e=>({...e,[s]:t}));var s,t}}),u.jsx(_a,{onClick:()=>(async e=>{const a=d[e];if(a&&a.trim())try{const t=n.find(a=>a.id===e);t&&s({message:`Sizning "${t.title.substring(0,30)}..." maqolangiz uchun UDK kodi tasdiqlandi: ${a}`,link:`/articles/${e}`}),o(a=>a.filter(a=>a.id!==e)),s({message:"UDK kodi muallifga muvaffaqiyatli yuborildi."})}catch(t){console.error("Failed to send UDK code:",t),alert("UDK kodini yuborishda xatolik yuz berdi.")}else alert("Iltimos, UDK kodini kiriting.")})(e.id),children:"Yuborish"})]})]},e.id)):u.jsx("p",{className:"text-center text-gray-400 py-8",children:"Yangi UDK so'rovlari mavjud emas."})})})},Za=({data:e})=>u.jsxs("div",{className:"bg-white text-gray-800 aspect-[297/210] w-full max-w-6xl mx-auto shadow-2xl overflow-hidden relative font-sans p-2",children:[u.jsx(Aa,{}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-16 py-8",children:[u.jsxs("header",{className:"flex justify-between items-center w-full border-b-2 border-[#C09D58] pb-3",children:[u.jsx(za,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-serif text-sm text-[#0D2A4F]/70 tracking-[0.2em] uppercase",children:"Phoenix Ilmiy Nashrlar Markazi"}),u.jsx("h1",{className:"font-serif text-5xl font-bold text-[#0D2A4F] tracking-wide my-1",children:"SERTIFIKAT"}),u.jsx("p",{className:"text-xs text-[#0D2A4F]/60 tracking-[0.4em] uppercase",children:"Originality & Plagiarism Check"})]}),u.jsx(za,{})]}),u.jsxs("main",{className:"flex-grow flex flex-col items-center justify-center text-center my-4",children:[u.jsx("p",{className:"text-base text-slate-700",children:"Ushbu sertifikat quyidagi ilmiy ishning tekshiruv natijalarini tasdiqlaydi:"}),u.jsxs("h2",{className:"font-serif text-xl font-medium text-slate-800 mt-4 max-w-3xl",children:['"',e.fileName,'"']}),u.jsx("p",{className:"text-base text-slate-700 mt-4",children:"Muallif"}),u.jsx("h3",{className:"text-4xl font-bold text-[#0D2A4F] font-serif tracking-wide",children:e.author}),u.jsxs("div",{className:"w-full grid grid-cols-2 gap-6 items-center mt-6 p-4",children:[u.jsxs("div",{className:"text-center p-4 border border-[#C09D58]/50 bg-gradient-to-br from-white/50 to-transparent rounded-lg",children:[u.jsx("p",{className:"text-sm font-semibold text-[#0D2A4F] uppercase tracking-wider",children:"Originallik"}),u.jsx("p",{className:"font-serif text-7xl font-bold text-green-800",children:e.originality})]}),u.jsxs("div",{className:"text-center p-4 border border-[#C09D58]/50 bg-gradient-to-br from-white/50 to-transparent rounded-lg",children:[u.jsx("p",{className:"text-sm font-semibold text-[#0D2A4F] uppercase tracking-wider",children:"O'zlashtirish (Plagiat)"}),u.jsx("p",{className:"font-serif text-7xl font-bold text-red-800",children:e.plagiarism})]})]}),u.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:["Tekshiruv sanasi: ",e.checkDate," ",u.jsx("span",{className:"mx-2",children:"|"})," Sertifikat raqami: ",e.certificateNumber]})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-3 border-t-2 border-[#C09D58]",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=80x80&data=https://ilmiyfaoliyat.uz/verify/${e.certificateNumber}&bgcolor=ffffff`,alt:"QR Code",className:"p-1 bg-white border border-slate-400"}),u.jsx("p",{className:"text-[9px] text-slate-600 max-w-[80px] mt-1",children:"Hujjatni tasdiqlang"})]}),u.jsx(Ca,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-10 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"}),u.jsx("p",{className:"text-xs text-slate-600",children:"PINM Tahririyati"})]})]})]})]});const Wa=new class{async processPayment(e,a="click"){try{const s=await ta.processPayment(e,a);return s&&void 0===s.success&&(s.payment_url||0===s.error_code||!s.error_code&&!s.error?s.success=!0:s.success=!1),s&&s.payment_url&&!1===s.success&&(console.warn("Payment URL exists but success is false, overriding to true:",s),s.success=!0),s}catch(s){console.error("Error processing payment:",s);let e="To'lovni amalga oshirishda xatolik yuz berdi",a=-1;return s.message?e=s.message:"string"==typeof s?e=s:s.error?e=s.error:s.error_note&&(e=s.error_note),s.error_code&&(a=s.error_code),{success:!1,error_code:a,error:e,error_note:e}}}async checkPaymentStatus(e){try{const a=(await ta.listTransactions()).find(a=>a.id===e);return a?{error_code:0,error_note:"Success",payment_status:"completed"===a.status?2:"failed"===a.status?-1:0}:{error_code:-5,error_note:"Transaction not found"}}catch(a){return console.error("Error checking payment status:",a),{error_code:-9,error_note:a.message||"Failed to check payment status"}}}redirectToPayment(e){if(!e)throw console.error("Payment URL is not available"),new Error("To'lov URL topilmadi");try{if(!new URL(e).protocol.startsWith("http"))throw console.error("Invalid payment URL protocol:",e),new Error("Noto'g'ri to'lov URL formati")}catch(a){throw console.error("Invalid payment URL format:",e,a),new Error("Noto'g'ri to'lov URL formati")}try{document.body&&(document.body.innerHTML=""),window.location.replace(e),setTimeout(()=>{window.location.href!==e&&(console.warn("Replace failed, using href as fallback"),window.location.href=e)},100)}catch(s){console.error("Failed to redirect to payment URL:",s);try{if(!window.open(e,"_blank"))throw new Error("Popup blocked")}catch(t){throw new Error("To'lov sahifasiga yo'naltirishda xatolik yuz berdi. Iltimos, quyidagi linkni oching: "+e)}}}async createTransactionAndPay(e,a,s,t,i,l="click"){try{const r={amount:e,currency:a||"UZS",service_type:s};t&&""!==t.trim()&&(r.article=t),i&&""!==i.trim()&&(r.translation_request=i);const n=await ta.createTransaction(r);if(!n||!n.id)return console.error("Transaction creation failed - no ID returned:",n),{success:!1,error_code:-1,error:"Transaction yaratilmadi. Server javob bermadi.",error_note:"Failed to create transaction - no transaction ID returned"};n.id;const o=await this.processPayment(n.id,l);return{...o,transaction_id:n.id}}catch(r){console.error("Error creating transaction and processing payment:",r);let e="To'lovni amalga oshirishda xatolik yuz berdi";return r.message?e=r.message:"string"==typeof r?e=r:r.error?e=r.error:r.error_note&&(e=r.error_note),{success:!1,error_code:r.error_code||-1,error:e,error_note:e}}}},Ga=5e4,Va=()=>{const{user:a}=ma(),{addNotification:s}=xa(),[t,i]=e.useState(null),[l,r]=e.useState([]),[n,o]=e.useState(!1),[c,m]=e.useState(0),[x,h]=e.useState(null),[g,p]=e.useState(null),[j,b]=e.useState(!1),[f,y]=e.useState("idle"),[v,N]=e.useState(null),[w,k]=e.useState(null),_=e.useRef(null);G.useEffect(()=>()=>{_.current&&clearTimeout(_.current)},[]),G.useEffect(()=>{(async()=>{if(a)try{const e=await sa.list(),a=Array.isArray(e)?e:(null==e?void 0:e.results)||(null==e?void 0:e.data)||[];r(a)}catch(e){console.error("Failed to fetch journals for plagiarism check:",e)}})()},[a]);const q=async()=>{if(!t||!a)throw new Error("Fayl yoki foydalanuvchi topilmadi.");if(w)return w;const e=l[0];if(!(null==e?void 0:e.id))throw new Error("Jurnal topilmadi. Iltimos, avval jurnal yarating yoki administratorga murojaat qiling.");const s={title:`Plagiarism Check - ${t.name}`,abstract:"Document submitted for plagiarism check",keywords:["plagiarism","check","document"],journal:e.id,page_count:1,fast_track:!1},i=await aa.create(s,{mainFile:t}),r=(null==i?void 0:i.data)||i;if(!(null==r?void 0:r.id))throw new Error("Antiplagiat uchun maqola yaratilmadi.");return k(r.id),r.id},S=()=>{b(!1),_.current&&clearTimeout(_.current),y("idle"),N(null)},z=async()=>{if(t&&a){N(null),y("processing"),_.current&&clearTimeout(_.current);try{const e=await q(),a=await Wa.createTransactionAndPay(Ga,"UZS","language_editing",e);if(a&&!0===a.success&&a.payment_url)y("success"),s({message:"To'lov oynasi yangi tabda ochildi. To'lovdan so'ng \"Tekshirishni davom ettirish\" tugmasini bosing."}),window.open(a.payment_url,"_blank","noopener,noreferrer");else{const e=(null==a?void 0:a.user_message)||(null==a?void 0:a.error_note)||(null==a?void 0:a.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";y("failed"),N(e),s({message:e})}}catch(e){console.error("Payment failed:",e);const a=e.message||e.error_note||e.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";y("failed"),N(a)}}},C=[{url:"www.ilmiymaqolalar.uz/archive/2021/article-15.html",snippet:"...bu esa o'z navbatida iqtisodiy o'sishga sezilarli ta'sir ko'rsatadi va innovatsion rivojlanishga olib keladi..."},{url:"cyberleninka.ru/article/n/digital-economy-trends-uz",snippet:"...the integration of artificial intelligence technologies is a key factor for future development..."},{url:"jstor.org/stable/25733682",snippet:"...methodology involved a qualitative analysis of emerging market trends..."},{url:"researchgate.net/publication/3456789/AI_in_Economics",snippet:"...sun'iy intellekt texnologiyalarini joriy etish kelajakdagi rivojlanishning asosiy omili hisoblanadi..."}],A=async(e=!1)=>{if(t&&a)if(e){o(!0),p(null),h(null),m(0);try{const e=await q(),s=await aa.checkPlagiarism(e),i=s.plagiarism||0,l=s.ai_content||0,r=100-i,n=Math.floor(2*Math.random())+2,o=[...C].sort(()=>.5-Math.random()),d=[];let c=i;for(let a=0;a<n&&!(c<=0);a++){const e=Math.min(c,Math.floor(4*Math.random())+2);c-=e,d.push({source:o[a].url,snippet:o[a].snippet,similarity:e})}h({plagiarism:i,aiContent:l,sources:d});const m={certificateNumber:`PN-${Date.now().toString().slice(-6)}`,checkDate:(new Date).toLocaleDateString("uz-UZ"),author:`${a.lastName} ${a.firstName}`,workType:"Ilmiy ish",fileName:t.name,citations:"0%",plagiarism:`${i}%`,originality:`${r.toFixed(2)}%`,searchModules:"Milliy reestr, Internet plyus, Shablon iboralar, eLIBRARY.RU, Bibliografiya, BMK dissertatsiyalari, Viloy nashriyoti, Universitetlar halqasi, IPS Adilet, Tabobat, Tarjimali matnlar qidiruv moduli, Patentlar, Tarjima tekshiruvi uz-ru, Tarjima tekshiruvi uz-ru, parafaz matnlarni tekshirish, RDK to'plami, Rossiya va MDH OAVlari, Elektron-kutubxona tizimlari, Garant AHT, Iqtibos keltirish, SPS Garant"};p(m),se.success("Antiplagiat tekshiruvi muvaffaqiyatli amalga oshirildi!")}catch(s){se.error(Ke(s)||"Antiplagiat tekshiruvida xatolik yuz berdi.")}finally{o(!1),m(100)}}else b(!0)};return u.jsxs(u.Fragment,{children:[u.jsxs(ka,{title:"Mustaqil Antiplagiat Tekshiruvi",className:"no-print",children:[u.jsx("div",{className:"text-center",children:u.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-10 border-2 border-dashed rounded-lg dark:border-gray-600 bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(d,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-300",children:t?`Tanlangan fayl: ${t.name}`:"Tekshirish uchun faylni tanlang (.docx, .pdf)"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maksimal hajmi: 10MB"})]}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:e=>{e.target.files&&(i(e.target.files[0]),h(null),p(null),m(0),k(null))},accept:".pdf,.doc,.docx"})]})}),u.jsxs("div",{className:"mt-6 text-center space-y-4",children:[u.jsxs("div",{className:"p-4 bg-blue-900/20 border border-blue-700/30 rounded-lg",children:[u.jsxs("p",{className:"text-sm text-gray-300 mb-2",children:[u.jsx("span",{className:"font-semibold text-blue-300",children:"Narx:"})," ",Ga.toLocaleString()," so'm"]}),u.jsx("p",{className:"text-xs text-gray-400",children:"Antiplagiat tekshiruvi uchun to'lov talab qilinadi"})]}),u.jsx(_a,{onClick:()=>A(!1),disabled:!t||n,isLoading:n,className:"w-full max-w-xs mx-auto",children:n?"Tekshirilmoqda...":u.jsxs(u.Fragment,{children:[u.jsx(V,{className:"mr-2 h-4 w-4"})," To'lov va Tekshirish"]})})]}),n&&u.jsxs("div",{className:"mt-8 max-w-lg mx-auto",children:[u.jsx("p",{className:"text-center text-gray-300 mb-2",children:"Tahlil qilinmoqda... Iltimos, kuting."}),u.jsx("div",{className:"w-full bg-white/10 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${c}%`,transition:"width 0.3s ease-in-out"}})})]}),x&&u.jsxs("div",{className:"mt-8",children:[u.jsx("h3",{className:"text-xl font-bold text-center mb-4 text-white",children:"Tekshiruv Natijalari"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-3xl mx-auto p-4 bg-white/5 rounded-lg",children:[u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Originallik"}),u.jsxs("p",{className:"text-4xl font-bold text-green-400 mt-1",children:[100-x.plagiarism,"%"]})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"O'xshashlik (Plagiat)"}),u.jsxs("p",{className:"text-4xl font-bold text-yellow-400 mt-1",children:[x.plagiarism,"%"]})]}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"AI-Kontent"}),u.jsxs("p",{className:"text-4xl font-bold text-cyan-400 mt-1",children:[x.aiContent,"%"]})]})]}),u.jsxs(ka,{title:"Topilgan manbalar",className:"mt-6 max-w-3xl mx-auto",children:[u.jsx("p",{className:"text-sm text-gray-400 mb-4 -mt-4",children:"Tizim matningizga o'xshashlik topgan manbalar ro'yxati. Bu natijalar taxminiy bo'lib, yakuniy xulosa uchun qo'shimcha tahlil talab etilishi mumkin."}),u.jsx("div",{className:"space-y-4 max-h-80 overflow-y-auto pr-2",children:x.sources.map((e,a)=>u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[u.jsxs("div",{className:"flex justify-between items-start text-sm",children:[u.jsxs("a",{href:`https://${e.source}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-400 hover:underline break-all",children:[u.jsx(ee,{size:14})," ",e.source]}),u.jsxs("span",{className:"font-bold text-yellow-300 whitespace-nowrap ml-4",children:[e.similarity,"% o'xshashlik"]})]}),u.jsx("blockquote",{className:"mt-2 pl-3 border-l-2 border-yellow-500/50 text-xs text-gray-400 italic",children:e.snippet})]},a))})]})]})]}),g&&u.jsxs("div",{className:"mt-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:"Tekshiruv Sertifikati"}),u.jsxs(_a,{onClick:()=>{window.print()},variant:"secondary",children:[u.jsx(B,{className:"mr-2 h-4 w-4"})," Sertifikatni Chop Etish"]})]}),u.jsx("div",{id:"certificate-print-area",children:u.jsx(Za,{data:g})})]}),j&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full border border-white/10",children:["idle"===f&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"To'lovni tasdiqlash"}),u.jsxs("p",{className:"text-gray-300 mb-4",children:["Antiplagiat tekshiruvi uchun to'lov: ",u.jsxs("span",{className:"font-bold text-blue-400",children:[Ga.toLocaleString()," so'm"]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs(_a,{onClick:z,className:"flex-1",children:[u.jsx(ae,{className:"mr-2 h-4 w-4"}),"To'lovni Amalga Oshirish"]}),u.jsx(_a,{variant:"secondary",onClick:S,className:"flex-1",children:"Bekor qilish"})]})]}),"processing"===f&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===f&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-green-500 text-4xl mb-4",children:"✓"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx(_a,{onClick:()=>{S(),A(!0)},className:"w-full mt-6",children:"Tekshirishni Davom Ettirish"})]}),"failed"===f&&u.jsxs("div",{children:[u.jsx("div",{className:"text-red-500 text-4xl mb-4 text-center",children:"✗"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200 text-center",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto text-center mb-4",children:v}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(_a,{onClick:z,className:"flex-1",children:"Qayta Urinish"}),u.jsx(_a,{variant:"secondary",onClick:S,className:"flex-1",children:"Yopish"})]})]})]})})]})},es=[{title:"Maqola Namuna Olish",description:"Turli jurnallar uchun standart maqola namunalarini oling va ular asosida maqola yozing.",icon:te,link:"/maqola-namuna-olish",isAvailable:!0},{title:"Kitob Nashr Etish",description:"Tayyor qo'lyozmangizni professional kitob shaklida nashr eting va ISBN oling.",icon:ie,link:"/submit-book",isAvailable:!0},{title:"Antiplagiat Tekshiruvi",description:"Maqolangizning o'ziga xosligini tekshiring va muvofiqlik sertifikatiga ega bo'ling.",icon:le,link:"/plagiarism-check",isAvailable:!0},{title:"Ilmiy Tarjima",description:"Maqolalaringizni professional tarjimonlar yordamida ingliz va boshqa tillarga o'giring.",icon:m,link:"/translation-service",isAvailable:!0},{title:"UDK Olish",description:"Ilmiy ishingiz uchun Universal O'nli Klassifikatsiya kodini tez va oson oling.",icon:n,isAvailable:!1},{title:"Tahrirlash va Musahhihlik",description:"Matnning grammatik, uslubiy va imlo xatolarini mutaxassislar tomonidan tekshirtiring.",icon:re,isAvailable:!1},{title:"Adabiyotlarni Formatlash",description:"Manbalar ro'yxatini APA, MLA, Chicago kabi xalqaro standartlarga moslashtirish.",icon:l,isAvailable:!1},{title:"Ilmiy Illustratsiya",description:"Tadqiqotingiz uchun yuqori sifatli grafik, diagramma va jadvallar yaratish.",icon:D,isAvailable:!1},{title:"Dissertatsiyaga Yordam",description:"Dissertatsiya va ilmiy ishlarni yozishda professional maslahat va yo'l-yo'riqlar.",icon:ne,isAvailable:!1},{title:"Jurnal Tanlash Xizmati",description:"Sizning maqolangiz uchun eng mos bo'lgan jurnallarni topishga yordam beramiz.",icon:oe,isAvailable:!1},{title:"DOI Raqami Olish",description:"Maqolangiz uchun unikal raqamli obyekt identifikatorini (DOI) ro'yxatdan o'tkazish.",icon:C,isAvailable:!1},{title:"Taqdimot Tayyorlash",description:"Konferensiyalar uchun professional slaydlar va poster taqdimotlarini yaratish.",icon:de,isAvailable:!1},{title:"Grant Arizasini Yozish",description:"Ilmiy faoliyatingizni moliyalashtirish uchun grant arizalarini yozishda ko'mak.",icon:ce,isAvailable:!1},{title:"Taqrizchi Topish Xizmati",description:"Jurnal administratorlari uchun maqolalarga mos taqrizchilarni topish tizimi.",icon:me,isAvailable:!1}],as=({service:e})=>{const a=u.jsxs("div",{className:"h-full flex flex-col p-6 text-center transition-all duration-300 "+(e.isAvailable?"group-hover:bg-white/5":"opacity-50"),children:[e.isAvailable?u.jsx("div",{className:"absolute top-3 right-3 px-2 py-1 text-xs rounded-full bg-green-500/20 text-green-300",children:"Mavjud"}):u.jsxs("div",{className:"absolute top-3 right-3 flex items-center gap-1.5 px-2 py-1 text-xs rounded-full bg-yellow-500/20 text-yellow-300",children:[u.jsx(xe,{size:12}),u.jsx("span",{children:"Tez Kunda"})]}),u.jsx("div",{className:"flex-shrink-0 mb-4",children:u.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl flex items-center justify-center bg-gradient-to-br "+(e.isAvailable?"from-blue-500 to-cyan-400":"from-gray-700 to-gray-600"),children:u.jsx(e.icon,{className:"text-white",size:32})})}),u.jsxs("div",{className:"flex-grow",children:[u.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:e.title}),u.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:e.description})]}),e.isAvailable&&e.link&&u.jsx("div",{className:"mt-6",children:u.jsxs("span",{className:"font-semibold text-blue-400 flex items-center justify-center group-hover:text-blue-300",children:["Boshlash ",u.jsx(N,{className:"ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"})]})})]}),s="relative bg-black/20 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-lg h-full overflow-hidden";return e.isAvailable&&e.link?u.jsx(h,{to:e.link,className:"block group",children:u.jsx("div",{className:`${s} transition-all duration-300 hover:shadow-2xl hover:border-white/20`,children:a})}):u.jsx("div",{className:`${s} cursor-not-allowed`,children:a})},ss=()=>u.jsxs(ka,{title:"Xizmatlar Markazi",children:[u.jsx("p",{className:"text-center text-gray-300 mb-8 -mt-4 max-w-2xl mx-auto",children:"Tadqiqot va nashr jarayonlaringizni osonlashtirish uchun mo'ljallangan keng qamrovli xizmatlarimizdan foydalaning."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:es.map(e=>u.jsx(as,{service:e},e.title))})]}),ts=()=>{var a,s;const{user:t,logout:i}=ma(),[l,r]=e.useState(null),[n,o]=e.useState(!0),[d,c]=e.useState(null),[m,x]=e.useState(!1),[h,g]=e.useState({}),[p,j]=e.useState(!1);e.useEffect(()=>{(async()=>{if(t)try{o(!0),c(null);const e=await Ve.getProfile(),a=e.data||e;r(a),g({first_name:a.first_name,last_name:a.last_name,patronymic:a.patronymic||"",email:a.email,phone:a.phone,affiliation:a.affiliation,orcid_id:a.orcid_id||"",telegram_username:a.telegram_username||""})}catch(e){console.error("Failed to fetch profile:",e),c("Profil ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{o(!1)}})()},[t]);const b=e=>{const{name:a,value:s}=e.target;g(e=>({...e,[a]:s}))};return n?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):d?u.jsxs(ka,{title:"Error",children:[u.jsx("p",{className:"text-red-400",children:d}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Retry"})]}):l?u.jsxs("div",{className:"space-y-6",children:[u.jsx(ka,{title:"Profilim",children:u.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"relative",children:[l.avatar_url?u.jsx("img",{src:l.avatar_url,alt:"Avatar",className:"h-32 w-32 rounded-full object-cover border-4 border-white/10"}):u.jsx("div",{className:"h-32 w-32 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center border-4 border-white/10",children:u.jsx(q,{className:"h-16 w-16 text-white"})}),u.jsx("button",{className:"absolute bottom-2 right-2 p-2 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:u.jsx(Z,{className:"h-4 w-4 text-white"})})]}),u.jsxs("div",{className:"mt-4 text-center",children:[u.jsxs("h2",{className:"text-xl font-bold text-white",children:[l.first_name," ",l.last_name," ",l.patronymic]}),u.jsx("p",{className:"text-gray-400",children:{author:"Muallif",reviewer:"Taqrizchi",journal_admin:"Jurnal administratori",super_admin:"Bosh administrator",accountant:"Moliyachi"}[l.role]||l.role})]})]}),u.jsx("div",{className:"flex-1",children:m?u.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e=await Ve.updateProfile(h),a=e.data||e;r(a),x(!1),se.success("Profil muvaffaqiyatli yangilandi")}catch(a){console.error("Failed to update profile:",a),c("Profilni yangilashda xatolik yuz berdi."),se.error("Profilni yangilashda xatolik yuz berdi")}},className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism"}),u.jsx("input",{type:"text",name:"first_name",value:h.first_name,onChange:b,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya"}),u.jsx("input",{type:"text",name:"last_name",value:h.last_name,onChange:b,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Otasining ismi"}),u.jsx("input",{type:"text",name:"patronymic",value:h.patronymic,onChange:b,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon"}),u.jsxs("div",{className:"flex",children:[u.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-white/10 bg-white/5 text-gray-300",children:"+998"}),u.jsx("input",{type:"tel",name:"phone",value:null==(a=h.phone)?void 0:a.replace("+998",""),onChange:b,className:"flex-1 min-w-0 block w-full rounded-none rounded-r-md",required:!0})]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),u.jsx("input",{type:"email",name:"email",value:h.email,onChange:b,className:"w-full",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ish yoki o'qish joyi"}),u.jsx("input",{type:"text",name:"affiliation",value:h.affiliation,onChange:b,className:"w-full",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ORCID ID"}),u.jsx("input",{type:"text",name:"orcid_id",value:h.orcid_id,onChange:b,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telegram"}),u.jsxs("div",{className:"flex",children:[u.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-white/10 bg-white/5 text-gray-300",children:"@"}),u.jsx("input",{type:"text",name:"telegram_username",value:null==(s=h.telegram_username)?void 0:s.replace("@",""),onChange:b,className:"flex-1 min-w-0 block w-full rounded-none rounded-r-md"})]})]})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx(_a,{type:"submit",children:"Saqlash"}),u.jsx(_a,{type:"button",variant:"secondary",onClick:()=>x(!1),children:"Bekor qilish"})]})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(q,{className:"h-5 w-5 text-blue-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"To'liq ism"}),u.jsxs("p",{className:"text-white",children:[l.first_name," ",l.last_name," ",l.patronymic]})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(ue,{className:"h-5 w-5 text-green-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Email"}),u.jsx("p",{className:"text-white",children:l.email})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(he,{className:"h-5 w-5 text-purple-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Telefon"}),u.jsx("p",{className:"text-white",children:l.phone})]})]}),u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(ge,{className:"h-5 w-5 text-yellow-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Tashkilot"}),u.jsx("p",{className:"text-white",children:l.affiliation})]})]}),l.orcid_id&&u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx(pe,{className:"h-5 w-5 text-red-400 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"ORCID ID"}),u.jsx("p",{className:"text-white",children:l.orcid_id})]})]}),l.telegram_username&&u.jsxs("div",{className:"flex items-center p-3 bg-white/5 rounded-lg",children:[u.jsx("span",{className:"text-lg mr-3",children:"@"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Telegram"}),u.jsx("p",{className:"text-white",children:l.telegram_username})]})]})]}),u.jsx("div",{className:"pt-4",children:u.jsxs(_a,{onClick:()=>x(!0),children:[u.jsx(Z,{className:"mr-2 h-4 w-4"})," Tahrirlash"]})})]})})]})}),l.gamification_profile&&u.jsxs(ka,{title:"Gamifikatsiya",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-blue-500/20 mb-4",children:u.jsx(je,{className:"h-8 w-8 text-blue-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.level}),u.jsx("p",{className:"text-gray-400",children:"Daraja"})]}),u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-yellow-500/20 mb-4",children:u.jsx(je,{className:"h-8 w-8 text-yellow-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.points}),u.jsx("p",{className:"text-gray-400",children:"Ballar"})]}),u.jsxs("div",{className:"text-center p-6 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"inline-flex items-center justify-center p-3 rounded-full bg-purple-500/20 mb-4",children:u.jsx(je,{className:"h-8 w-8 text-purple-400"})}),u.jsx("h3",{className:"text-lg font-semibold text-white",children:l.gamification_profile.badges.length}),u.jsx("p",{className:"text-gray-400",children:"Mukofotlar"})]})]}),l.gamification_profile.badges.length>0&&u.jsxs("div",{className:"mt-6",children:[u.jsx("h4",{className:"text-md font-semibold text-white mb-3",children:"Mukofotlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:l.gamification_profile.badges.map((e,a)=>u.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-purple-500/20 to-pink-500/20 text-purple-300 rounded-full text-sm",children:e},a))})]})]}),u.jsx(ka,{title:"Hisobni boshqarish",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-medium text-blue-300 mb-2",children:"Test To'lov"}),u.jsx("p",{className:"text-xs text-gray-400 mb-3",children:"Click to'lov tizimini sinab ko'rish uchun 1000 so'm miqdorida test to'lovini amalga oshirish mumkin."}),d&&u.jsx("div",{className:"mb-3 p-2 bg-red-500/20 border border-red-500/30 rounded text-xs text-red-300",children:d}),u.jsxs(_a,{onClick:async()=>{var e;if(!p){j(!0),c(null);try{se.info("To'lov tayyorlanmoqda...",{autoClose:2e3});const a=await Wa.createTransactionAndPay(1e3,"UZS","top_up");if(a&&!0===a.success&&a.payment_url)se.success("To'lov sahifasiga yo'naltirilmoqdasiz...",{autoClose:2e3}),setTimeout(()=>{a.payment_url&&Wa.redirectToPayment(a.payment_url)},1500);else{let s="To'lovni amalga oshirishda xatolik yuz berdi";a&&(a.user_message?s=a.user_message:a.error_note?s=a.error_note:a.error?s=a.error:a.details&&(a.details.user_message?s=a.details.user_message:a.details.error_note?s=a.details.error_note:a.details.error&&(s=a.details.error)),a.payment_url||(s=-514===a.error_code||-514===(null==(e=a.details)?void 0:e.error_code)?"Sizning telefon raqamingiz Click tizimida ro'yxatdan o'tmagan. Iltimos, telefon raqamingizni Click tizimida ro'yxatdan o'tkazing va qayta urinib ko'ring.":-1!==a.error_code&&a.error_code?"To'lovni amalga oshirishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring.":"To'lov URL yaratib bo'lmadi. Iltimos, qayta urinib ko'ring yoki texnik yordamga murojaat qiling.")),console.error("Payment failed:",a),se.error(s,{autoClose:8e3}),c(s)}}catch(a){console.error("Test payment error:",a);let e="To'lovni amalga oshirishda xatolik yuz berdi";if(a.response){const s=a.response.data||a.response;e=s.error_note||s.error||s.detail||e}else a.message?e=a.message:"string"==typeof a&&(e=a);se.error(e,{autoClose:5e3}),c(e)}finally{j(!1)}}},disabled:p,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed w-full",children:[u.jsx(ae,{className:"mr-2 h-4 w-4"}),p?"Jarayonda...":"1000 so'm test to'lov"]}),p&&u.jsx("div",{className:"text-xs text-gray-400 text-center",children:"To'lov tayyorlanmoqda, iltimos kuting..."})]}),u.jsx("div",{className:"flex flex-col sm:flex-row gap-4 pt-4 border-t border-white/10",children:u.jsx(_a,{variant:"danger",onClick:i,children:"Chiqish"})})]})})]}):u.jsx(ka,{title:"Xatolik",children:u.jsx("p",{children:"Profil ma'lumotlari topilmadi."})})},is=({data:e})=>{const a=()=>u.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",className:"absolute inset-0 z-0",children:[u.jsx("defs",{children:u.jsxs("radialGradient",{id:"grad-bg-sub",children:[u.jsx("stop",{offset:"0%",stopColor:"#ffffff"}),u.jsx("stop",{offset:"100%",stopColor:"#f7f7f9"})]})}),u.jsx("rect",{width:"100%",height:"100%",fill:"url(#grad-bg-sub)"}),u.jsx("g",{transform:"translate(420 297) rotate(15) scale(2.5)",children:u.jsxs("svg",{width:"60",height:"60",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-[#3A527A]",opacity:"0.04",children:[u.jsx("path",{d:"M16.88,7.31c-2.39-2.39-6.26-2.39-8.65,0L12,11.06L16.88,7.31z",fill:"currentColor",opacity:"0.5"}),u.jsx("path",{d:"M11.06,12l-3.75,3.75c2.39,2.39,6.26,2.39,8.65,0l-4.9-4.9V12z",fill:"currentColor"}),u.jsx("path",{d:"M12,2C6.48,2,2,6.48,2,12s4.48,10,10,10c5.52,0,10-4.48,10-10S17.52,2,12,2z M12,20c-4.41,0-8-3.59-8-8s3.59-8,8-8s8,3.59,8,8S16.41,20,12,20z",fill:"currentColor"})]})})]});return u.jsxs("div",{className:"bg-white text-gray-800 aspect-[210/297] w-full max-w-4xl mx-auto shadow-2xl overflow-hidden relative font-sans p-2",children:[u.jsx(a,{}),u.jsx("div",{className:"absolute inset-4 border-2 border-[#3A527A] p-1",children:u.jsx("div",{className:"w-full h-full border border-[#3A527A]/50"})}),u.jsxs("div",{className:"relative z-10 flex flex-col h-full w-full px-20 py-16",children:[u.jsxs("header",{className:"flex flex-col items-center w-full pb-4",children:[u.jsx(za,{}),u.jsx("p",{className:"font-serif text-md text-slate-700 tracking-widest uppercase mt-2",children:"Phoenix Ilmiy Nashrlar Markazi"})]}),u.jsx("h1",{className:"font-serif text-5xl font-bold text-[#3A527A] tracking-wide my-8 text-center",children:"MA'LUMOTNOMA"}),u.jsxs("main",{className:"flex-grow text-base text-slate-800 leading-relaxed text-justify",children:[u.jsxs("p",{className:"mb-6",children:["Ushbu ma'lumotnoma ",u.jsx("strong",{className:"text-black",children:e.authorFullName}),"ga (",u.jsx("span",{className:"italic",children:e.authorAffiliation}),") uning ",u.jsxs("strong",{className:"text-black",children:['"',e.articleTitle,'"']})," nomli ilmiy maqolasi",u.jsxs("strong",{className:"text-black",children:[' "',e.journalName,'"']})," jurnaliga",u.jsxs("strong",{className:"text-black",children:[" ",e.submissionDate]})," sanasida topshirilganligini tasdiqlash uchun berildi."]}),u.jsxs("div",{className:"my-8 border-y border-gray-200 py-4 px-6 bg-gray-50/50 rounded-md",children:[u.jsx("h2",{className:"text-center font-semibold text-lg text-slate-700 mb-4",children:"Batafsil ma'lumotlar"}),u.jsxs("div",{className:"grid grid-cols-[max-content_1fr] gap-x-4 gap-y-2 text-sm",children:[u.jsx("strong",{className:"text-slate-600 text-right",children:"Maqola sarlavhasi:"}),u.jsx("span",{className:"text-slate-800",children:e.articleTitle}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Jurnal:"}),u.jsx("span",{className:"text-slate-800",children:e.journalName}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Topshirilgan sana:"}),u.jsx("span",{className:"text-slate-800",children:e.submissionDate}),u.jsx("strong",{className:"text-slate-600 text-right",children:"Joriy holati:"}),u.jsx("span",{className:"font-semibold text-blue-700",children:e.currentStatus})]})]}),u.jsx("p",{children:"Maqola tahririyat tomonidan qabul qilingan va belgilangan tartibda ko'rib chiqish jarayonida."})]}),u.jsxs("footer",{className:"flex justify-between items-end w-full pt-8 mt-auto",children:[u.jsxs("div",{className:"text-left text-xs text-slate-500",children:[u.jsxs("p",{children:["Ma'lumotnoma raqami: ",e.referenceNumber]}),u.jsxs("p",{children:["Berilgan sana: ",e.issueDate]})]}),u.jsx(Ca,{}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-48 h-12 mb-1"}),u.jsx("div",{className:"w-48 h-px bg-slate-600"}),u.jsx("p",{className:"text-sm font-semibold text-slate-800 mt-1",children:"Bosh Redaktor"}),u.jsx("p",{className:"text-xs text-slate-600",children:"PINM Tahririyati"})]})]})]})]})},ls=()=>{var s;const{id:t}=be(),{user:i}=ma(),r=a(),[n,d]=e.useState(null),[c,m]=e.useState(!0),[x,g]=e.useState(null),[p,j]=e.useState([]),[b,f]=e.useState(!1),[y,v]=e.useState(null),[N,k]=e.useState(!1);e.useEffect(()=>{(async()=>{if(t&&i)try{m(!0),g(null);const e=await aa.get(t),a=e.data||e;d(a);const s=Array.isArray(a.activity_logs)?a.activity_logs:[];j(s),v({referenceNumber:`REF-${a.id.substring(0,8).toUpperCase()}`,issueDate:(new Date).toISOString(),authorFullName:`${i.firstName} ${i.lastName}`,authorAffiliation:i.affiliation,articleTitle:a.title,journalName:a.journal_name||"Noma'lum jurnal",submissionDate:a.submission_date||(new Date).toISOString(),currentStatus:a.status_label||a.status,articleId:a.id})}catch(e){console.error("Failed to fetch article data:",e),g("Maqola ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[t,i]);const q=async(e,a)=>{if(t)try{await aa.updateStatus(t,e,a);const s=await aa.get(t),i=s.data||s;d(i)}catch(s){console.error("Failed to update article status:",s),g("Maqola holatini yangilashda xatolik yuz berdi.")}};if(c)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});if(!n)return u.jsxs(ka,{title:"Maqola topilmadi",children:[u.jsx("p",{children:"Ko'rsatilgan ID bo'yicha maqola topilmadi."}),u.jsx(_a,{onClick:()=>r("/articles"),className:"mt-4",children:"Orqaga qaytish"})]});const S=(z=n.status,{Draft:{text:"Yangi topshirildi",color:"bg-gray-500/20 text-gray-300",icon:l},Yangi:{text:"Yangi topshirildi",color:"bg-blue-500/20 text-blue-300",icon:w},WithEditor:{text:"Tekshiruvda",color:"bg-indigo-500/20 text-indigo-300",icon:Z},QabulQilingan:{text:"Ko'rib chiqilmoqda",color:"bg-yellow-500/20 text-yellow-300",icon:o},WritingInProgress:{text:"Tuzatish kiritilmoqda",color:"bg-cyan-500/20 text-cyan-300",icon:Z},NashrgaYuborilgan:{text:"Nashrga tayyorlanmoqda",color:"bg-purple-500/20 text-purple-300",icon:ve},Revision:{text:"To'ldirish talab qilinadi",color:"bg-orange-500/20 text-orange-300",icon:Z},Accepted:{text:"Qabul qilindi",color:"bg-teal-500/20 text-teal-300",icon:Q},Published:{text:"Nashr etildi",color:"bg-green-500/20 text-green-300",icon:U},Rejected:{text:"Jarayon to'xtatildi",color:"bg-red-500/20 text-red-300",icon:_}}[z]||{text:z,color:"bg-gray-500/20 text-gray-300",icon:l});var z;const C=S.icon,T=Array.isArray(n.workflow_steps)?n.workflow_steps:[],I=T.length>0?Math.round(T.filter(e=>e.done||e.current).length/T.length*100):0,M=Array.isArray(n.status_timeline)?n.status_timeline:[];return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[u.jsxs("div",{className:"min-w-0",children:[u.jsxs(h,{to:"/articles",className:"text-blue-400 hover:text-blue-300 flex items-center gap-2 mb-2 text-sm",children:[u.jsx("span",{children:"←"})," Maqolalar ro'yxati"]}),u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:n.title})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2 shrink-0",children:[u.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium flex items-center gap-2 ${S.color}`,children:[u.jsx(C,{size:16}),n.status_label||S.text]}),n.fast_track&&u.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-500/20 text-yellow-300 flex items-center gap-2",children:[u.jsx(je,{size:16}),"Tezkor"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[u.jsx(ka,{title:"Jarayon holati",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[u.jsxs("span",{className:"text-gray-300",children:["Joriy bosqich: ",n.workflow_stage||"Topshirildi"]}),u.jsxs("span",{className:"text-blue-300 font-semibold",children:[I,"%"]})]}),u.jsx("div",{className:"w-full bg-white/10 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${I}%`}})})]}),T.length>0&&u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-2 text-xs",children:T.map(e=>u.jsx("div",{className:"p-2 rounded text-center border "+(e.current?"border-blue-400 text-blue-300 bg-blue-500/10":e.done?"border-green-500/30 text-green-300 bg-green-500/10":"border-white/10 text-gray-400 bg-white/5"),children:e.name},e.name))}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h4",{className:"text-sm font-semibold text-white",children:"Status tarixi"}),M.length>0?M.map((e,a)=>u.jsxs("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10",children:[u.jsx("p",{className:"text-white font-medium",children:e.status}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:e.date?new Date(e.date).toLocaleString():"Sana yo'q"}),e.comment?u.jsxs("p",{className:"text-sm text-gray-300 mt-1",children:["Izoh: ",e.comment]}):null,e.responsible?u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Mas'ul: ",e.responsible]}):null]},`${e.status}-${e.date}-${a}`)):u.jsx("div",{className:"p-3 bg-white/5 rounded-lg border border-white/10 text-sm text-gray-400",children:"Status tarixi hali mavjud emas."})]})]})}),u.jsx(ka,{title:"Antiplagiat & AI Detektor",children:u.jsx(Ua,{plagiarismPercentage:n.plagiarism_percentage??0,aiContentPercentage:n.ai_content_percentage??0,checkedAt:n.plagiarism_checked_at||null,report:n.plagiarism_report||null})}),u.jsx(ka,{title:"Asosiy ma'lumotlar",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Muallif(lar)"}),u.jsx("p",{className:"text-white",children:n.author_name||"Noma'lum"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Annotatsiya"}),u.jsx("p",{className:"text-gray-300 leading-relaxed",children:n.abstract||"Annotatsiya mavjud emas"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-1",children:"Kalit so'zlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:(null==(s=n.keywords)?void 0:s.map((e,a)=>u.jsx("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-300 rounded-full text-sm",children:e},a)))||u.jsx("span",{className:"text-gray-400",children:"Kalit so'zlar mavjud emas"})})]})]})}),u.jsx(ka,{title:"Fayllar",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs(_a,{onClick:()=>{(null==n?void 0:n.file_url)&&(window.open(n.file_url,"_blank"),t&&aa.incrementViews(t).catch(e=>{console.error("Failed to increment view count:",e)}))},variant:"secondary",className:"flex items-center justify-center gap-2 flex-1",children:[u.jsx(A,{size:18})," Ko'rish"]}),u.jsxs(_a,{onClick:()=>{(null==n?void 0:n.file_url)&&(window.open(n.file_url,"_blank"),t&&aa.incrementDownloads(t).catch(e=>{console.error("Failed to increment download count:",e)}))},variant:"secondary",className:"flex items-center justify-center gap-2 flex-1",children:[u.jsx(fe,{size:18})," Yuklab olish"]}),n.file_url&&n.file_url.toLowerCase().endsWith(".pdf")&&u.jsxs(_a,{onClick:()=>k(!N),variant:"secondary",className:"flex items-center justify-center gap-2 flex-1",children:[u.jsx(l,{size:18})," ",N?"Yopish":"PDF ko'rish"]})]}),N&&n.file_url&&u.jsxs("div",{className:"rounded-xl overflow-hidden border border-white/10 bg-gray-900",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-white/5 border-b border-white/10",children:[u.jsx("span",{className:"text-sm text-gray-300 font-medium",children:"PDF ko'rinishi"}),u.jsx("button",{onClick:()=>k(!1),className:"text-gray-400 hover:text-white transition-colors",children:u.jsx(Y,{size:16})})]}),u.jsx("iframe",{src:n.file_url,className:"w-full border-0",style:{height:"70vh",minHeight:"400px"},title:"PDF Preview"})]})]})}),u.jsx(ka,{title:"Faoliyat jurnali",children:u.jsx("div",{className:"space-y-4",children:p.length>0?p.map(e=>u.jsxs("div",{className:"flex gap-3 sm:gap-4 p-3 sm:p-4 bg-white/5 rounded-lg",children:[u.jsx("div",{className:"flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-blue-500/20 flex items-center justify-center",children:u.jsx(ye,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-400"})}),u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx("span",{className:"font-medium text-white text-sm sm:text-base",children:e.action}),u.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.timestamp).toLocaleString()})]}),u.jsx("p",{className:"text-sm text-gray-300 mt-1",children:e.details||""}),e.userId&&u.jsxs("span",{className:"text-xs text-gray-500",children:["Foydalanuvchi ID: ",e.userId]})]})]},e.id)):u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Faoliyat jurnali hali mavjud emas."})})})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx(ka,{title:"Boshqaruv",children:u.jsxs("div",{className:"space-y-3",children:[(null==i?void 0:i.role)===ua.Author&&u.jsxs(_a,{onClick:()=>r(`/submit/${t}`),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(Z,{size:18})," Tahrirlash"]}),(null==i?void 0:i.role)===ua.JournalAdmin&&u.jsxs(u.Fragment,{children:[u.jsxs(_a,{onClick:()=>q(ha.Accepted),variant:"primary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(Q,{size:18})," Qabul qilish"]}),u.jsxs(_a,{onClick:()=>q(ha.Revision),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(Z,{size:18})," Tahrirga qaytarish"]}),u.jsxs(_a,{onClick:()=>q(ha.Rejected),variant:"danger",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(Y,{size:18})," Rad etish"]})]}),u.jsxs(_a,{onClick:()=>f(!0),variant:"secondary",className:"w-full flex items-center justify-center gap-2",children:[u.jsx(B,{size:18})," Sertifikat chop etish"]})]})}),u.jsx(ka,{title:"Statistika",children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Ko'rishlar"}),u.jsx("span",{className:"text-white font-medium",children:n.views||0})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Yuklab olishlar"}),u.jsx("span",{className:"text-white font-medium",children:n.downloads||0})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-400",children:"Yuborilgan sana"}),u.jsx("span",{className:"text-white font-medium",children:n.submission_date?new Date(n.submission_date).toLocaleDateString():"Noma'lum"})]})]})})]})]}),b&&y&&u.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-4xl bg-white rounded-lg shadow-2xl",children:[u.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[u.jsx("h3",{className:"text-lg font-semibold",children:"Yuborish sertifikati"}),u.jsx(_a,{onClick:()=>f(!1),variant:"secondary",children:"Yopish"})]}),u.jsx("div",{className:"p-4 max-h-[80vh] overflow-y-auto",children:u.jsx(is,{data:y})})]})})]})},rs=({children:e,title:a})=>u.jsxs("div",{className:"min-h-screen bg-transparent flex flex-col justify-center items-center p-4",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-5xl font-extrabold text-white drop-shadow-lg",children:"Phoenix Ilmiy Nashrlar Markazi"}),u.jsx("p",{className:"text-gray-300 mt-3 text-lg",children:"PINM Tizimiga Xush Kelibsiz"})]}),u.jsx("div",{className:"w-full max-w-md",children:e})]}),ns=()=>{const[s,t]=e.useState(""),[i,l]=e.useState(""),[r,n]=e.useState(!1),[o,d]=e.useState(""),[c,m]=e.useState(!1),{login:x,user:g}=ma(),p=a();e.useEffect(()=>{g&&p("/dashboard")},[g,p]);return u.jsx(rs,{title:"Tizimga kirish",children:u.jsxs(ka,{children:[u.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d(""),n(!0);try{if(!s||9!==s.length)return d("Iltimos, telefon raqamni to'liq kiriting (9 ta raqam, masalan: 901234567)"),void n(!1);const e=`998${s}`;if(!i||0===i.trim().length)return d("Iltimos, parolni kiriting."),void n(!1);await x(e,i)||d("Telefon raqam yoki parol xato.")}catch(a){const e=Ke(a);d(e)}finally{n(!1)}},className:"space-y-6",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Tizimga kirish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Telefon raqam va parol bilan kirish"})]}),o&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded-lg text-sm text-red-300",children:o}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon raqam"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"px-3 py-3 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 font-medium whitespace-nowrap",children:"+998"}),u.jsx("input",{type:"tel",name:"phone",id:"phone",value:s,onChange:e=>{const a=(e=>{let a=e.replace(/\D/g,"");return a.startsWith("998")&&(a=a.substring(3)),a.substring(0,9)})(e.target.value);t(a)},className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"90 123 45 67",required:!0,maxLength:12})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Faqat raqam kiriting"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{id:"password",name:"password",type:c?"text":"password",value:i,onChange:e=>l(e.target.value),autoComplete:"current-password",required:!0,className:"w-full p-3 pr-10 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"Parolingizni kiriting"}),u.jsx("button",{type:"button",onClick:()=>m(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:c?u.jsx(Ne,{size:20}):u.jsx(A,{size:20})})]})]}),u.jsx("div",{className:"flex items-center justify-between",children:u.jsx(h,{to:"/forgot-password",className:"text-sm text-blue-400 hover:text-blue-300",children:"Parolni unutdingizmi?"})}),u.jsx(_a,{type:"submit",className:"w-full flex items-center justify-center gap-2",disabled:r,children:r?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Kirish amalga oshirilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(we,{size:18}),"Tizimga kirish"]})})]}),u.jsx("div",{className:"mt-6 text-center text-sm",children:u.jsxs("p",{className:"text-gray-400",children:["Hisobingiz yo'qmi?"," ",u.jsx(h,{to:"/register",className:"font-semibold text-blue-400 hover:text-blue-300",children:"Ro'yxatdan o'tish"})]})})]})})},os=()=>{const s=a(),{user:t,login:i}=ma(),[l,r]=e.useState(1),[n,o]=e.useState(""),[d,c]=e.useState(""),[m,x]=e.useState(""),[g,p]=e.useState(""),[j,b]=e.useState(""),[f,y]=e.useState(""),[v,w]=e.useState(""),[k,_]=e.useState(!1),[q,S]=e.useState(""),[z,C]=e.useState(!1);e.useEffect(()=>{t&&s("/dashboard")},[t,s]);return u.jsx(rs,{title:"Yangi Hisob Yaratish",children:u.jsxs(ka,{children:[1===l?u.jsxs("form",{onSubmit:e=>{e.preventDefault(),S(""),n&&9===n.length?d.trim()?m.trim()?!g||g.length<6?S("Parol kamida 6 ta belgidan iborat bo'lishi kerak"):g===j?r(2):S("Parollar mos kelmayapti"):S("Iltimos, familiyangizni kiriting"):S("Iltimos, ismingizni kiriting"):S("Iltimos, telefon raqamni to'liq kiriting (9 ta raqam, masalan: 901234567)")},className:"space-y-4",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Ro'yxatdan o'tish"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Asosiy ma'lumotlarni kiriting"})]}),q&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded text-sm text-red-300",children:q}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Telefon raqam *"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"px-3 py-3 bg-gray-700 border border-gray-600 rounded-lg text-gray-300 font-medium whitespace-nowrap",children:"+998"}),u.jsx("input",{type:"tel",value:n,onChange:e=>{const a=(e=>{let a=e.replace(/\D/g,"");return a.startsWith("998")&&(a=a.substring(3)),a.substring(0,9)})(e.target.value);o(a)},className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",placeholder:"90 123 45 67",required:!0,maxLength:12})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Faqat raqam kiriting (masalan: 901234567)"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ism *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:d,onChange:e=>c(e.target.value),placeholder:"Ismingiz"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Familiya *"}),u.jsx("input",{type:"text",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:m,onChange:e=>x(e.target.value),placeholder:"Familiyangiz"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parol *"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:z?"text":"password",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500 pr-10",value:g,onChange:e=>p(e.target.value),placeholder:"Kamida 6 ta belgi",minLength:6}),u.jsx("button",{type:"button",onClick:()=>C(!z),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:z?"👁️":"👁️‍🗨️"})]}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Kamida 6 ta belgi (har qanday belgilar)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Parolni tasdiqlang *"}),u.jsx("input",{type:z?"text":"password",required:!0,className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:j,onChange:e=>b(e.target.value),placeholder:"Parolni qayta kiriting",minLength:6})]}),u.jsxs(_a,{type:"submit",className:"w-full flex items-center justify-center gap-2",children:["Keyingi bosqich",u.jsx(N,{className:"h-4 w-4"})]})]}):u.jsxs("form",{onSubmit:async e=>{e.preventDefault(),S(""),_(!0);try{const e=n.startsWith("998")?n:`998${n}`,t={phone:e,email:f.trim()||`${e}@temp.phoenix.uz`,first_name:d.trim(),last_name:m.trim(),affiliation:v.trim()||"N/A",password:g,password_confirm:j},l=await Ve.register(t);if(!l.access||!l.user)throw new Error("Ro'yxatdan o'tishda xatolik yuz berdi.");se.success("Muvaffaqiyatli ro'yxatdan o'tdingiz!",{autoClose:2e3});try{const a=await i(e,g);s(a?"/dashboard":"/login")}catch(a){console.error("Auto login failed:",a),s("/login")}}catch(t){const e=Qe(t,"phone"),a=Qe(t,"email"),s=Qe(t,"password");let i="Ro'yxatdan o'tishda xatolik yuz berdi.";i=e?`Telefon raqam: ${e}`:a?`Email: ${a}`:s?`Parol: ${s}`:Ke(t),S(i),se.error(i,{autoClose:5e3})}finally{_(!1)}},className:"space-y-4",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsxs("button",{type:"button",onClick:()=>r(1),className:"text-gray-400 hover:text-white mb-4 flex items-center gap-2 mx-auto",children:[u.jsx(ke,{className:"h-4 w-4"}),"Orqaga"]}),u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Qo'shimcha ma'lumotlar"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Bu maydonlar ixtiyoriy"})]}),q&&u.jsx("div",{className:"p-3 bg-red-500/20 border border-red-500/30 rounded text-sm text-red-300",children:q}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Email ",u.jsx("span",{className:"text-gray-500 text-xs",children:"(ixtiyoriy)"})]}),u.jsx("input",{type:"email",className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:f,onChange:e=>y(e.target.value),placeholder:"email@example.com"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Bo'sh qoldirish mumkin"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Ish yoki o'qish joyi ",u.jsx("span",{className:"text-gray-500 text-xs",children:"(ixtiyoriy)"})]}),u.jsx("input",{type:"text",className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",value:v,onChange:e=>w(e.target.value),placeholder:"Tashkilot nomi..."}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Bo'sh qoldirish mumkin"})]}),u.jsx(_a,{type:"submit",className:"w-full flex items-center justify-center gap-2",disabled:k,children:k?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Ro'yxatdan o'tilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(_e,{className:"h-4 w-4"}),"Ro'yxatdan o'tish"]})})]}),u.jsx("div",{className:"mt-6 text-center text-sm",children:u.jsxs("p",{className:"text-gray-400",children:["Hisobingiz bormi?"," ",u.jsx(h,{to:"/login",className:"font-semibold text-blue-400 hover:text-blue-300",children:"Kirish"})]})})]})})},ds=()=>{const[s]=qe(),t=a(),i=s.get("transaction_id"),[l,r]=e.useState(!1),[n,d]=e.useState(null),[c,m]=e.useState(""),[x,h]=e.useState("idle");e.useEffect(()=>{i?g():m("Transaction ID topilmadi")},[i]),e.useEffect(()=>{if(n&&"success"===x){const e=setTimeout(()=>{window.location.href=n},2e3);return()=>clearTimeout(e)}},[n,x]);const g=async()=>{if(i){r(!0),m("");try{const e=await ta.processPayment(i,"click");e.success&&e.payment_url?(d(e.payment_url),h("success")):(m(e.error||e.error_note||"To'lov URL olinmadi"),h("error"))}catch(e){m(e.message||"To'lov URL yuklashda xatolik"),h("error")}finally{r(!1)}}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-gray-900 flex items-center justify-center p-4",children:u.jsxs(ka,{className:"max-w-md w-full",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx(ae,{className:"h-16 w-16 mx-auto mb-4 text-blue-400"}),u.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Click To'lov"}),u.jsx("p",{className:"text-gray-400",children:"To'lovni amalga oshirish uchun tugmani bosing"})]}),l&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Se,{className:"h-12 w-12 mx-auto animate-spin text-blue-400 mb-4"}),u.jsx("p",{className:"text-gray-400",children:"To'lov sahifasi tayyorlanmoqda..."})]}),c&&u.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/30 rounded-lg mb-4",children:u.jsxs("div",{className:"flex items-center gap-2 text-red-300",children:[u.jsx(_,{className:"h-5 w-5"}),u.jsx("p",{children:c})]})}),"success"===x&&n&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"p-4 bg-green-500/20 border border-green-500/30 rounded-lg",children:[u.jsxs("div",{className:"flex items-center gap-2 text-green-300 mb-2",children:[u.jsx(o,{className:"h-5 w-5"}),u.jsx("p",{className:"font-semibold",children:"To'lov sahifasi tayyor!"})]}),u.jsx("p",{className:"text-sm text-gray-400",children:"Quyidagi tugmani bosib, Click to'lov sahifasiga o'ting va karta ma'lumotlarini kiriting."})]}),u.jsxs(_a,{onClick:()=>{n&&(window.location.href=n)},className:"w-full flex items-center justify-center gap-2",children:[u.jsx(ae,{className:"h-5 w-5"}),"To'lovni Amalga Oshirish"]}),u.jsx("div",{className:"text-sm text-gray-400 text-center p-3 bg-gray-800/50 rounded-lg",children:u.jsx("p",{children:"ℹ️ Click to'lov sahifasida karta raqami va muddatini kiriting"})}),u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:()=>t("/dashboard"),className:"text-sm text-gray-400 hover:text-white",children:"Orqaga qaytish"})})]}),"error"===x&&u.jsxs("div",{className:"space-y-4",children:[u.jsx(_a,{onClick:g,className:"w-full",children:"Qayta Urinib Ko'rish"}),u.jsx("div",{className:"text-center",children:u.jsx("button",{onClick:()=>t("/dashboard"),className:"text-sm text-gray-400 hover:text-white",children:"Orqaga qaytish"})})]})]})})},cs=()=>{var a,s;const{user:t}=ma(),[i,l]=e.useState([]),[r,n]=e.useState([]),[o,d]=e.useState([]),[c,m]=e.useState(!0),[x,h]=e.useState(null),[g,p]=e.useState("all"),[j,b]=e.useState(!1),[f,y]=e.useState(!1),[v,N]=e.useState(""),[w,k]=e.useState(null),[_,q]=e.useState(null),S={name:"",issn:"",description:"",journalAdminId:"",categoryId:"",publicationFee:0,pricePerPage:0,imageUrl:"",paymentModel:pa.PostPayment,pricingType:ja.Fixed,additionalDocumentConfig:{required:!1,label:"Taqriz fayli",type:"file"}},[z,C]=e.useState(S),[A,T]=e.useState(null);e.useEffect(()=>{(async()=>{if(t&&t.role===ua.SuperAdmin)try{m(!0),h(null);const[e,a,s]=await Promise.all([sa.list(),sa.listCategories(),ea.list()]),t=e=>Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],i=t(e),r=t(a),o=t(s);l(i),n(r),d(o)}catch(e){console.error("Failed to fetch data:",e),h("Ma'lumotlarni yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[t]);const I=o.filter(e=>e.role===ua.JournalAdmin||e.role===ua.Reviewer||"journal_admin"===e.role||"reviewer"===e.role);if((null==t?void 0:t.role)!==ua.SuperAdmin)return u.jsx(ka,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(c)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const M=(e=null)=>{if(e){k(e);const a={...e,journalAdminId:e.journalAdminId||e.journal_admin,categoryId:e.categoryId||e.category,paymentModel:e.paymentModel||e.payment_model,pricingType:e.pricingType||e.pricing_type,publicationFee:void 0!==e.publicationFee?e.publicationFee:e.publication_fee,pricePerPage:void 0!==e.pricePerPage?e.pricePerPage:e.price_per_page,additionalDocumentConfig:e.additionalDocumentConfig||S.additionalDocumentConfig};C(a)}else k(null),C(S);b(!0)},P=()=>{b(!1),y(!1),N(""),k(null),q(null),T(null),C(e=>({...e,imageUrl:""}))},F=e=>{const{name:a,value:s}=e.target;C(e=>({...e,[a]:s}))},D=e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0];T(a);const s=new FileReader;s.onloadend=()=>{C(e=>({...e,imageUrl:s.result}))},s.readAsDataURL(a)}},O=e=>{const{name:a,value:s,type:t}=e.target,i="checkbox"===t,l=e.target.checked;C(e=>({...e,additionalDocumentConfig:{...e.additionalDocumentConfig,[a]:i?l:s}}))},$=e=>e.categoryId||e.category||"uncategorized",E=("all"===g?i:i.filter(e=>$(e)===g)).reduce((e,a)=>{const s=$(a);return e[s]||(e[s]=[]),e[s].push(a),e},{}),R=Object.keys(E).sort((e,a)=>{var s,t;if("uncategorized"===e)return 1;if("uncategorized"===a)return-1;const i=(null==(s=r.find(a=>a.id===e))?void 0:s.name)||"",l=(null==(t=r.find(e=>e.id===a))?void 0:t.name)||"";return i.localeCompare(l)});return u.jsxs(u.Fragment,{children:[u.jsxs(ka,{title:"Jurnallarni Boshqarish",children:[u.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("label",{className:"text-sm text-gray-300",children:"Kategoriya bo'yicha:"}),u.jsxs("select",{value:g,onChange:e=>p(e.target.value),className:"min-w-[220px]",children:[u.jsx("option",{value:"all",children:"Barcha kategoriyalar"}),r.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]}),u.jsxs(_a,{onClick:()=>M(),children:[u.jsx(ze,{className:"mr-2 h-4 w-4"})," Yangi Jurnal Qo'shish"]})]}),u.jsxs("div",{className:"space-y-4",children:[0===R.length&&u.jsx("div",{className:"p-6 rounded-lg bg-white/5 text-center text-gray-400",children:"Tanlangan kategoriya bo'yicha jurnal topilmadi."}),R.map(e=>{var a;const s="uncategorized"===e?"Kategoriyasiz":(null==(a=r.find(a=>a.id===e))?void 0:a.name)||"Noma'lum kategoriya";return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h4",{className:"text-sm font-semibold uppercase tracking-wide text-blue-300",children:s}),u.jsxs("span",{className:"text-xs text-gray-400",children:[E[e].length," ta jurnal"]})]}),E[e].map(e=>{const a=e.journalAdminId||e.journal_admin,s=e.categoryId||e.category,t=e.pricingType||e.pricing_type,i=void 0!==e.publicationFee?e.publicationFee:e.publication_fee,l=void 0!==e.pricePerPage?e.pricePerPage:e.price_per_page,n=o.find(e=>e.id===a),d=r.find(e=>e.id===s),c=t===ja.Fixed?`${(i||0).toLocaleString()} so'm`:`${(l||0).toLocaleString()} so'm / sahifa`,m=e.imageUrl||e.image_url;return u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg flex flex-col sm:flex-row justify-between sm:items-center",children:[u.jsxs("div",{className:"flex items-start gap-4",children:[m&&u.jsx("img",{src:m,alt:"Jurnal rasmi",className:"h-16 w-16 rounded-lg object-cover flex-shrink-0",onError:e=>{e.target.style.display="none"}}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-lg text-white",children:e.name}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Admin: ",n?`${n.firstName||n.first_name} ${n.lastName||n.last_name}`:"Tayinlanmagan",u.jsx("span",{className:"mx-2 text-gray-600",children:"•"}),"Kategoriya: ",u.jsx("span",{className:"font-medium text-blue-300",children:(null==d?void 0:d.name)||"Noma'lum"}),u.jsx("span",{className:"mx-2 text-gray-600",children:"•"}),"Narx: ",u.jsx("span",{className:"font-medium text-green-400",children:c})]}),u.jsxs("p",{className:"text-xs text-gray-500 font-mono mt-1",children:["ISSN: ",e.issn]})]})]}),u.jsxs("div",{className:"flex items-center space-x-2 mt-3 sm:mt-0",children:[u.jsx("button",{onClick:()=>M(e),className:"text-indigo-400 hover:text-indigo-200 p-2 rounded-md hover:bg-white/10 transition-colors","aria-label":"Tahrirlash",children:u.jsx(Z,{size:18})}),u.jsx("button",{onClick:()=>{q(e)},className:"text-red-400 hover:text-red-200 p-2 rounded-md hover:bg-white/10 transition-colors","aria-label":"O'chirish",children:u.jsx(W,{size:18})})]})]},e.id)})]},e)})]})]}),j&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(ka,{className:"w-full max-w-2xl",title:w?"Jurnalni Tahrirlash":"Yangi Jurnal Qo'shish",children:[w&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"Jurnal Rasmi"}),w.imageUrl||w.image_url?u.jsx("img",{src:w.imageUrl||w.image_url,alt:"Jurnal rasmi",className:"h-32 w-32 rounded-lg object-cover",onError:e=>{e.target.style.display="none"}}):u.jsx("p",{className:"text-gray-400 text-sm",children:"Rasm mavjud emas"})]}),u.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),z.name&&z.categoryId&&z.journalAdminId)try{if(w){const e={name:z.name,issn:z.issn||"",description:z.description||"",journal_admin:z.journalAdminId,category:z.categoryId,payment_model:z.paymentModel||pa.PostPayment,pricing_type:z.pricingType||ja.Fixed,publication_fee:Number(z.publicationFee)||0,price_per_page:Number(z.pricePerPage)||0};z.additionalDocumentConfig&&(e.additional_document_config={required:Boolean(z.additionalDocumentConfig.required),label:z.additionalDocumentConfig.label||"Taqriz fayli",type:z.additionalDocumentConfig.type||"file"});const a=await sa.update(w.id,e,A||void 0),s=i.map(e=>e.id===w.id?a:e);l(s)}else{const e={name:z.name,issn:z.issn||"",description:z.description||"",journal_admin:z.journalAdminId,category:z.categoryId,payment_model:z.paymentModel||pa.PostPayment,pricing_type:z.pricingType||ja.Fixed,publication_fee:Number(z.publicationFee)||0,price_per_page:Number(z.pricePerPage)||0};z.additionalDocumentConfig&&(e.additional_document_config={required:Boolean(z.additionalDocumentConfig.required),label:z.additionalDocumentConfig.label||"Taqriz fayli",type:z.additionalDocumentConfig.type||"file"});const a=await sa.create(e,A||void 0);l(e=>[a,...e])}T(null),P()}catch(a){console.error("Failed to save journal:",a);let e="Jurnalni saqlashda xatolik yuz berdi";a.message?e+=`: ${a.message}`:"string"==typeof a?e+=`: ${a}`:a.detail?e+=`: ${a.detail}`:a.error&&(e+=`: ${a.error}`),alert(e)}else alert("Iltimos, Jurnal Nomi, Kategoriyasi va Admini maydonlarini to'ldiring.")},className:"space-y-4 max-h-[80vh] overflow-y-auto pr-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Nomi"}),u.jsx("input",{type:"text",name:"name",value:z.name,onChange:F,className:"w-full",placeholder:"Jurnal nomini kiriting...",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Kategoriyasi"}),f?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"text",value:v,onChange:e=>N(e.target.value),className:"w-full",placeholder:"Yangi kategoriya nomi",autoFocus:!0}),u.jsx(_a,{type:"button",onClick:async()=>{if(v.trim())try{const e={name:v.trim()},a=await sa.createCategory(e);n(e=>[...e,a]),C(e=>({...e,categoryId:a.id})),N(""),y(!1)}catch(e){console.error("Failed to add category:",e),alert(`Kategoriya qo'shishda xatolik yuz berdi: ${e.message||"Unknown error"}`)}else alert("Kategoriya nomini kiriting.")},className:"!p-3 !rounded-lg",children:u.jsx(Q,{size:20})}),u.jsx(_a,{type:"button",variant:"secondary",onClick:()=>y(!1),className:"!p-3 !rounded-lg",children:u.jsx(Y,{size:20})})]}):u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{name:"categoryId",value:z.categoryId,onChange:F,className:"w-full",required:!0,children:[u.jsx("option",{value:"",disabled:!0,children:"Kategoriyani tanlang"}),r.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]}),u.jsx(_a,{type:"button",onClick:()=>y(!0),className:"!p-2.5 !rounded-lg",title:"Yangi kategoriya qo'shish",children:u.jsx(ze,{size:18})}),z.categoryId&&u.jsx(_a,{type:"button",variant:"danger",onClick:()=>(async e=>{if(i.some(a=>(a.categoryId||a.category)===e))alert("Ushbu kategoriya jurnallar tomonidan ishlatilmoqda va o'chirib bo'lmaydi.");else if(window.confirm("Haqiqatan ham ushbu kategoriyani o'chirmoqchimisiz?"))try{await sa.deleteCategory(e),n(a=>a.filter(a=>a.id!==e)),z.categoryId===e&&C(e=>({...e,categoryId:""}))}catch(a){console.error("Failed to delete category:",a),alert(`Kategoriyani o'chirishda xatolik yuz berdi: ${a.message||"Unknown error"}`)}})(z.categoryId),className:"!p-2.5 !rounded-lg",title:"Tanlangan kategoriyani o'chirish",children:u.jsx(W,{size:18})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Admini"}),u.jsxs("select",{name:"journalAdminId",value:z.journalAdminId,onChange:F,className:"w-full",required:!0,children:[u.jsx("option",{value:"",disabled:!0,children:"Adminni tanlang"}),I.map(e=>u.jsxs("option",{value:e.id,children:[e.firstName||e.first_name," ",e.lastName||e.last_name]},e.id))]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Narx Turi"}),u.jsxs("select",{name:"pricingType",value:z.pricingType,onChange:F,className:"w-full",children:[u.jsx("option",{value:ja.Fixed,children:"Qat'iy narx"}),u.jsx("option",{value:ja.PerPage,children:"Sahifa uchun"})]})]}),z.pricingType===ja.Fixed?u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Chop etish narxi (so'm)"}),u.jsx("input",{type:"number",name:"publicationFee",value:z.publicationFee||"",onChange:F,className:"w-full",placeholder:"200000"})]}):u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sahifa narxi (so'm)"}),u.jsx("input",{type:"number",name:"pricePerPage",value:z.pricePerPage||"",onChange:F,className:"w-full",placeholder:"15000"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ISSN"}),u.jsx("input",{type:"text",name:"issn",value:z.issn,onChange:F,className:"w-full",placeholder:"XXXX-XXXX"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'lov Turi"}),u.jsxs("select",{name:"paymentModel",value:z.paymentModel,onChange:F,className:"w-full",children:[u.jsx("option",{value:pa.PrePayment,children:"Maqola qabul qilinishidan oldin"}),u.jsx("option",{value:pa.PostPayment,children:"Maqola qabul qilinganidan so'ng"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Jurnal Rasmi"}),z.imageUrl?u.jsxs("div",{className:"mt-2 flex items-center gap-4",children:[u.jsx("img",{src:z.imageUrl,alt:"Jurnal rasmi",className:"h-24 w-48 rounded-lg object-cover"}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"journal-image-upload",className:"cursor-pointer bg-white/10 rounded-md py-2 px-3 text-sm font-medium text-blue-300 hover:text-blue-400 hover:bg-white/20",children:"O'zgartirish"}),u.jsx("input",{id:"journal-image-upload",name:"journal-image-upload",type:"file",className:"sr-only",accept:"image/png, image/jpeg",onChange:D}),u.jsx("button",{type:"button",onClick:()=>C(e=>({...e,imageUrl:""})),className:"ml-3 text-red-400 hover:text-red-300 text-sm",children:"O'chirish"})]})]}):u.jsx("div",{className:"mt-2",children:u.jsxs("label",{htmlFor:"journal-image-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(K,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Rasm yuklang (JPG, PNG)"})]}),u.jsx("input",{id:"journal-image-upload",name:"journal-image-upload",type:"file",className:"sr-only",accept:"image/png, image/jpeg",onChange:D})]})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tavsif"}),u.jsx("textarea",{name:"description",value:z.description,onChange:F,className:"w-full",rows:3,placeholder:"Jurnal haqida qisqacha ma'lumot..."})]}),u.jsxs("div",{className:"pt-4 border-t border-white/10",children:[u.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[u.jsx("input",{type:"checkbox",name:"required",checked:null==(a=z.additionalDocumentConfig)?void 0:a.required,onChange:O,className:"h-5 w-5 rounded bg-white/10 border-white/20 text-blue-500 focus:ring-blue-500",style:{boxShadow:"none"}}),u.jsx("span",{className:"font-medium text-gray-200",children:"Qo'shimcha hujjat talab qilish (masalan, taqriz)"})]}),(null==(s=z.additionalDocumentConfig)?void 0:s.required)&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 pl-8",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjat Nomi"}),u.jsx("input",{type:"text",name:"label",value:z.additionalDocumentConfig.label,onChange:O,className:"w-full",placeholder:"Taqriz fayli"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjat Turi"}),u.jsxs("select",{name:"type",value:z.additionalDocumentConfig.type,onChange:O,className:"w-full",children:[u.jsx("option",{value:"file",children:"Fayl yuklash"}),u.jsx("option",{value:"link",children:"Havola kiritish"})]})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t border-white/10 mt-6",children:[u.jsx(_a,{type:"button",variant:"secondary",onClick:P,children:"Bekor qilish"}),u.jsx(_a,{type:"submit",children:w?"Saqlash":"Qo'shish"})]})]})]})}),_&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(ka,{className:"w-full max-w-md",title:"O'chirishni tasdiqlang",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[_.imageUrl||_.image_url?u.jsx("img",{src:_.imageUrl||_.image_url,alt:"Jurnal rasmi",className:"h-16 w-16 rounded-lg object-cover",onError:e=>{e.target.style.display="none"}}):null,u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-medium text-white",children:_.name}),u.jsx("p",{className:"text-gray-400 text-sm",children:"Jurnalni o'chirish"})]})]}),u.jsxs("p",{className:"text-gray-300 mb-6",children:["Haqiqatan ham ",u.jsx("strong",{className:"text-white",children:_.name})," jurnalini o'chirmoqchimisiz? Bu harakatni bekor qilib bo'lmaydi."]}),u.jsxs("div",{className:"flex justify-end gap-4 mt-8",children:[u.jsx(_a,{variant:"secondary",onClick:()=>q(null),children:"Bekor qilish"}),u.jsx(_a,{variant:"danger",onClick:async()=>{if(_)try{await sa.delete(_.id),l(e=>e.filter(e=>e.id!==_.id)),q(null)}catch(e){console.error("Failed to delete journal:",e),alert(`Jurnalni o'chirishda xatolik yuz berdi: ${e.message||"Unknown error"}`)}},children:"O'chirish"})]})]})})]})},ms=["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avgust","Sentyabr","Oktyabr","Noyabr","Dekabr"],xs=(new Date).getFullYear(),us=Array.from({length:10},(e,a)=>xs-a),hs=()=>{const{user:a}=ma(),{addNotification:s}=xa(),[t,i]=e.useState([]),[l,r]=e.useState([]),[n,o]=e.useState([]),[d,c]=e.useState(!0),[m,x]=e.useState(null),[h,g]=e.useState([]),[p,j]=e.useState(""),[b,f]=e.useState(xs),[y,v]=e.useState((new Date).getMonth()),[N,w]=e.useState(""),[k,_]=e.useState(null),[q,S]=e.useState(null),z=e.useMemo(()=>(null==a?void 0:a.role)!==ua.JournalAdmin?[]:l.filter(e=>e.journal_admin===a.id),[a,l]);e.useEffect(()=>{z.length>0&&!p&&j(z[0].id)},[z,p]),e.useEffect(()=>{(async()=>{if(a&&a.role===ua.JournalAdmin){c(!0),x(null);try{const[e,a,s,t]=await Promise.all([sa.listIssues(),sa.list(),aa.list(),ea.list()]);i(e.results||e),r(a.results||a),o(s.results||s),g(t.results||t)}catch(e){console.error("Failed to fetch data:",e),x("Ma'lumotlarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{c(!1)}}})()},[a]);const C=e.useMemo(()=>t.find(e=>e.journalId===p&&new Date(e.publicationDate).getFullYear()===b&&new Date(e.publicationDate).getMonth()===y),[t,p,b,y]),A=e.useMemo(()=>n.filter(e=>e.journal===p&&("Published"===e.status||"published"===e.status)&&new Date(e.submission_date).getFullYear()===b&&new Date(e.submission_date).getMonth()===y),[p,b,y,n]),T=async e=>{const a=(e=>`${window.location.origin}${window.location.pathname}#/public/article/${e}`)(e);try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("Clipboard API not available");await navigator.clipboard.writeText(a),S(e),setTimeout(()=>S(null),2e3)}catch(s){window.prompt("Havolani nusxalang:",a)}};if(!a||a.role!==ua.JournalAdmin)return u.jsx(ka,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(d)return u.jsx(ka,{title:"Oylik Sonlar va Arxiv",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(H,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})});if(m)return u.jsx(ka,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:m}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})});return u.jsxs(ka,{title:"Oylik Sonlar va Arxiv",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda jurnallaringiz uchun oylik to'plamlarni boshqarishingiz mumkin."}),u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg mb-6 flex flex-col md:flex-row gap-4",children:[z.length>1&&u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Jurnal"}),u.jsx("select",{value:p,onChange:e=>j(e.target.value),className:"w-full",disabled:d,children:z.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Yil"}),u.jsx("select",{value:b,onChange:e=>f(parseInt(e.target.value)),className:"w-full",disabled:d,children:us.map(e=>u.jsx("option",{value:e,children:e},e))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-sm",children:"Oy"}),u.jsx("select",{value:y,onChange:e=>v(parseInt(e.target.value)),className:"w-full",disabled:d,children:ms.map((e,a)=>u.jsx("option",{value:a,children:e},e))})]})]}),C?u.jsxs("div",{className:"p-6 bg-green-500/10 border border-green-500/20 rounded-lg text-center",children:[u.jsxs("h3",{className:"text-xl font-bold text-green-300",children:[ms[y]," ",b," soni allaqachon yaratilgan."]}),u.jsx("p",{className:"text-green-400/80 mt-2",children:"Ma'lumotlarni yangilash uchun quyidagi formadan foydalanishingiz mumkin."})]}):null,u.jsxs("div",{className:"mt-6 space-y-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-white",children:C?"Ma'lumotlarni Yangilash":"Yangi Son Yaratish"}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Tanlangan oy uchun ",u.jsx("strong",{className:"text-white",children:Array.isArray(A)?A.length:0})," ta nashr etilgan maqola mavjud."]}),u.jsx("div",{className:"space-y-3",children:Array.isArray(A)&&A.length>0?A.map(e=>u.jsxs("div",{className:"p-4 bg-white/5 border border-white/10 rounded-lg flex flex-col md:flex-row md:items-center md:justify-between gap-3",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"text-white font-medium",children:e.title}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.submission_date).toLocaleDateString()})]}),u.jsxs(_a,{onClick:()=>T(e.id),variant:"secondary",className:"w-full md:w-auto",children:[u.jsx(Ce,{className:"mr-2 h-4 w-4"}),q===e.id?"Havola nusxalandi":"Maqolani ulashish"]})]},e.id)):u.jsx("div",{className:"p-4 bg-white/5 border border-white/10 rounded-lg text-sm text-gray-400",children:"Tanlangan oy uchun nashr etilgan maqolalar topilmadi."})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'plam fayli (DOC/DOCX/PDF)"}),u.jsxs("label",{htmlFor:"collection-pdf-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(K,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:k?`Tanlangan: ${k.name}`:"DOC, DOCX yoki PDF faylni tanlang"})]}),u.jsx("input",{id:"collection-pdf-upload",type:"file",className:"sr-only",onChange:e=>_(e.target.files?e.target.files[0]:null),accept:".pdf,.doc,.docx",disabled:d})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"To'plam havolasi (ixtiyoriy)"}),u.jsxs("div",{className:"relative",children:[u.jsx(ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),u.jsx("input",{type:"text",className:"w-full !pl-10",placeholder:"https://jurnal-sayti.uz/arxiv/2025-09.pdf",value:N,onChange:e=>w(e.target.value),disabled:d})]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx(_a,{onClick:async()=>{if(k||N)try{String(y+1).padStart(2,"0");const e=ms[y],a=l.find(e=>e.id===p),t=Array.isArray(A)?A.map(e=>e.id).filter(e=>void 0!==e):[],r={journal:p,issue_number:`${b}-${e}`,publication_date:new Date(b,y,28).toISOString().split("T")[0],articles:t,collection_url:N||""};C?(await sa.updateIssue(C.id,r,k),s({message:`Jurnalning ${e} ${b} soni muvaffaqiyatli yangilandi!`,link:"/published-articles"})):(await sa.createIssue(r,k),s({message:`Jurnalning ${e} ${b} soni muvaffaqiyatli yaratildi!`,link:"/published-articles"}));const n=await sa.listIssues();i(n.results||n),Array.isArray(A)&&A.forEach(t=>{h.find(e=>e.id===t.author)&&s({message:`Sizning maqolangiz kiritilgan "${null==a?void 0:a.name}" jurnalining ${e} soni to'plami tayyor!`,link:"/my-collections"})}),alert(`Jurnalning ${e} ${b} soni muvaffaqiyatli saqlandi va mualliflarga xabar yuborildi.`),_(null),w("")}catch(e){console.error("Failed to save issue:",e),alert("Sonni saqlashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}else alert("Iltimos, oylik to'plamning faylini (DOC/DOCX/PDF) yuklang yoki havola kiriting.")},disabled:d||!k&&!N&&!C,children:d?u.jsxs(u.Fragment,{children:[u.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"})," Yuklanmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(ve,{className:"mr-2 h-4 w-4"})," ",C?"Yangilash":"Sonni Yopish va Saqlash"]})})})]})]})},gs=()=>{const{user:a}=ma(),[s,t]=e.useState([]),[i,l]=e.useState([]),[r,n]=e.useState(""),[o,d]=e.useState({start:"",end:""}),[c,m]=e.useState("all"),[x,h]=e.useState(!0),[g,p]=e.useState(null),[j,b]=e.useState([]);e.useEffect(()=>{(async()=>{if(a)try{h(!0),p(null);const[e,a]=await Promise.all([ta.listTransactions(),ea.list()]),s=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[],i=Array.isArray(a)?a:(null==a?void 0:a.data)&&Array.isArray(a.data)?a.data:(null==a?void 0:a.results)&&Array.isArray(a.results)?a.results:[];t(s),l(s),b(i)}catch(e){console.error("Failed to fetch data:",e),p("Tranzaksiyalarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{h(!1)}})()},[a]),e.useEffect(()=>{let e=s;if(r){const a=r.toLowerCase();e=e.filter(e=>{var s;const t=j.find(a=>a.id===e.user);return(t?`${t.first_name} ${t.last_name}`.toLowerCase():"").includes(a)||(null==(s=e.service_type)?void 0:s.toLowerCase().includes(a))||e.article&&e.article.toString().includes(a)||e.translation_request&&e.translation_request.toString().includes(a)})}o.start&&o.end&&(e=e.filter(e=>{const a=new Date(e.created_at);return a>=new Date(o.start)&&a<=new Date(o.end)})),"all"!==c&&(e=e.filter(e=>e.service_type===c)),l(e)},[r,o,c,s,j]);const f={"fast-track":"Tezkor ko'rib chiqish",publication_fee:"Nashr haqi",language_editing:"Tilni tahrirlash",top_up:"Hisobni to'ldirish",book_publication:"Kitob nashri",translation:"Tarjima"},y={pending:"bg-yellow-500/20 text-yellow-300",completed:"bg-green-500/20 text-green-300",failed:"bg-red-500/20 text-red-300",cancelled:"bg-gray-500/20 text-gray-300"};if(!a)return u.jsx(ka,{title:"Ruxsat kerak",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun tizimga kirishingiz kerak."})});if(x)return u.jsx(ka,{title:"Moliyaviy tranzaksiyalar",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(H,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})});if(g)return u.jsx(ka,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:g}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})});const v=i.filter(e=>e.amount>0&&"completed"===e.status).reduce((e,a)=>e+a.amount,0),N=i.filter(e=>e.amount<0&&"completed"===e.status).reduce((e,a)=>e+Math.abs(a.amount),0),w={},k={};return i.forEach(e=>{if("completed"===e.status){const a=e.service_type||"other";e.amount>0?w[a]=(w[a]||0)+e.amount:k[a]=(k[a]||0)+Math.abs(e.amount)}}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx(ka,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-green-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-green-400 font-bold text-xl",children:"+"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Jami tushum"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[v.toLocaleString()," so'm"]})]})]})}),u.jsx(ka,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-red-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-red-400 font-bold text-xl",children:"-"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Jami chiqim"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[N.toLocaleString()," so'm"]})]})]})}),u.jsx(ka,{children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-3 rounded-xl bg-blue-500/20 mr-4",children:u.jsx("div",{className:"h-8 w-8 text-blue-400 font-bold text-xl",children:"="})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Balans"}),u.jsxs("p",{className:"text-2xl font-bold text-white",children:[(v-N).toLocaleString()," so'm"]})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(ka,{title:"Tushumlar (Xizmat turlari bo'yicha)",children:u.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Object.entries(w).length>0?Object.entries(w).map(([e,a])=>u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:f[e]||e}),u.jsxs("span",{className:"font-medium text-green-400",children:[a.toLocaleString()," so'm"]})]},e)):u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Ma'lumot mavjud emas"})})}),u.jsx(ka,{title:"Chiqimlar (Xizmat turlari bo'yicha)",children:u.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Object.entries(k).length>0?Object.entries(k).map(([e,a])=>u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-gray-300",children:f[e]||e}),u.jsxs("span",{className:"font-medium text-red-400",children:[a.toLocaleString()," so'm"]})]},e)):u.jsx("p",{className:"text-center text-gray-400 py-4",children:"Ma'lumot mavjud emas"})})})]}),u.jsxs(ka,{title:"Moliyaviy tranzaksiyalar",children:[u.jsxs("div",{className:"mb-6 flex flex-col lg:flex-row gap-4",children:[u.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Qidirish"}),u.jsxs("div",{className:"relative",children:[u.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),u.jsx("input",{type:"text",placeholder:"Foydalanuvchi yoki xizmat bo'yicha qidirish...",className:"w-full pl-10",value:r,onChange:e=>n(e.target.value)})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Sana oralig'i"}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsx("input",{type:"date",className:"w-full",value:o.start,onChange:e=>d(a=>({...a,start:e.target.value}))}),u.jsx("input",{type:"date",className:"w-full",value:o.end,onChange:e=>d(a=>({...a,end:e.target.value}))})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Xizmat turi"}),u.jsxs("select",{className:"w-full",value:c,onChange:e=>m(e.target.value),children:[u.jsx("option",{value:"all",children:"Barcha xizmatlar"}),Object.entries(f).map(([e,a])=>u.jsx("option",{value:e,children:a},e))]})]})]}),u.jsx("div",{className:"flex items-end",children:u.jsxs(_a,{onClick:()=>{const e=[["Foydalanuvchi","Xizmat","Miqdor","Valyuta","Sana","Holat"].join(","),...i.map(e=>{const a=j.find(a=>a.id===e.user),s=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi",t=f[e.service_type]||e.service_type||"Noma'lum",i=`${e.amount>=0?"+":""}${e.amount}`,l=new Date(e.created_at).toLocaleDateString();return`"${s}","${t}","${i}","${e.currency}","${l}","${e.status}"`})].join("\n"),a=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),t=document.createElement("a");t.setAttribute("href",s),t.setAttribute("download",`tranzaksiyalar_${(new Date).toISOString().split("T")[0]}.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},variant:"secondary",disabled:0===i.length,children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," Eksport"]})})]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/10",children:u.jsxs("table",{className:"w-full text-left",children:[u.jsx("thead",{className:"bg-white/5",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Foydalanuvchi"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Xizmat"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Miqdor"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Sana"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-gray-300 uppercase tracking-wider",children:"Holat"})]})}),u.jsx("tbody",{className:"divide-y divide-white/10",children:i.length>0?i.map(e=>{const a=j.find(a=>a.id===e.user),s=a?`${a.first_name} ${a.last_name}`:"Noma'lum foydalanuvchi";return u.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:s}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:f[e.service_type]||e.service_type||"Noma'lum"}),u.jsx("td",{className:"px-4 py-4 text-sm font-medium",children:u.jsxs("span",{className:e.amount>=0?"text-green-400":"text-red-400",children:[e.amount>=0?"+":"",e.amount.toLocaleString()," ",e.currency]})}),u.jsx("td",{className:"px-4 py-4 text-sm text-gray-300",children:new Date(e.created_at).toLocaleDateString()}),u.jsx("td",{className:"px-4 py-4 text-sm",children:u.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium ${y[e.status]||"bg-gray-500/20 text-gray-300"}`,children:e.status})})]},e.id)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-4 py-12 text-center",children:[u.jsx(J,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("h3",{className:"mt-2 text-sm font-medium text-white",children:"Tranzaksiyalar topilmadi"}),u.jsx("p",{className:"mt-1 text-sm text-gray-400",children:r||o.start||o.end||"all"!==c?"Tanlangan filtrlar bo'yicha hech narsa topilmadi.":"Hozircha tranzaksiyalar mavjud emas."})]})})})]})})]})]})},ps={"1-10":{eco:125,standart:150},"11-100":{eco:100,standart:125},"101-300":{eco:80,standart:100},"301-1000":{eco:75,standart:80}},js={"1-10":{soft:15e3,hard:2e4},"11-100":{soft:1e4,hard:15e3},"101-300":{soft:8e3,hard:1e4},"301-1000":{soft:6e3,hard:8e3}},bs={"1-10":300,"11-100":300,"101-300":250,"301-1000":200},fs=6e5,ys=({label:e,value:a,onChange:s,min:t,max:i,step:l,icon:r})=>u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-300",children:[u.jsx(r,{className:"w-4 h-4 mr-2"}),e]}),u.jsx("span",{className:"text-sm font-medium text-blue-300 bg-blue-900/30 px-2 py-1 rounded",children:a})]}),u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:()=>s(Math.max(t,a-l)),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",type:"button",children:u.jsx(Me,{className:"w-4 h-4 text-gray-400"})}),u.jsx("input",{type:"range",min:t,max:i,step:l,value:a,onChange:e=>s(parseInt(e.target.value,10)||t),className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-blue-500"}),u.jsx("button",{onClick:()=>s(Math.min(i,a+l)),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors",type:"button",children:u.jsx(X,{className:"w-4 h-4 text-gray-400"})}),u.jsx("input",{type:"number",min:t,max:i,value:a,onChange:e=>s(parseInt(e.target.value,10)||t),className:"w-24 text-center !py-2"})]})]}),vs=({label:e,options:a,selected:s,onSelect:t})=>u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:e}),u.jsx("div",{className:"flex bg-white/5 rounded-lg p-1",children:a.map(e=>u.jsx("button",{type:"button",onClick:()=>t(e.value),className:"w-full text-center px-4 py-2 rounded-md text-sm font-semibold transition-colors duration-200 "+(s===e.value?"bg-blue-600 text-white shadow":"text-gray-300 hover:bg-white/10"),children:e.label},e.value))})]}),Ns=({title:e,description:a,price:s,checked:t,onChange:i})=>u.jsx("div",{onClick:()=>i(!t),className:"p-4 rounded-lg bg-white/5 border-2 cursor-pointer transition-all "+(t?"border-blue-500 bg-blue-500/10":"border-transparent hover:border-white/10"),children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1 pr-4",children:[u.jsx("p",{className:"font-semibold text-white",children:e}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a})]}),u.jsxs("div",{className:"flex flex-col items-end",children:[u.jsx("div",{className:"w-5 h-5 rounded-md flex items-center justify-center border-2 transition-all "+(t?"bg-blue-600 border-blue-500":"bg-white/10 border-white/20"),children:t&&u.jsx(Q,{className:"w-3 h-3 text-white"})}),u.jsxs("p",{className:"text-sm font-medium text-blue-300 mt-2 whitespace-nowrap",children:[s.toLocaleString()," so'm"]})]})]})}),ws=()=>u.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-2xl bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center shadow-lg",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-white",children:u.jsx("path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"})})}),ks=()=>{const{user:a}=ma(),{addNotification:s}=xa(),[t,i]=e.useState(150),[l,r]=e.useState(50),[n,d]=e.useState("standart"),[c,m]=e.useState("soft"),[x,h]=e.useState({isbn:!1,design:!1}),[g,p]=e.useState(""),[j,b]=e.useState(""),[f,y]=e.useState(null),[v,N]=e.useState(null),[w,k]=e.useState(!1),[q,S]=e.useState("idle"),[z,C]=e.useState(null),[A,T]=e.useState(null),[I,M]=e.useState(!1),[P,F]=e.useState(null),[D,O]=e.useState(!1),$=e.useRef(null);e.useEffect(()=>()=>{$.current&&clearTimeout($.current)},[]);const E=e.useMemo(()=>{const e=(a=l)>=1&&a<=10?"1-10":a>=11&&a<=100?"11-100":a>=101&&a<=300?"101-300":a>=301?"301-1000":null;var a;if(!e||t<=0||l<=0)return{printing:0,cover:0,binding:0,isbn:0,design:0,total:0};const s=ps[e][n],i=js[e][c],r=t*l*s,o=l*i,d=l*bs[e],m=x.isbn?fs:0,u=x.design?75e3:0;return{printing:r,cover:o,binding:d,isbn:m,design:u,total:r+o+d+m+u}},[t,l,n,c,x]),R=async e=>{e&&(e.preventDefault(),e.stopPropagation()),C(null),S("processing"),$.current&&clearTimeout($.current);try{const e=await Wa.createTransactionAndPay(E.total,"UZS","book_publication",void 0,void 0);if(e&&!0===e.success&&e.payment_url)S("success"),T(e.transaction_id||null),F("pending"),s({message:"To'lov oynasi yangi tabda ochildi. To'lovni shu oynada davom ettiring."}),window.open(e.payment_url,"_blank","noopener,noreferrer");else{const a=(null==e?void 0:e.user_message)||(null==e?void 0:e.error_note)||(null==e?void 0:e.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";S("failed"),C(a),s({message:a})}}catch(a){console.error("Payment failed:",a);const e=a.message||a.error_note||a.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";S("failed"),C(e),s({message:e})}},U=()=>k(!1),L=async()=>{if(A){O(!0);try{const e=await Wa.checkPaymentStatus(A);2===e.payment_status?F("completed"):-1===e.payment_status?F("failed"):F("pending")}catch(e){F("pending")}finally{O(!1)}}},J=e=>`${new Intl.NumberFormat("uz-UZ").format(e)} so'm`;return u.jsxs(u.Fragment,{children:[u.jsx(ka,{title:"Kitob Nashr Etish Kalkulyatori",children:u.jsxs("form",{onSubmit:e=>{e.preventDefault(),E.total<=0?alert("Iltimos, sahifa va nusxalar sonini to'g'ri kiriting."):(S("idle"),C(null),k(!0))},children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-white border-b border-white/10 pb-3",children:"1. Asosiy Parametrlar"}),u.jsx(ys,{label:"Sahifalar soni",value:t,onChange:i,min:16,max:1e3,step:4,icon:Ae}),u.jsx(ys,{label:"Nusxalar soni",value:l,onChange:r,min:1,max:1e3,step:1,icon:Te}),u.jsx(vs,{label:"Qog'oz sifati",options:[{value:"eco",label:"Eco"},{value:"standart",label:"Standart"}],selected:n,onSelect:e=>d(e)}),u.jsx(vs,{label:"Muqova turi",options:[{value:"soft",label:"Yumshoq"},{value:"hard",label:"Qattiq"}],selected:c,onSelect:e=>m(e)}),u.jsx("h3",{className:"text-lg font-semibold text-white border-b border-white/10 pb-3 pt-4",children:"2. Qo'shimcha Xizmatlar"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx(Ns,{title:"ISBN raqami olish",description:"Kitobingizga xalqaro standart raqamini oling.",price:fs,checked:x.isbn,onChange:e=>h(a=>({...a,isbn:e}))}),u.jsx(Ns,{title:"Professional muqova dizayni",description:"Tajribali dizaynerlar tomonidan muqova tayyorlash.",price:75e3,checked:x.design,onChange:e=>h(a=>({...a,design:e}))})]})]}),u.jsx("div",{className:"space-y-6",children:u.jsx("div",{className:"sticky top-24",children:u.jsx(ka,{title:"Hisob-kitob",className:"!bg-black/40",children:E.total>0?u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Chop etish:"}),u.jsx("span",{className:"font-medium text-white",children:J(E.printing)})]}),u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Muqova:"}),u.jsx("span",{className:"font-medium text-white",children:J(E.cover)})]}),u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Tikish:"}),u.jsx("span",{className:"font-medium text-white",children:J(E.binding)})]}),x.isbn&&u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"ISBN:"}),u.jsx("span",{className:"font-medium text-white",children:J(E.isbn)})]}),x.design&&u.jsxs("div",{className:"flex justify-between py-1.5 border-b border-white/10",children:[u.jsx("span",{className:"text-gray-400",children:"Dizayn:"}),u.jsx("span",{className:"font-medium text-white",children:J(E.design)})]}),u.jsxs("div",{className:"flex justify-between items-center pt-4",children:[u.jsx("span",{className:"text-lg font-bold text-white",children:"JAMI:"}),u.jsx("span",{className:"text-2xl font-bold text-blue-300",children:J(E.total)})]})]}):u.jsxs("div",{className:"text-center py-8 text-gray-400",children:[u.jsx(Ie,{className:"mx-auto h-8 w-8 mb-2"}),"Narxni hisoblash uchun parametrlarni kiriting."]})})})})]}),u.jsxs("div",{className:"mt-10 pt-6 border-t border-white/10",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"3. Kitob Ma'lumotlari va Fayllar"}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Kitob Sarlavhasi"}),u.jsx("input",{type:"text",value:g,onChange:e=>p(e.target.value),required:!0,className:"w-full"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Annotatsiya / Synopsis"}),u.jsx("textarea",{value:j,onChange:e=>b(e.target.value),required:!0,className:"w-full",rows:4})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Qo'lyozma Fayli (.docx, .pdf)"}),u.jsxs("label",{htmlFor:"manuscript-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors h-full flex flex-col justify-center",children:[u.jsx(K,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:f?f.name:"Faylni yuklang"})]}),u.jsx("input",{id:"manuscript-upload",type:"file",className:"sr-only",onChange:e=>y(e.target.files?e.target.files[0]:null),accept:".doc,.docx,.pdf",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Muqova Rasmi (ixtiyoriy)"}),u.jsxs("label",{htmlFor:"cover-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors h-full flex flex-col justify-center",children:[u.jsx(K,{className:"mx-auto h-10 w-10 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:v?v.name:"Rasm yuklang"})]}),u.jsx("input",{id:"cover-upload",type:"file",className:"sr-only",onChange:e=>N(e.target.files?e.target.files[0]:null),accept:"image/*"})]})]})]})]})]}),u.jsx("div",{className:"mt-10 pt-6 border-t border-white/10 flex justify-end",children:u.jsx(_a,{type:"submit",disabled:!g||!f||t<=0||l<=0,children:"To'lovga o'tish va Yuborish"})})]})}),w&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(ka,{className:"w-full max-w-sm text-center",children:["idle"===q&&u.jsxs(u.Fragment,{children:[u.jsx(ws,{}),u.jsx("h3",{className:"text-xl font-semibold text-white",children:"To'lovni tasdiqlash"}),u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Kitob nashr etish"}),u.jsx("p",{className:"text-4xl font-bold my-4 text-white",children:J(E.total)}),u.jsx(_a,{onClick:e=>R(e),className:"w-full",type:"button",children:"To'lash"}),u.jsx(_a,{variant:"secondary",onClick:U,className:"w-full mt-3",children:"Bekor qilish"})]}),"processing"===q&&u.jsxs("div",{className:"py-8",children:[u.jsx(H,{className:"mx-auto h-16 w-16 text-blue-500 animate-spin"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===q&&u.jsxs("div",{className:"py-8",children:[u.jsx(o,{className:"mx-auto h-16 w-16 text-green-500"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov oynasi ochildi"}),u.jsx("p",{className:"text-sm text-gray-400",children:"Click sahifasi yangi tabda ochildi. To'lovni yakunlagach ushbu oynaga qayting."}),u.jsxs("div",{className:"space-y-2 mt-6",children:[u.jsx(_a,{onClick:()=>{M(!0),L()},className:"w-full",children:"Jarayonni ko'rish"}),u.jsx(_a,{onClick:U,variant:"secondary",className:"w-full",children:"Yopish"})]})]}),"failed"===q&&u.jsxs("div",{className:"py-8",children:[u.jsx(_,{className:"mx-auto h-16 w-16 text-red-500"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto",children:z}),u.jsxs("div",{className:"flex space-x-2 mt-6",children:[u.jsx(_a,{onClick:e=>R(e),className:"w-full",type:"button",children:"Qayta urinish"}),u.jsx(_a,{variant:"secondary",onClick:U,className:"w-1/2",type:"button",children:"Yopish"})]})]})]})}),I&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs(ka,{className:"w-full max-w-xl",children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Kitob nashri jarayoni"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-200",children:"1. Buyurtma qabul qilindi"}),u.jsx(o,{className:"h-5 w-5 text-green-500"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-200",children:"2. To'lov holati"}),"completed"===P&&u.jsx(o,{className:"h-5 w-5 text-green-500"}),"failed"===P&&u.jsx(_,{className:"h-5 w-5 text-red-500"}),("pending"===P||null===P)&&u.jsx(H,{className:"h-5 w-5 text-yellow-400 animate-spin"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-200",children:"3. Muharrir ko'rib chiqadi"}),u.jsx("span",{className:"text-xs text-gray-400",children:"Kutilmoqda"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-200",children:"4. Nashrga tayyorlash"}),u.jsx("span",{className:"text-xs text-gray-400",children:"Kutilmoqda"})]}),u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-200",children:"5. Yakuniy natija"}),u.jsx("span",{className:"text-xs text-gray-400",children:"Kutilmoqda"})]})]}),u.jsxs("div",{className:"flex gap-2 mt-6",children:[u.jsx(_a,{onClick:L,variant:"secondary",className:"w-full",disabled:D||!A,children:D?"Yangilanmoqda...":"Holatni yangilash"}),u.jsx(_a,{onClick:()=>M(!1),className:"w-full",children:"Yopish"})]})]})})]})},_s=()=>{const{user:a}=ma(),[s,t]=e.useState([]),[i,l]=e.useState([]),[r,n]=e.useState([]),[o,d]=e.useState(!0),[m,x]=e.useState(null);e.useEffect(()=>{(async()=>{if(a){d(!0),x(null);try{const[e,a,s]=await Promise.all([sa.listIssues(),sa.list(),aa.list()]),i=e=>Array.isArray(e)?e:(null==e?void 0:e.results)||(null==e?void 0:e.data)||[];t(i(e)),l(i(a)),n(i(s))}catch(e){console.error("Failed to fetch data:",e),x("Ma'lumotlarni yuklashda xatolik yuz berdi: "+(e.message||"Noma'lum xatolik"))}finally{d(!1)}}})()},[a]);const h=e.useMemo(()=>a?r.filter(e=>e.author===a.id&&"published"===e.status).map(e=>e.id):[],[a,r]),g=e.useMemo(()=>s.filter(e=>(Array.isArray(e.articles)?e.articles:[]).some(e=>h.includes(e))&&e.collection_url).sort((e,a)=>new Date(a.publication_date).getTime()-new Date(e.publication_date).getTime()),[s,h]);return a?o?u.jsx(ka,{title:"Mening To'plamlarim",children:u.jsxs("div",{className:"flex justify-center items-center h-64",children:[u.jsx(H,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-3",children:"Ma'lumotlar yuklanmoqda..."})]})}):m?u.jsx(ka,{title:"Xatolik",children:u.jsxs("div",{className:"text-red-400 p-4 bg-red-900/20 rounded-lg",children:[u.jsx("p",{children:m}),u.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors",children:"Qayta urinib ko'rish"})]})}):u.jsxs(ka,{title:"Mening To'plamlarim",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda sizning maqolalaringiz kiritilgan jurnallarning oylik to'plamlarini topishingiz mumkin."}),u.jsx("div",{className:"space-y-4",children:g.length>0?g.map(e=>{const a=i.find(a=>a.id===e.journal);return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl border border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-bold text-white",children:null==a?void 0:a.name}),u.jsxs("p",{className:"font-semibold text-blue-300 mt-1",children:[e.issue_number," soni"]}),u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Nashr sanasi: ",new Date(e.publication_date).toLocaleDateString()]})]}),e.collection_url&&u.jsx("a",{href:e.collection_url,target:"_blank",rel:"noopener noreferrer",className:"w-full sm:w-auto",children:u.jsxs(_a,{variant:"secondary",className:"w-full",children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," To'plamni Yuklash"]})})]})},e.id)}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(c,{className:"mx-auto h-16 w-16 text-gray-500"}),u.jsx("h3",{className:"mt-4 text-xl font-semibold text-white",children:"To'plamlar Hozircha Mavjud Emas"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:"Maqolangiz biror sonda nashr etilganda va admin to'plam havolasini yuborganda, u shu yerda paydo bo'ladi."})]})})]}):u.jsx(ka,{title:"Xatolik",children:u.jsx("p",{children:"Foydalanuvchi topilmadi."})})},qs=()=>{const{user:a}=ma(),{addNotification:s}=xa(),[t,i]=e.useState(null),[r,n]=e.useState("uz"),[c,x]=e.useState("en"),[h,g]=e.useState(null),[p,j]=e.useState(!1),[b,f]=e.useState(!1),y=e.useRef(null),[v,N]=e.useState(!1),[w,k]=e.useState("idle"),[_,q]=e.useState(null),[S,z]=e.useState(null),C=e.useRef(null),A=[{code:"uz",name:"O'zbekcha"},{code:"en",name:"Inglizcha"},{code:"ru",name:"Ruscha"},{code:"fr",name:"Fransuzcha"},{code:"de",name:"Nemischa"},{code:"es",name:"Ispancha"},{code:"ar",name:"Arabcha"}];G.useEffect(()=>()=>{C.current&&clearTimeout(C.current)},[]);const T=()=>{N(!1),C.current&&clearTimeout(C.current),k("idle"),q(null)},I=async()=>{if(t&&h&&a&&S){q(null),k("processing"),C.current&&clearTimeout(C.current);try{const e=await Wa.createTransactionAndPay(h.cost,"UZS","translation",void 0,S);if(e&&!0===e.success&&e.payment_url)N(!1),s({message:"To'lov sahifasiga yo'naltirilmoqdasiz. To'lovni tugallang."}),setTimeout(()=>{e.payment_url?(e.payment_url,Wa.redirectToPayment(e.payment_url)):(console.error("Payment URL is missing"),k("failed"),q("To'lov URL topilmadi. Iltimos, qayta urinib ko'ring."),N(!0))},500);else{const a=(null==e?void 0:e.user_message)||(null==e?void 0:e.error_note)||(null==e?void 0:e.error)||"To'lovni amalga oshirishda xatolik yuz berdi.";k("failed"),q(a),s({message:a})}}catch(e){console.error("Payment failed:",e);const a=e.message||e.error_note||e.user_message||"To'lovni amalga oshirishda xatolik yuz berdi.";k("failed"),q(a)}}},M=async(e=!1)=>{if(t&&h&&a){f(!0);try{const l=await(async e=>{if(a&&e&&h)try{const a={title:e.name,source_language:r,target_language:c,status:ga.Yangi,word_count:h.wordCount,cost:h.cost,submission_date:(new Date).toISOString().split("T")[0]},t=await ia.create({...a,file:e});return s({message:`"${a.title}" uchun tarjima so'rovi qabul qilindi.`,link:"/my-translations"}),t}catch(t){throw console.error("Failed to create translation request:",t),s({message:"Tarjima so'rovi yuborishda xatolik yuz berdi. Iltimos, qayta urinib ko'ring."}),t}})(t);if(l&&l.id&&z(l.id),!e)return N(!0),void f(!1);se.success("Tarjima so'rovi muvaffaqiyatli yuborildi va to'lov tasdiqlandi!"),i(null),g(null),z(null),y.current&&(y.current.value="")}catch(l){se.error("So'rov yuborishda xatolik yuz berdi")}finally{f(!1)}}else se.error("Barcha maydonlarni to'ldiring")};return u.jsxs("div",{className:"max-w-4xl mx-auto",children:[u.jsx(ka,{title:"Ilmiy Tarjima Xizmati",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Hujjatni Yuklash"}),u.jsx("div",{className:"flex items-center justify-center w-full",children:u.jsxs("label",{htmlFor:"file-upload",className:"flex flex-col items-center justify-center w-full h-48 border-2 border-dashed rounded-lg cursor-pointer border-gray-600 hover:border-gray-500 transition-colors",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[u.jsx(d,{className:"w-10 h-10 text-gray-400"}),u.jsxs("p",{className:"mb-2 text-sm text-gray-400",children:[u.jsx("span",{className:"font-semibold",children:"Fayl tanlash"})," yoki olib keling"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"DOC, DOCX, PDF (MAX. 10MB)"}),t&&u.jsxs("p",{className:"mt-2 text-sm text-green-400 flex items-center",children:[u.jsx(o,{className:"w-4 h-4 mr-1"}),t.name]})]}),u.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0];i(a),g(null),z(null)}},accept:".pdf,.doc,.docx,.txt",ref:y})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Manba Tili"}),u.jsx("select",{value:r,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 bg-[#1f1630] border border-white/20 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",style:{colorScheme:"dark"},children:A.map(e=>u.jsx("option",{value:e.code,className:"bg-[#1f1630] text-white",children:e.name},e.code))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Maqsad Tili"}),u.jsx("select",{value:c,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 bg-[#1f1630] border border-white/20 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-blue-500",style:{colorScheme:"dark"},children:A.map(e=>u.jsx("option",{value:e.code,className:"bg-[#1f1630] text-white",children:e.name},e.code))})]})]}),t&&u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex justify-center",children:u.jsx(_a,{onClick:async()=>{if(t){j(!0);try{const e=t.size/1024,a=Math.round(150*e);g({wordCount:a,cost:500*a,fileName:t.name}),se.success("Fayl tahlili tugallandi!")}catch(e){console.error("Error analyzing file:",e),se.error("Fayl tahlilida xatolik yuz berdi")}finally{j(!1)}}else se.error("Iltimos, fayl tanlang")},disabled:p,variant:"secondary",className:"w-full max-w-xs",children:p?u.jsxs(u.Fragment,{children:[u.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Tahlil qilinmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(l,{className:"mr-2 h-4 w-4"}),"Hujjatni Tahlil Qilish"]})})}),h&&u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[u.jsxs("h3",{className:"font-medium text-white mb-3 flex items-center",children:[u.jsx(m,{className:"mr-2 h-5 w-5 text-blue-400"}),"Tahlil Natijalari"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"p-3 bg-blue-900/20 rounded border border-blue-700/30",children:[u.jsx("p",{className:"text-sm text-blue-300",children:"Fayl nomi"}),u.jsx("p",{className:"font-medium text-white truncate",children:h.fileName})]}),u.jsxs("div",{className:"p-3 bg-green-900/20 rounded border border-green-700/30",children:[u.jsx("p",{className:"text-sm text-green-300",children:"So'zlar soni"}),u.jsx("p",{className:"font-medium text-white",children:h.wordCount.toLocaleString()})]}),u.jsxs("div",{className:"p-3 bg-yellow-900/20 rounded border border-yellow-700/30",children:[u.jsx("p",{className:"text-sm text-yellow-300",children:"Taxminiy narx"}),u.jsxs("p",{className:"font-medium text-white",children:[h.cost.toLocaleString()," so'm"]})]})]}),u.jsx("div",{className:"mt-4 pt-4 border-t border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsx(_a,{onClick:()=>M(!1),disabled:b,className:"flex-1",children:b?u.jsxs(u.Fragment,{children:[u.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Yuborilmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(ae,{className:"mr-2 h-4 w-4"}),"To'lov va Yuborish"]})}),u.jsx(_a,{onClick:()=>{g(null),z(null),y.current&&(y.current.value=""),i(null)},variant:"secondary",children:"Bekor qilish"})]})})]})]}),u.jsx("div",{className:"p-4 bg-blue-900/10 border border-blue-700/30 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx(Pe,{className:"h-5 w-5 text-blue-400 mt-0.5 mr-2 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-blue-300",children:"Muhim Ma'lumot"}),u.jsx("p",{className:"mt-1 text-sm text-gray-300",children:"Tarjima xizmati uchun narx so'zlar soniga qarab hisoblanadi. Hozirgi narx: 500 so'm har bir so'z uchun. Sifatli tarjima mutaxassislarning qo'lidan chiqadi."})]})]})})]})}),v&&u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-gray-900 rounded-lg p-6 max-w-md w-full border border-white/10",children:["idle"===w&&u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"To'lovni tasdiqlash"}),u.jsx("p",{className:"text-gray-300 mb-2",children:"Tarjima xizmati uchun to'lov:"}),u.jsxs("div",{className:"p-3 bg-blue-900/20 rounded border border-blue-700/30 mb-4",children:[u.jsxs("p",{className:"text-sm text-blue-300",children:["So'zlar soni: ",null==h?void 0:h.wordCount.toLocaleString()]}),u.jsxs("p",{className:"text-lg font-bold text-white mt-1",children:[null==h?void 0:h.cost.toLocaleString()," so'm"]})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs(_a,{onClick:I,className:"flex-1",children:[u.jsx(ae,{className:"mr-2 h-4 w-4"}),"To'lovni Amalga Oshirish"]}),u.jsx(_a,{variant:"secondary",onClick:T,className:"flex-1",children:"Bekor qilish"})]})]}),"processing"===w&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov tasdiqlanmoqda..."})]}),"success"===w&&u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"text-green-500 text-4xl mb-4",children:"✓"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200",children:"To'lov muvaffaqiyatli!"}),u.jsx(_a,{onClick:()=>{T(),M(!0)},className:"w-full mt-6",children:"So'rovni Davom Ettirish"})]}),"failed"===w&&u.jsxs("div",{children:[u.jsx("div",{className:"text-red-500 text-4xl mb-4 text-center",children:"✗"}),u.jsx("p",{className:"mt-4 text-lg font-medium text-gray-200 text-center",children:"To'lovda xatolik!"}),u.jsx("p",{className:"text-sm text-gray-400 max-w-xs mx-auto text-center mb-4",children:_}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx(_a,{onClick:I,className:"flex-1",children:"Qayta Urinish"}),u.jsx(_a,{variant:"secondary",onClick:T,className:"flex-1",children:"Yopish"})]})]})]})})]})},Ss=()=>{const{user:a}=ma(),[s,t]=e.useState([]),[i,r]=e.useState(!0),[n,d]=e.useState(null);e.useEffect(()=>{(async()=>{if(a)try{r(!0),d(null);const e=await ia.list(),a=Array.isArray(e)?e:(null==e?void 0:e.data)&&Array.isArray(e.data)?e.data:(null==e?void 0:e.results)&&Array.isArray(e.results)?e.results:[];t(a)}catch(e){console.error("Failed to fetch translation requests:",e),d("Tarjima so'rovlari ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{r(!1)}})()},[a]);const c=e.useMemo(()=>a?s.filter(e=>e.author===a.id).sort((e,a)=>new Date(a.submission_date).getTime()-new Date(e.submission_date).getTime()):[],[a,s]);return a?i?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):n?u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:n}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]}):u.jsxs(ka,{title:"Mening Tarjimalarim",children:[u.jsx("p",{className:"text-gray-300 mb-6 -mt-4",children:"Bu yerda siz buyurtma qilgan tarjimalaringiz holatini kuzatib borishingiz mumkin."}),u.jsx("div",{className:"space-y-4",children:c.length>0?c.map(e=>{const a=(e=>{switch(e){case ga.Yangi:return{text:"Yangi",color:"text-blue-400",icon:k};case ga.Jarayonda:return{text:"Jarayonda",color:"text-yellow-400",icon:Fe};case ga.Bajarildi:return{text:"Bajarildi",color:"text-green-400",icon:o};case ga.BekorQilindi:return{text:"Bekor Qilindi",color:"text-red-400",icon:_};default:return{text:e,color:"text-gray-400",icon:l}}})(e.status),s=a.icon;return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl border border-white/10",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-white flex items-center gap-3",children:[u.jsx(m,{className:"text-indigo-400"}),e.title]}),u.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[e.source_language.toUpperCase()," → ",e.target_language.toUpperCase()]}),u.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[u.jsxs("span",{children:["Yuborilgan sana: ",new Date(e.submission_date).toLocaleDateString()]}),e.status===ga.Jarayonda&&e.reviewer_name&&u.jsxs("span",{className:"ml-2 pl-2 border-l border-gray-600",children:["Tarjimon: ",e.reviewer_name]})]})]}),u.jsxs("div",{className:"flex flex-col sm:items-end gap-2 w-full sm:w-auto",children:[u.jsxs("div",{className:`flex items-center gap-2 font-semibold ${a.color}`,children:[u.jsx(s,{className:"w-5 h-5 "+(e.status===ga.Jarayonda?"animate-spin":"")}),u.jsx("span",{children:a.text})]}),e.status===ga.Bajarildi&&e.translated_file_path&&u.jsx("a",{href:ra(e.translated_file_path),download:!0,children:u.jsxs(_a,{variant:"secondary",className:"w-full",children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," Tarjimani Yuklash"]})})]})]})},e.id)}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(m,{className:"mx-auto h-16 w-16 text-gray-500"}),u.jsx("h3",{className:"mt-4 text-xl font-semibold text-white",children:"Sizda Hozircha Tarjima Buyurtmalari Yo'q"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:'"Xizmatlar" bo\'limi orqali yangi tarjima buyurtma qilishingiz mumkin.'})]})})]}):u.jsx(ka,{title:"Xatolik",children:u.jsx("p",{children:"Foydalanuvchi topilmadi."})})},zs=()=>{var s,t,i,r;const{id:n}=be(),o=a(),{user:d}=ma(),{addNotification:c}=xa(),[x,h]=e.useState(null),[g,p]=e.useState(!0),[j,b]=e.useState(null),[f,y]=e.useState(null),[v,w]=e.useState(!1);if(e.useEffect(()=>{(async()=>{if(n&&d)try{p(!0),b(null);const e=await ia.get(n),a=e.data||e;h(a)}catch(e){console.error("Failed to fetch translation request:",e),b("Tarjima so'rovi ma'lumotlarini yuklashda xatolik yuz berdi.")}finally{p(!1)}})()},[n,d]),!d||d.role!==ua.Reviewer)return u.jsx(ka,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda ruxsat yo'q."})});if(g)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(j)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:j}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});if(!x)return u.jsx(ka,{title:"Xatolik",children:u.jsx("p",{children:"Tarjima so'rovi topilmadi."})});return u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsxs(ka,{children:[u.jsxs("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-white/10",children:[u.jsx(m,{className:"w-10 h-10 text-indigo-400"}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white",children:x.title}),u.jsxs("p",{className:"text-lg font-semibold text-indigo-300",children:[(null==(s=x.source_language)?void 0:s.toUpperCase())||"Noma'lum"," ",u.jsx(N,{size:16,className:"inline-block mx-2"})," ",(null==(t=x.target_language)?void 0:t.toUpperCase())||"Noma'lum"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm mt-6",children:[u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(q,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Muallif"}),u.jsx("p",{className:"font-semibold text-white",children:x.author_name||"Noma'lum"})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(De,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Sana"}),u.jsx("p",{className:"font-semibold text-white",children:x.submission_date?new Date(x.submission_date).toLocaleDateString():"Noma'lum"})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(l,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"So'zlar soni"}),u.jsxs("p",{className:"font-semibold text-white",children:[(null==(i=x.word_count)?void 0:i.toLocaleString())||0," ta"]})]})]}),u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white/5 rounded-md",children:[u.jsx(l,{className:"w-5 h-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Narxi"}),u.jsxs("p",{className:"font-semibold text-white",children:[(null==(r=x.cost)?void 0:r.toLocaleString())||0," so'm"]})]})]})]})]})}),u.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u.jsx(ka,{title:"Asosiy hujjat",children:x.source_file_path?u.jsx("a",{href:ra(x.source_file_path),download:!0,children:u.jsxs(_a,{variant:"secondary",className:"w-full",children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," Hujjatni yuklab olish"]})}):u.jsx("p",{className:"text-gray-400 text-center py-4",children:"Hujjat mavjud emas"})}),x.status===ga.Yangi&&u.jsx(ka,{title:"Harakatlar",children:u.jsxs(_a,{onClick:async()=>{try{const e={...x,status:ga.Jarayonda,reviewer:d.id},a=await ia.update(n,e),s=a.data||a;h(s),c({message:`"${s.title}" tarjima so'rovingiz ishga qabul qilindi.`,link:"/my-translations"})}catch(e){console.error("Failed to accept translation request:",e),alert("Tarjima so'rovini qabul qilishda xatolik yuz berdi.")}},className:"w-full",children:[u.jsx(Q,{className:"mr-2 h-4 w-4"})," Ishga qabul qilish"]})}),x.status===ga.Jarayonda&&u.jsxs(ka,{title:"Tarjimani yuklash",children:[u.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[u.jsxs("div",{className:"p-8 border-2 border-dashed rounded-lg border-gray-600 text-center bg-white/5 hover:bg-white/10 transition-colors",children:[u.jsx(K,{className:"mx-auto h-12 w-12 text-gray-400"}),u.jsx("p",{className:"mt-2 text-sm text-gray-400",children:f?`Tanlandi: ${f.name}`:"Tayyor faylni tanlang"})]}),u.jsx("input",{id:"file-upload",type:"file",className:"sr-only",onChange:e=>{e.target.files&&y(e.target.files[0])}})]}),u.jsx(_a,{onClick:async()=>{if(f)try{w(!0);const e={...x,status:ga.Bajarildi,completion_date:(new Date).toISOString(),file:f},a=await ia.update(n,e),s=a.data||a;h(s),c({message:`Sizning "${x.title}" nomli tarjima so'rovingiz bajarildi va tayyor faylni yuklab olishingiz mumkin.`,link:"/my-translations"}),alert("Tarjima muvaffaqiyatli yakunlandi va muallifga xabar yuborildi."),o("/articles")}catch(e){console.error("Failed to complete translation:",e),alert("Tarjimani yakunlashda xatolik yuz berdi.")}finally{w(!1)}else alert("Iltimos, avval tarjima qilingan faylni yuklang.")},disabled:!f||v,className:"w-full mt-4",children:v?u.jsxs(u.Fragment,{children:[u.jsx(H,{className:"mr-2 h-4 w-4 animate-spin"}),"Yuklanmoqda..."]}):u.jsxs(u.Fragment,{children:[u.jsx(ve,{className:"mr-2 h-4 w-4"})," Yakunlash va yuborish"]})})]}),x.status===ga.Bajarildi&&x.translated_file_path&&u.jsx(ka,{title:"Tarjimani yuklab olish",children:u.jsx("a",{href:ra(x.translated_file_path),download:!0,children:u.jsxs(_a,{variant:"primary",className:"w-full",children:[u.jsx(fe,{className:"mr-2 h-4 w-4"})," Tarjimani Yuklash"]})})})]})]})},Cs=()=>{const[a,s]=e.useState("10000"),[t,i]=e.useState("top_up"),[l,r]=e.useState(null),[n,o]=e.useState(!1);return u.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Click To'lov Test"}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-4",children:"To'lovni amalga oshirish"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Summa (UZS)"}),u.jsx("input",{type:"number",value:a,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Summani kiriting",min:"1000",step:"1000"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xizmat turi"}),u.jsxs("select",{value:t,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"top_up",children:"Hisobni to'ldirish"}),u.jsx("option",{value:"publication_fee",children:"Nashr to'lovi"}),u.jsx("option",{value:"fast-track",children:"Tezkor nashr"}),u.jsx("option",{value:"language_editing",children:"Til tahriri"}),u.jsx("option",{value:"translation",children:"Tarjima"}),u.jsx("option",{value:"book_publication",children:"Kitob nashri"})]})]}),u.jsx("button",{onClick:async()=>{if(!a||parseFloat(a)<=0)se.error("Iltimos, to'g'ri summani kiriting");else{o(!0),r(null);try{const e=await Wa.createTransactionAndPay(parseFloat(a),"UZS",t);if(r(e),e.success&&e.payment_url)se.success("To'lov sahifasiga o'tmoqdasiz..."),setTimeout(()=>{Wa.redirectToPayment(e.payment_url)},1e3);else{const a=e.error_note||e.error||"To'lovni amalga oshirishda xatolik yuz berdi";se.error(a)}}catch(e){console.error("Error processing payment:",e),r({success:!1,error:e.message||"Noma'lum xatolik yuz berdi"}),se.error("To'lovni amalga oshirishda xatolik yuz berdi")}finally{o(!1)}}},disabled:n,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Jarayonda...":"To'lovni amalga oshirish"})]})]}),l&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Natija"}),u.jsx("div",{className:"mb-2",children:u.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-medium "+(l.success?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:l.success?"Muvaffaqiyatli":"Xatolik"})}),l.payment_url&&u.jsx("div",{className:"mb-4",children:u.jsx("a",{href:l.payment_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:"To'lov sahifasiga o'tish"})}),u.jsx("pre",{className:"bg-gray-100 p-4 rounded-md overflow-x-auto text-sm",children:JSON.stringify(l,null,2)})]})]})},As=()=>{const{user:s}=ma(),t=a(),[i,r]=e.useState([]),[n,d]=e.useState([]),[c,m]=e.useState(!0),[x,h]=e.useState(null),[g,p]=e.useState(""),[j,b]=e.useState("new");e.useEffect(()=>{(null==s?void 0:s.role)===ua.JournalAdmin&&(async()=>{if(s)try{m(!0),h(null);const e=await sa.list();let a=[];Array.isArray(e)?a=e:e&&"object"==typeof e&&(a=Array.isArray(e.data)?e.data:Array.isArray(e.results)?e.results:[e]);const t=a.filter(e=>{const a=e;return(e.journalAdminId||e.journal_admin||a.admin_id||a.admin&&a.admin.id)===s.id}),i=t.map(e=>e.id),l=await aa.list();let n=[];Array.isArray(l)?n=l:l&&"object"==typeof l&&(n=Array.isArray(l.data)?l.data:Array.isArray(l.results)?l.results:[l]);const o=n.filter(e=>i.includes(e.journalId));r(o),d(t)}catch(e){console.error("Failed to fetch admin data:",e),h("Ma'lumotlarni yuklashda xatolik yuz berdi.")}finally{m(!1)}})()},[s]);const f=e.useMemo(()=>{let e=i;if("new"===j?e=i.filter(e=>e.status===ha.Yangi):"pending"===j&&(e=i.filter(e=>e.status===ha.WithEditor||e.status===ha.QabulQilingan)),g){const a=g.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(a)||e.abstract.toLowerCase().includes(a)||e.keywords.some(e=>e.toLowerCase().includes(a)))}return e},[i,j,g]),y=e.useMemo(()=>({new:i.filter(e=>e.status===ha.Yangi).length,pending:i.filter(e=>e.status===ha.WithEditor||e.status===ha.QabulQilingan).length,all:i.length}),[i]);if((null==s?void 0:s.role)!==ua.JournalAdmin)return u.jsx(ka,{title:"Ruxsat Rad Etildi",children:u.jsx("p",{children:"Ushbu sahifani ko'rish uchun sizda yetarli ruxsat yo'q."})});if(c)return u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(x)return u.jsxs(ka,{title:"Xatolik",children:[u.jsx("p",{className:"text-red-400",children:x}),u.jsx(_a,{onClick:()=>window.location.reload(),className:"mt-4",children:"Qayta urinish"})]});const v=async(e,a)=>{try{await aa.updateStatus(e,a);const s=i.map(s=>s.id===e?{...s,status:a}:s);r(s)}catch(s){console.error("Failed to update article status:",s),h("Maqola holatini yangilashda xatolik yuz berdi.")}};return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[u.jsxs(ka,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(l,{className:"h-8 w-8 text-blue-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.new}),u.jsx("p",{className:"text-gray-400",children:"Yangi Kelganlar"})]}),u.jsxs(ka,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(k,{className:"h-8 w-8 text-yellow-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.pending}),u.jsx("p",{className:"text-gray-400",children:"Nashrni kutmoqda"})]}),u.jsxs(ka,{className:"text-center",children:[u.jsx("div",{className:"flex items-center justify-center mb-3",children:u.jsx(U,{className:"h-8 w-8 text-green-400"})}),u.jsx("h3",{className:"text-2xl font-bold text-white",children:y.all}),u.jsx("p",{className:"text-gray-400",children:"Jami nashrlar"})]})]}),u.jsxs(ka,{title:"Jurnal Administratori Paneli",children:[u.jsxs("div",{className:"mb-6 border-b border-white/10 flex",children:[u.jsxs("button",{onClick:()=>b("new"),className:"px-4 py-3 font-medium text-sm transition-colors "+("new"===j?"border-b-2 border-blue-400 text-blue-400":"text-gray-400 hover:text-white"),children:["Yangi Kelganlar ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("new"===j?"bg-blue-500/20 text-blue-300":"bg-white/10 text-gray-300"),children:y.new})]}),u.jsxs("button",{onClick:()=>b("pending"),className:"px-4 py-3 font-medium text-sm transition-colors "+("pending"===j?"border-b-2 border-yellow-400 text-yellow-400":"text-gray-400 hover:text-white"),children:["Nashrni kutmoqda ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("pending"===j?"bg-yellow-500/20 text-yellow-300":"bg-white/10 text-gray-300"),children:y.pending})]}),u.jsxs("button",{onClick:()=>b("all"),className:"px-4 py-3 font-medium text-sm transition-colors "+("all"===j?"border-b-2 border-green-400 text-green-400":"text-gray-400 hover:text-white"),children:["Barcha Maqolalar ",u.jsx("span",{className:"ml-2 px-2 py-0.5 rounded-full text-xs "+("all"===j?"bg-green-500/20 text-green-300":"bg-white/10 text-gray-300"),children:y.all})]})]}),u.jsxs("div",{className:"flex items-center bg-white/5 border border-white/10 rounded-xl mb-6 focus-within:border-blue-500 focus-within:ring-2 focus-within:ring-blue-500/20 transition-all",children:[u.jsx(L,{className:"text-gray-400 mx-4 shrink-0",size:20}),u.jsx("input",{type:"text",placeholder:"Maqola sarlavhasi bo'yicha qidirish...",className:"w-full !bg-transparent !border-none !py-3 !pr-4 !pl-0 !shadow-none !ring-0",value:g,onChange:e=>p(e.target.value)})]}),u.jsx("div",{className:"space-y-4",children:f.length>0?f.map(e=>{const a={[ha.Draft]:{text:"Qoralama",color:"bg-gray-500/20 text-gray-300"},[ha.Yangi]:{text:"Yangi",color:"bg-blue-500/20 text-blue-300"},[ha.WithEditor]:{text:"Redaktorda",color:"bg-indigo-500/20 text-indigo-300"},[ha.QabulQilingan]:{text:"Qabul Qilingan",color:"bg-yellow-500/20 text-yellow-300"},[ha.Revision]:{text:"Tahrirga qaytarilgan",color:"bg-orange-500/20 text-orange-300"},[ha.Accepted]:{text:"Qabul qilingan",color:"bg-teal-500/20 text-teal-300"},[ha.Published]:{text:"Nashr etilgan",color:"bg-green-500/20 text-green-300"},[ha.Rejected]:{text:"Rad etilgan",color:"bg-red-500/20 text-red-300"},[ha.NashrgaYuborilgan]:{text:"Nashrga Yuborilgan",color:"bg-purple-500/20 text-purple-300"},[ha.WritingInProgress]:{text:"Yozilmoqda",color:"bg-cyan-500/20 text-cyan-300"}}[e.status]||{text:e.status,color:"bg-gray-500/20 text-gray-300"};return u.jsx("div",{className:"p-5 bg-white/5 rounded-xl hover:bg-white/10 transition-all duration-200 border border-transparent hover:border-white/10",children:u.jsxs("div",{className:"flex justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"text-lg font-semibold text-white",children:e.title}),u.jsx("p",{className:"text-sm text-gray-400 mt-2 line-clamp-2",children:e.abstract}),u.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:e.keywords.map((e,a)=>u.jsx("span",{className:"text-xs px-2 py-1 bg-white/10 text-gray-300 rounded",children:e},a))}),u.jsxs("div",{className:"flex justify-between items-center mt-4 text-xs text-gray-500",children:[u.jsx("span",{children:new Date(e.submissionDate).toLocaleDateString()}),u.jsxs("span",{children:["Sahifalar: ",e.pageCount||0]})]})]}),u.jsxs("div",{className:"flex flex-col items-end gap-2",children:[u.jsx("span",{className:`text-xs font-medium px-3 py-1 rounded-full whitespace-nowrap ${a.color}`,children:a.text}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{return a=e.id,void t(`/articles/${a}`);var a},className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Ko'rish",children:u.jsx(A,{className:"h-4 w-4 text-blue-400"})}),u.jsx("button",{onClick:()=>{return a=e.id,void t(`/articles/${a}`);var a},className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Tahrirlash",children:u.jsx(M,{className:"h-4 w-4 text-yellow-400"})}),e.status!==ha.Accepted&&e.status!==ha.Published&&u.jsx("button",{onClick:()=>v(e.id,ha.Accepted),className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Qabul qilish",children:u.jsx(o,{className:"h-4 w-4 text-green-400"})}),e.status!==ha.Rejected&&u.jsx("button",{onClick:()=>v(e.id,ha.Rejected),className:"p-2 rounded-md hover:bg-white/10 transition-colors",title:"Rad etish",children:u.jsx(_,{className:"h-4 w-4 text-red-400"})})]})]})]})},e.id)}):u.jsx("p",{className:"text-center text-gray-400 py-8",children:g?`"${g}" bo'yicha hech narsa topilmadi.`:"Ushbu bo'limda hozircha maqolalar mavjud emas."})})]})]})},Ts=()=>{const{id:a}=be(),[s,t]=e.useState(null),[i,l]=e.useState(!0),[r,n]=e.useState(null);return e.useEffect(()=>{(async()=>{if(!a)return n("Maqola havolasi noto‘g‘ri."),void l(!1);try{l(!0),n(null);const e=await aa.getPublic(a),s=(null==e?void 0:e.data)||e;t(s)}catch(e){n((null==e?void 0:e.message)||"Maqola ma’lumotlarini yuklashda xatolik yuz berdi.")}finally{l(!1)}})()},[a]),i?u.jsx("div",{className:"max-w-3xl mx-auto py-10",children:u.jsx(ka,{title:"Maqola ma'lumotlari yuklanmoqda",children:u.jsxs("div",{className:"flex items-center justify-center py-12 text-gray-300",children:[u.jsx(H,{className:"h-6 w-6 animate-spin mr-2"}),"Yuklanmoqda..."]})})}):r||!s?u.jsx("div",{className:"max-w-3xl mx-auto py-10",children:u.jsxs(ka,{title:"Maqola topilmadi",children:[u.jsx("p",{className:"text-red-300",children:r||"Maqola topilmadi."}),u.jsx("div",{className:"mt-5",children:u.jsx(h,{to:"/login",children:u.jsx(_a,{children:"Kirish sahifasiga o‘tish"})})})]})}):u.jsx("div",{className:"max-w-3xl mx-auto py-10",children:u.jsx(ka,{title:"Nashr etilgan maqola",children:u.jsxs("div",{className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-white leading-snug",children:s.title}),u.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Muallif: ",u.jsx("span",{className:"text-gray-200",children:s.author_name||"Noma’lum"})]}),u.jsxs("p",{className:"text-sm text-gray-400",children:["Jurnal: ",u.jsx("span",{className:"text-gray-200",children:s.journal_name||"Noma’lum"})]}),s.doi&&u.jsxs("p",{className:"text-sm text-gray-400",children:["DOI: ",u.jsx("span",{className:"text-gray-200",children:s.doi})]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[u.jsx("a",{href:s.publication_link||"#",target:"_blank",rel:"noopener noreferrer",className:s.publication_link?"":"pointer-events-none opacity-50",children:u.jsxs(_a,{variant:"secondary",className:"w-full justify-center",children:[u.jsx(Oe,{className:"mr-2 h-4 w-4"}),"Nashr internet havolasi"]})}),u.jsx("a",{href:s.certificate_download_link||"#",target:"_blank",rel:"noopener noreferrer",className:s.certificate_download_link?"":"pointer-events-none opacity-50",download:!0,children:u.jsxs(_a,{variant:"secondary",className:"w-full justify-center",children:[u.jsx(fe,{className:"mr-2 h-4 w-4"}),"Sertifikatni yuklash"]})})]}),(!s.publication_link||!s.certificate_download_link)&&u.jsx("div",{className:"p-3 rounded-lg bg-yellow-500/10 border border-yellow-500/20 text-yellow-200 text-sm",children:"Ba'zi ma'lumotlar hali to‘ldirilmagan bo‘lishi mumkin."}),u.jsxs("div",{className:"pt-2",children:[u.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Antiplagiat tarixi"}),Array.isArray(s.plagiarism_history)&&s.plagiarism_history.length>0?u.jsx("div",{className:"space-y-2",children:s.plagiarism_history.map((e,a)=>u.jsxs("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10",children:[u.jsxs("p",{className:"text-xs text-gray-400",children:["Tekshiruv vaqti: ",e.checked_at?new Date(e.checked_at).toLocaleString():"Noma’lum"]}),u.jsxs("div",{className:"mt-1 text-sm text-gray-200 flex flex-col sm:flex-row sm:gap-6",children:[u.jsxs("span",{children:["Plagiat: ",u.jsxs("strong",{children:[e.plagiarism_percentage??"—","%"]})]}),u.jsxs("span",{children:["AI kontent: ",u.jsxs("strong",{children:[e.ai_content_percentage??"—","%"]})]})]})]},`${e.checked_at}-${a}`))}):u.jsx("div",{className:"p-3 rounded-lg bg-white/5 border border-white/10 text-sm text-gray-400",children:"Hozircha antiplagiat tarixi mavjud emas."})]}),u.jsx("div",{className:"pt-2",children:u.jsx(h,{to:"/login",children:u.jsxs(_a,{children:[u.jsx(U,{className:"mr-2 h-4 w-4"})," Platformaga kirish"]})})})]})})})},Is=()=>{const s=a(),{user:t}=ma(),[l,r]=e.useState([]),[n,o]=e.useState([]),[d,c]=e.useState([]),[m,x]=e.useState(!0),[h,g]=e.useState(""),[p,j]=e.useState(""),[b,f]=e.useState(""),[y,v]=e.useState(""),[N,w]=e.useState(!1),[k,_]=e.useState(null),[q,S]=e.useState(!1),[z,C]=e.useState([]),[A,T]=e.useState({title:"",publication_type:"",scientific_field:"",publication_date:"",doi:"",pages:"",co_authors:"",abstract:"",keywords:"",file_url:""});e.useEffect(()=>{I()},[]);const I=async()=>{try{let e;if("super_admin"===(null==t?void 0:t.role)){e=await oa.list();const a=await ea.list();C(a)}else e=await oa.myPublications();const[a,s]=await Promise.all([na.list(),oa.publicationTypes()]);r(e),o(a),c(s)}catch(e){console.error("Ma'lumotlarni yuklashda xatolik:",e)}finally{x(!1)}},M=l.filter(e=>{const a=e.title.toLowerCase().includes(h.toLowerCase())||e.co_authors.toLowerCase().includes(h.toLowerCase())||e.keywords.toLowerCase().includes(h.toLowerCase()),s=!p||e.scientific_field===p,t=!b||e.publication_type===b,i=!y||e.author===y;return a&&s&&t&&i});return m?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-lg",children:"Yuklanmoqda..."})}):u.jsxs("div",{className:"container mx-auto p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-3xl font-bold",children:"Muallif Nashrlari"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(_a,{onClick:()=>{S(!0)},variant:"secondary",children:[u.jsx($e,{className:"w-4 h-4 mr-2"}),"QR Code Scan"]}),u.jsxs(_a,{onClick:()=>w(!0),children:[u.jsx(X,{className:"w-4 h-4 mr-2"}),"Yangi Nashr"]})]})]}),u.jsx(ka,{className:"mb-6",children:u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"search",className:"block text-sm font-medium mb-2",children:"Qidiruv"}),u.jsxs("div",{className:"relative",children:[u.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),u.jsx("input",{id:"search",type:"text",placeholder:"Sarlavha, mualliflar, kalit so'zlar...",value:h,onChange:e=>g(e.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ilmiy soha"}),u.jsxs("select",{value:p,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Barcha sohalar"}),n.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nashr turi"}),u.jsxs("select",{value:b,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Barcha turlar"}),d.map(e=>u.jsx("option",{value:e.value,children:e.label},e.value))]})]}),"super_admin"===(null==t?void 0:t.role)&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Muallif"}),u.jsxs("select",{value:y,onChange:e=>v(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Barcha mualliflar"}),z.map(e=>u.jsxs("option",{value:e.id,children:[e.first_name," ",e.last_name]},e.id))]})]}),u.jsx("div",{className:"flex items-end",children:u.jsxs(_a,{variant:"secondary",onClick:()=>{g(""),j(""),f(""),v("")},children:[u.jsx(J,{className:"w-4 h-4 mr-2"}),"Tozalash"]})})]})})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(e=>{var a,t;return u.jsxs(ka,{className:"hover:shadow-lg transition-all duration-300 overflow-hidden cursor-pointer transform hover:scale-105",onClick:()=>s(`/author-publications/${e.id}`),children:[(e.journal||e.conference)&&u.jsxs("div",{className:"relative h-32 bg-gradient-to-br from-blue-50 to-indigo-100",children:[(null==(a=e.journal)?void 0:a.image_url)?u.jsx("img",{src:e.journal.image_url,alt:e.journal.name,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center",children:u.jsx(U,{className:"w-12 h-12 text-blue-400"})}),u.jsx("div",{className:"absolute top-2 right-2",children:u.jsxs("div",{className:"flex gap-1",children:[e.file_url&&u.jsx(_a,{variant:"secondary",onClick:a=>{a.stopPropagation(),window.open(e.file_url)},children:u.jsx(fe,{className:"w-4 h-4"})}),u.jsx(_a,{variant:"primary",onClick:a=>{a.stopPropagation(),(e=>{_(e),T({title:e.title,publication_type:e.publication_type,scientific_field:e.scientific_field,publication_date:e.publication_date,doi:e.doi||"",pages:e.pages||"",co_authors:e.co_authors||"",abstract:e.abstract||"",keywords:e.keywords||"",file_url:e.file_url||""}),w(!0)})(e)},children:u.jsx(Z,{className:"w-4 h-4"})}),u.jsx(_a,{variant:"danger",onClick:a=>{a.stopPropagation(),(async e=>{if(confirm("Rostdan ham ushbu nashrni o'chirmoqchimisiz?"))try{await oa.delete(e),I()}catch(a){console.error("O'chirishda xatolik:",a)}})(e.id)},children:u.jsx(W,{className:"w-4 h-4"})})]})})]}),u.jsxs("div",{className:"p-4",children:[u.jsxs("div",{className:"flex gap-2 flex-wrap mb-3",children:[u.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t=e.publication_type,{journal_local:"bg-blue-100 text-blue-800",journal_international:"bg-green-100 text-green-800",journal_local_general:"bg-purple-100 text-purple-800",journal_international_general:"bg-indigo-100 text-indigo-800",conference_local:"bg-yellow-100 text-yellow-800",conference_international:"bg-orange-100 text-orange-800",scopus_journal:"bg-red-100 text-red-800",scopus_conference:"bg-pink-100 text-pink-800"}[t]||"bg-gray-100 text-gray-800"}`,children:e.publication_type_display}),e.is_verified&&u.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Tasdiqlangan"})]}),u.jsx("h3",{className:"text-lg font-semibold line-clamp-2 mb-2",children:e.title}),e.journal&&u.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(U,{className:"w-4 h-4 text-blue-600"}),u.jsx("span",{className:"font-medium text-blue-900",children:e.journal.name})]}),e.journal.issn&&u.jsxs("div",{className:"text-xs text-gray-600",children:["ISSN: ",e.journal.issn]})]}),e.conference&&u.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(i,{className:"w-4 h-4 text-green-600"}),u.jsx("span",{className:"font-medium text-green-900",children:e.conference.title})]}),e.conference.location&&u.jsxs("div",{className:"text-xs text-gray-600",children:["📍 ",e.conference.location]}),e.conference.date&&u.jsxs("div",{className:"text-xs text-gray-600",children:["📅 ",new Date(e.conference.date).toLocaleDateString("uz-UZ")]})]}),u.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[u.jsxs("div",{children:[u.jsx("strong",{children:"Ilmiy soha:"})," ",e.scientific_field_name]}),u.jsxs("div",{children:[u.jsx("strong",{children:"Sana:"})," ",new Date(e.publication_date).toLocaleDateString("uz-UZ")]}),e.doi&&u.jsxs("div",{children:[u.jsx("strong",{children:"DOI:"})," ",e.doi]}),e.pages&&u.jsxs("div",{children:[u.jsx("strong",{children:"Sahifalar:"})," ",e.pages]}),e.co_authors&&u.jsxs("div",{children:[u.jsx("strong",{children:"Hammualliflar:"})," ",e.co_authors]}),e.keywords&&u.jsxs("div",{children:[u.jsx("strong",{children:"Kalit so'zlar:"})," ",e.keywords]})]})]})]},e.id)})}),N&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsx(ka,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:k?"Nashrni tahrirlash":"Yangi nashr qo'shish"}),u.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{k?await oa.update(k.id,A):await oa.create(A),T({title:"",publication_type:"",scientific_field:"",publication_date:"",doi:"",pages:"",co_authors:"",abstract:"",keywords:"",file_url:""}),w(!1),_(null),I()}catch(a){console.error("Saqlashda xatolik:",a)}},className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"title",className:"block text-sm font-medium mb-2",children:"Sarlavha *"}),u.jsx("input",{id:"title",type:"text",value:A.title,onChange:e=>T({...A,title:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nashr turi *"}),u.jsxs("select",{value:A.publication_type,onChange:e=>T({...A,publication_type:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Nashr turini tanlang"}),d.map(e=>u.jsx("option",{value:e.value,children:e.label},e.value))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Ilmiy soha *"}),u.jsxs("select",{value:A.scientific_field,onChange:e=>T({...A,scientific_field:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Soxani tanlang"}),n.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"publication_date",className:"block text-sm font-medium mb-2",children:"Nashr sanasi *"}),u.jsx("input",{id:"publication_date",type:"date",value:A.publication_date,onChange:e=>T({...A,publication_date:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"doi",className:"block text-sm font-medium mb-2",children:"DOI"}),u.jsx("input",{id:"doi",type:"text",value:A.doi,onChange:e=>T({...A,doi:e.target.value}),placeholder:"10.1000/182",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"pages",className:"block text-sm font-medium mb-2",children:"Sahifalar"}),u.jsx("input",{id:"pages",type:"text",value:A.pages,onChange:e=>T({...A,pages:e.target.value}),placeholder:"15-25",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"co_authors",className:"block text-sm font-medium mb-2",children:"Hammualliflar"}),u.jsx("input",{id:"co_authors",type:"text",value:A.co_authors,onChange:e=>T({...A,co_authors:e.target.value}),placeholder:"A. A. Karimov, B. B. To'rayev",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"abstract",className:"block text-sm font-medium mb-2",children:"Annotatsiya"}),u.jsx("textarea",{id:"abstract",value:A.abstract,onChange:e=>T({...A,abstract:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"keywords",className:"block text-sm font-medium mb-2",children:"Kalit so'zlar"}),u.jsx("input",{id:"keywords",type:"text",value:A.keywords,onChange:e=>T({...A,keywords:e.target.value}),placeholder:"ta'lim, pedagogika, metodika",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"file_url",className:"block text-sm font-medium mb-2",children:"Fayl URL"}),u.jsx("input",{id:"file_url",type:"url",value:A.file_url,onChange:e=>T({...A,file_url:e.target.value}),placeholder:"https://example.com/file.pdf",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),u.jsxs("div",{className:"flex gap-2 justify-end",children:[u.jsx(_a,{type:"button",variant:"secondary",onClick:()=>{w(!1),_(null)},children:"Bekor qilish"}),u.jsx(_a,{type:"submit",children:k?"Saqlash":"Qo'shish"})]})]})]})})}),q&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsx(ka,{className:"w-full max-w-md",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"QR Code Scanner"}),u.jsxs("div",{className:"text-center py-8",children:[u.jsx($e,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"QR code skaner bu yerda bo'ladi"}),u.jsx(_a,{onClick:()=>S(!1),children:"Yopish"})]})]})})})]})},Ms=()=>{const{id:s}=be(),t=a(),[l,r]=e.useState(null),[n,d]=e.useState(!0),[c,m]=e.useState(!1);e.useEffect(()=>{s&&x()},[s]);const x=async()=>{try{const e=await oa.get(s);r(e)}catch(e){console.error("Nashrni yuklashda xatolik:",e)}finally{d(!1)}};return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-lg",children:"Yuklanmoqda..."})}):l?u.jsxs("div",{className:"container mx-auto p-6",children:[u.jsx("div",{className:"mb-6",children:u.jsxs(_a,{variant:"secondary",onClick:()=>t("/author-publications"),children:[u.jsx(ke,{className:"w-4 h-4 mr-2"}),"Orqaga qaytish"]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[u.jsx("div",{className:"lg:col-span-2",children:u.jsx(ka,{className:"mb-6",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:l.title}),u.jsxs("div",{className:"flex gap-2",children:[l.file_url&&u.jsxs(_a,{variant:"secondary",onClick:()=>window.open(l.file_url),children:[u.jsx(fe,{className:"w-4 h-4 mr-2"}),"Yuklab olish"]}),u.jsxs(_a,{variant:"primary",onClick:()=>m(!0),children:[u.jsx(Z,{className:"w-4 h-4 mr-2"}),"Tahrirlash"]}),u.jsxs(_a,{variant:"danger",onClick:async()=>{if(confirm("Rostdan ham ushbu nashrni o'chirmoqchimisiz?"))try{await oa.delete(s),t("/author-publications")}catch(e){console.error("O'chirishda xatolik:",e)}},children:[u.jsx(W,{className:"w-4 h-4 mr-2"}),"O'chirish"]})]})]}),u.jsxs("div",{className:"flex gap-2 flex-wrap mb-6",children:[u.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${h=l.publication_type,{journal_local:"bg-blue-100 text-blue-800",journal_international:"bg-green-100 text-green-800",journal_local_general:"bg-purple-100 text-purple-800",journal_international_general:"bg-indigo-100 text-indigo-800",conference_local:"bg-yellow-100 text-yellow-800",conference_international:"bg-orange-100 text-orange-800",scopus_journal:"bg-red-100 text-red-800",scopus_conference:"bg-pink-100 text-pink-800"}[h]||"bg-gray-100 text-gray-800"}`,children:l.publication_type_display}),l.is_verified&&u.jsxs("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 flex items-center gap-1",children:[u.jsx(o,{className:"w-4 h-4"}),"Tasdiqlangan"]})]}),l.journal&&u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:u.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.journal.image_url&&u.jsx("img",{src:l.journal.image_url,alt:l.journal.name,className:"w-16 h-16 object-cover rounded-lg"}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[u.jsx(U,{className:"w-5 h-5 text-blue-600"}),u.jsx("span",{className:"font-semibold text-blue-900",children:l.journal.name})]}),l.journal.issn&&u.jsxs("div",{className:"text-sm text-gray-600",children:["ISSN: ",l.journal.issn]})]})]})}),l.conference&&u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(i,{className:"w-5 h-5 text-green-600"}),u.jsx("span",{className:"font-semibold text-green-900",children:l.conference.title})]}),u.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[l.conference.location&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Ee,{className:"w-4 h-4"}),l.conference.location]}),l.conference.date&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(De,{className:"w-4 h-4"}),new Date(l.conference.date).toLocaleDateString("uz-UZ")]})]})]}),l.abstract&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Annotatsiya"}),u.jsx("p",{className:"text-gray-700 leading-relaxed",children:l.abstract})]}),l.keywords&&u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Kalit so'zlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:l.keywords.split(",").map((e,a)=>u.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-sm",children:e.trim()},a))})]})]})})}),u.jsxs("div",{className:"space-y-6",children:[u.jsx(ka,{children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Nashr ma'lumotlari"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Muallif"}),u.jsx("div",{className:"font-medium",children:l.author_name})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Ilmiy soha"}),u.jsx("div",{className:"font-medium",children:l.scientific_field_name})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Nashr sanasi"}),u.jsx("div",{className:"font-medium",children:new Date(l.publication_date).toLocaleDateString("uz-UZ")})]}),l.doi&&u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"DOI"}),u.jsx("div",{className:"font-medium",children:l.doi})]}),l.pages&&u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Sahifalar"}),u.jsx("div",{className:"font-medium",children:l.pages})]}),l.co_authors&&u.jsxs("div",{children:[u.jsx("div",{className:"text-sm text-gray-500",children:"Hammualliflar"}),u.jsx("div",{className:"font-medium",children:l.co_authors})]})]})]})}),l.file_url&&u.jsx(ka,{children:u.jsxs("div",{className:"p-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Fayl"}),u.jsxs(_a,{variant:"primary",onClick:()=>window.open(l.file_url),className:"w-full",children:[u.jsx(fe,{className:"w-4 h-4 mr-2"}),"Yuklab olish"]})]})})]})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsx(ka,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Nashrni tahrirlash"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Bu funksiya hozircha rivojlanmoqda..."}),u.jsx("div",{className:"flex gap-2 justify-end",children:u.jsx(_a,{variant:"secondary",onClick:()=>m(!1),children:"Bekor qilish"})})]})})})]}):u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-lg",children:"Nashr topilmadi"})});var h},Ps=()=>{const s=a(),[t,i]=e.useState([]),[r,n]=e.useState([]),[o,d]=e.useState(!0),[c,m]=e.useState(""),[x,h]=e.useState(""),[g,p]=e.useState(null),[j,b]=e.useState(!1),[f,y]=e.useState(null),[v,N]=e.useState(!1),[w,k]=e.useState(!1),[_,q]=e.useState(!1);e.useEffect(()=>{S()},[]);const S=async()=>{try{const e=[{id:"1",name:"O'zbekiston Milliy Universiteti Ilmiy Jurnali",issn:"1234-5678",description:"Milliy universitetning asosiy ilmiy nashri",category:"universitet",category_name:"Universitet jurnallari"},{id:"2",name:"Texnika Fanlari Assotsiatsiyasi",issn:"2345-6789",description:"Texnika fanlari bo'yicha ilmiy nashr",category:"texnika",category_name:"Texnika jurnallari"},{id:"3",name:"Tibbiyot Jurnali",issn:"3456-7890",description:"Tibbiyot sohasi ilmiy nashri",category:"tibbiyot",category_name:"Tibbiyot jurnallari"}];i([{id:"1",title:"Ilmiy maqola standarti",description:"O'zbekiston Milliy Universiteti uchun ilmiy maqola yozish standarti",content:"\n## Kirish\nKirish qismi maqolaning mavzuini qisqacha bayon qiladi, tadqiqot muammosini va o'rganilayotgan muammoning ahamiyatini tushuntiradi. Kirishda odatda 300-500 so'z oralig'ida bo'ladi.\n\n## Muammo va maqsad\nBu qismda tadqiqotning asosiy maqsadi va muammosi aniq ifodalab beriladi. Tadqiqot qanday muammoni hal qilayotgani va qanday natijalarga erishishi ko'rsatiladi.\n\n## Adabiyot sharhi\nOxirgi 5-10 yildagi adabiyotlar sharhi beriladi. Bu qismda avvalgi tadqiqotlar bilan solishtirish, ularning qanday usullardan foydalanilgani va qanday natijalarga erishilgani tahlil qilinadi.\n\n## Tadqiqot usuli va materiallari\nBu qismda tadqiqotda qo'llanilgan usullar (eksperimental, nazariy, hujjatli, matematik) va materiallar to'g'ri bayon qilinadi. Tadqiqotning ishonchliligi uchun zarur bo'lgan materiallar va usullar tasvirlanadi.\n\n## Natijalar va muhokama\nTadqiqot natijalari jadvallar va jadvallarsiz shaklda taqdim etiladi. Grafiklar, jadvallalar va diagrammalar orqali orqali bo'lishi mumkin. Natijalar tahlili va muhokama qilinadi.\n\n## Xulosa va takliflar\nTadqiqotning asosiy xulosasi va qisqa takliflar beriladi. Tadqiqotning ilmiy amaliyotga qo'shgan hissasi va kelajak tadqiqotlar uchun tavsiyalar beriladi.\n\n## Adabiyotlar ro'yxati\nBarcha ishlatilgan adabiyotlar standart formatda keltiriladi (APA, MLA, Chicago kabi).\n",keywords:"ilmiy maqola, standart, struktur, universitet",author_guidelines:"Maqola 15-25 bet oralig'ida bo'lishi kerak. Akademik til yozilishi shart. 3-5 ta asosiy bo'lim, kirish va xulosa qismlaridan iborat.",structure:"Kirish → Muammo → Adabiyot sharhi → Tadqiqot usuli → Natijalar → Xulosa → Adabiyotlar",word_count:5e3,created_at:"2024-01-15",journal:{id:"1",name:"O'zbekiston Milliy Universiteti Ilmiy Jurnali",issn:"1234-5678",description:"Milliy universitetning asosiy ilmiy nashri",category:"universitet",category_name:"Universitet jurnallari"},is_active:!0},{id:"2",title:"Texnika fanlari maqola formati",description:"Texnika fanlari uchun maqola yozish talabnomasi",content:"\n## Kirish\nKirish qismi muammoni, uning texnika fanlaridagi o'rni va ahamiyatini tushuntiradi. Odatda 200-300 so'z oralig'ida bo'ladi.\n\n## Muammo va masala\nTadqiqotning maqsadi, masalasi va qo'yilgan muammolar aniq ifodalab beriladi.\n\n## Tadqiqot usuli\nQo'llanilgan metodologiya, uskunlar va dasturiy vositalari tasvirlanadi.\n\n## Natijalar\nTajriba natijalari, hisob-kitoblar va grafiklar taqdim etiladi.\n\n## Xulosa va takliflar\nOlingan natijalar va ularning amaliyotdagi qo'llanilishi haqida xulosa beriladi.\n\n## Adabiyotlar\nTexnika fanlari uchun adabiyotlar standarti bo'yicha keltiriladi.\n",keywords:"texnika, metodologiya, tajriba, hisob-kitob",author_guidelines:"Maqola 10-15 bet oralig'ida. Texnik terminlardan foydalanish kerak. Diagrammalar va jadvallarni qo'shish tavsiya etiladi.",structure:"Kirish → Muammo → Usul → Natijalar → Xulosa → Adabiyotlar",word_count:3e3,created_at:"2024-01-10",journal:{id:"2",name:"Texnika Fanlari Assotsiatsiyasi",issn:"2345-6789",description:"Texnika fanlari bo'yicha ilmiy nashr",category:"texnika",category_name:"Texnika jurnallari"},is_active:!0},{id:"3",title:"Tibbiyot maqolalari uchun yo'riqnoma",description:"Tibbiyot sohasidagi maqolalar uchun standartlar va talablar",content:"\n## Kirish\nKasallikning yoki klinik tadqiqotining mavzusi va ahamiyati.\n\n## Muammo va masala\nTadqiqotning klinik ahamiyati, bemorlar sonidagi potentsial foydasi.\n\n## Usul va materiallar\nKlinik tadqiqot usullari, bemor ma'lumotlari to'plami.\n\n## Natijalar\nKlinik natijalari, statistik tahlillar, bemorlar holatidagi o'zgarishlar.\n\n## Xulosa va takliflar\nTibbiyot amaliyotiga qo'shgan hissasi.\n\n## Etika\nBemorlar huquqlari va etik qoidalar.\n",keywords:"tibbiyot, klinik, bemor, etika, statistik",author_guidelines:"Maqola 8-12 bet. Bemor ma'lumotlari maxfiyati. Etika qoidalariga rioya qilish shart.",structure:"Kirish → Muammo → Usul → Natijalar → Xulosa → Etika",word_count:2500,created_at:"2024-01-05",journal:{id:"3",name:"Tibbiyot Jurnali",issn:"3456-7890",description:"Tibbiyot sohasi ilmiy nashri",category:"tibbiyot",category_name:"Tibbiyot jurnallari"},is_active:!0}]),n(e)}catch(e){console.error("Ma'lumotlarni yuklashda xatolik:",e)}finally{d(!1)}},z=t.filter(e=>{const a=e.title.toLowerCase().includes(c.toLowerCase())||e.description.toLowerCase().includes(c.toLowerCase())||e.keywords.toLowerCase().includes(c.toLowerCase()),s=!x||e.journal.id===x;return a&&s&&e.is_active}),C=()=>{g&&s("/submit",{state:{template:g,fromTemplate:!0}})},T=e=>{k(!1),q(!0),setTimeout(()=>{q(!1)},3e3)},I=async e=>{try{N(!1),y(null)}catch(a){console.error("Yaratishda xatolik:",a)}},M=async(e,a)=>{try{i(t.map(s=>s.id===e?{...s,...a}:s)),N(!1),y(null)}catch(s){console.error("Yangilashda xatolik:",s)}};return u.jsxs("div",{className:"container mx-auto p-6",children:[_&&u.jsxs("div",{className:"fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-4 rounded-lg shadow-lg flex items-center gap-3 animate-pulse",children:[u.jsx(Q,{className:"w-6 h-6"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold",children:"To'lov muvaffaqiyatli!"}),u.jsx("p",{className:"text-sm",children:"To'lov amalga oshirildi va tasdiqlandi"})]})]}),u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-3xl font-bold",children:"Maqola Namuna Olish"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs(_a,{onClick:()=>k(!0),children:[u.jsx($e,{className:"w-4 h-4 mr-2"}),"QR Code Scanner"]}),u.jsxs(_a,{onClick:()=>N(!0),children:[u.jsx(X,{className:"w-4 h-4 mr-2"}),"Yangi namuna"]})]})]}),u.jsx(ka,{className:"mb-6",children:u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"search",className:"block text-sm font-medium mb-2",children:"Qidiruv"}),u.jsxs("div",{className:"relative",children:[u.jsx(L,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),u.jsx("input",{id:"search",type:"text",placeholder:"Namuna nomi, tavsif...",value:c,onChange:e=>m(e.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Jurnal"}),u.jsxs("select",{value:x,onChange:e=>h(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[u.jsx("option",{value:"",children:"Barcha jurnallar"}),r.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]}),u.jsx("div",{className:"flex items-end",children:u.jsxs(_a,{variant:"secondary",onClick:()=>{m(""),h("")},children:[u.jsx(J,{className:"w-4 h-4 mr-2"}),"Tozalash"]})})]})})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:z.map(e=>u.jsx(ka,{className:"hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>(e=>{p(e)})(e),children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold line-clamp-2",children:e.title}),u.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[u.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-md text-xs font-medium",children:e.journal.category_name}),u.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 rounded-md text-xs font-medium",children:[e.word_count," so'z"]})]})]}),u.jsx("div",{className:"flex gap-1"})]}),u.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3",children:e.description}),u.jsx("div",{className:"flex flex-wrap gap-1 mb-4",children:e.keywords.split(",").map((e,a)=>u.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded-md text-xs",children:e.trim()},a))}),u.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[u.jsx(U,{className:"w-4 h-4"}),u.jsx("span",{children:e.journal.name}),u.jsxs("span",{className:"text-gray-400",children:["(",e.journal.issn,")"]})]}),u.jsxs("div",{className:"text-sm text-gray-600",children:[u.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[u.jsx(l,{className:"w-4 h-4"}),u.jsxs("span",{children:[e.word_count," so'z"]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx(Pe,{className:"w-4 h-4"}),u.jsx("span",{children:e.author_guidelines})]})]}),u.jsxs("div",{className:"flex gap-2 mt-4",children:[u.jsxs(_a,{variant:"secondary",onClick:a=>{a.stopPropagation(),p(e),C()},children:[u.jsx(te,{className:"w-4 h-4 mr-2"}),"Shu namunadan yozish"]}),u.jsxs(_a,{variant:"primary",onClick:a=>{a.stopPropagation(),p(e)},children:[u.jsx(A,{className:"w-4 h-4 mr-2"}),"To'liq ko'rish"]})]})]})},e.id))}),g&&!v&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsx(ka,{className:"w-full max-w-4xl max-h-[95vh] overflow-y-auto mx-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold",children:g.title}),u.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[u.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-md text-sm font-medium",children:g.journal.category_name}),u.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-md text-sm font-medium",children:[g.word_count," so'z"]})]})]}),u.jsxs(_a,{variant:"secondary",onClick:()=>p(null),children:[u.jsx(ke,{className:"w-4 h-4 mr-2"}),"Yopish"]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Tavsif"}),u.jsx("p",{className:"text-gray-600",children:g.description})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Kalit so'zlar"}),u.jsx("div",{className:"flex flex-wrap gap-2",children:g.keywords.split(",").map((e,a)=>u.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-md",children:e.trim()},a))})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Muallif uchun yo'riqnoma"}),u.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:g.author_guidelines})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Maqola tuzilishi"}),u.jsx("p",{className:"text-gray-600 whitespace-pre-line",children:g.structure})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:"To'liq mazmuni"}),u.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-64 overflow-y-auto",children:u.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:g.content})})]}),u.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[u.jsx(De,{className:"w-4 h-4"}),u.jsxs("span",{children:["Yaratilgan: ",new Date(g.created_at).toLocaleDateString("uz-UZ")]}),u.jsx(U,{className:"w-4 h-4"}),u.jsx("span",{children:g.journal.name})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-end sticky bottom-0 bg-white border-t border-gray-200 p-4 -mx-6 -mb-6 mt-4",children:[u.jsx(_a,{variant:"secondary",onClick:()=>p(null),className:"w-full sm:w-auto",children:"Yopish"}),u.jsxs(_a,{onClick:C,className:"w-full sm:w-auto",children:[u.jsx(te,{className:"w-4 h-4 mr-2"}),"Shu namunadan maqola yozish"]})]})]})})}),w&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsx(ka,{className:"w-full max-w-2xl mx-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"QR Code Scanner"}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"bg-gray-100 rounded-lg p-8 mb-4",children:[u.jsx($e,{className:"w-24 h-24 mx-auto mb-4 text-blue-500"}),u.jsx("p",{className:"text-gray-600 mb-2",children:"QR code skaner"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Kamerani yo'naltiring va QR code ni skanlang"})]}),u.jsxs("div",{className:"bg-white border-2 border-dashed border-gray-300 rounded-lg p-4",children:[u.jsx("div",{className:"aspect-square bg-gray-100 rounded flex items-center justify-center",children:u.jsx($e,{className:"w-32 h-32 text-gray-400"})}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"QR code skanlash uchun"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold mb-4",children:"To'lov usullari"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-bold",children:"C"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold",children:"Click"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Mobil to'lov"})]})]}),u.jsx("span",{className:"text-green-600 font-semibold",children:"Faol"})]}),u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Click mobil ilovasi orqali tez va xavfsiz to'lov"}),u.jsx(_a,{variant:"primary",className:"w-full",onClick:()=>{window.open("https://click.uz/","_blank"),T()},children:"Click orqali to'lov"})]}),u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-bold",children:"P"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold",children:"Payme"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Mobil to'lov"})]})]}),u.jsx("span",{className:"text-green-600 font-semibold",children:"Faol"})]}),u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Payme orqali qulay va tezkor to'lov imkoniyati"}),u.jsx(_a,{variant:"primary",className:"w-full",onClick:()=>{window.open("https://payme.uz/","_blank"),T()},children:"Payme orqali to'lov"})]}),u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-bold",children:"U"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold",children:"UzCard"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Bank kartasi"})]})]}),u.jsx("span",{className:"text-green-600 font-semibold",children:"Faol"})]}),u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"UzCard bank kartalari orqali to'lov"}),u.jsx(_a,{variant:"primary",className:"w-full",onClick:()=>{window.open("https://uzcard.uz/","_blank"),T()},children:"UzCard orqali to'lov"})]}),u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center",children:u.jsx("span",{className:"text-white font-bold",children:"B"})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold",children:"Bank o'tkazmasi"}),u.jsx("p",{className:"text-sm text-gray-600",children:"An'anaviy usul"})]})]}),u.jsx("span",{className:"text-green-600 font-semibold",children:"Faol"})]}),u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Bank hisob raqamiga pul o'tkazish"}),u.jsx(_a,{variant:"primary",className:"w-full",onClick:()=>{alert("Bank ma'lumotlari:\n\nBank: O'zbekiston Milliy Banki\nHisob raqam: 12345678901234567890\nMFO: 01025\nOlingan: Ilmiy nashrlar uchun to'lov\n\nMa'lumotlar shaxsiy kabinetingizda ham mavjud."),T()},children:"Bank ma'lumotlari"})]})]}),u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:[u.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"To'lov haqida"}),u.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[u.jsx("li",{children:"• Barcha to'lov usullari xavfsiz"}),u.jsx("li",{children:"• To'lov darhol tasdiqlanadi"}),u.jsx("li",{children:"• Chek va kvitansiya beriladi"}),u.jsx("li",{children:"• Qo'llab-quvvatlash 24/7"})]})]})]})]}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx(_a,{variant:"secondary",onClick:()=>k(!1),children:"Yopish"})})]})})}),v&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 pt-8",children:u.jsx(ka,{className:"w-full max-w-4xl max-h-[calc(100vh-4rem)] overflow-y-auto mx-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:f?"Namunani tahrirlash":"Yangi namuna yaratish"}),u.jsx("div",{className:"text-gray-600 mb-4",children:f?"Namuna ma'lumotlarini tahrirlang":"Yangi maqola namunasi yarating"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Namuna nomi"}),u.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Namuna nomini",defaultValue:(null==f?void 0:f.title)||""})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Jurnal"}),u.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",defaultValue:(null==f?void 0:f.journal.id)||"",children:[u.jsx("option",{value:"",children:"Jurnal tanlang"}),r.map(e=>u.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tavsif"}),u.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Namuna tavsifi",defaultValue:(null==f?void 0:f.description)||""})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kalit so'zlar"}),u.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Kalit so'zlar vergul bilan ajratilgan",defaultValue:(null==f?void 0:f.keywords)||""})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"So\\'z soni"}),u.jsx("input",{type:"number",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"So\\'z soni",defaultValue:(null==f?void 0:f.word_count)||5e3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Muallif uchun yo'riqnoma"}),u.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:5,placeholder:"Mualliflar uchun yo'riqnoma",defaultValue:(null==f?void 0:f.author_guidelines)||""})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Maqola tuzilishi"}),u.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:5,placeholder:"Maqola tuzilishi (bo'limlar: Kirish → Muammo → ...)",defaultValue:(null==f?void 0:f.structure)||""})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"To'liq mazmuni"}),u.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:12,placeholder:"To'liq mazmuni (namuna shabloni)",defaultValue:(null==f?void 0:f.content)||""})]})]}),u.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg lg:hidden",children:u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-end max-w-4xl mx-auto",children:[u.jsx(_a,{variant:"secondary",onClick:()=>{N(!1),y(null)},className:"w-full sm:w-auto",children:"Bekor qilish"}),u.jsx(_a,{onClick:()=>{f?M(f.id,{title:f.title,description:f.description,keywords:f.keywords,journal_id:f.journal.id,word_count:f.word_count,author_guidelines:f.author_guidelines,structure:f.structure,content:f.content}):I()},className:"w-full sm:w-auto",children:f?"Saqlash":"Yaratish"})]})}),u.jsxs("div",{className:"hidden lg:flex gap-3 justify-end pb-4",children:[u.jsx(_a,{variant:"secondary",onClick:()=>{N(!1),y(null)},children:"Bekor qilish"}),u.jsx(_a,{onClick:()=>{f?M(f.id,{title:f.title,description:f.description,keywords:f.keywords,journal_id:f.journal.id,word_count:f.word_count,author_guidelines:f.author_guidelines,structure:f.structure,content:f.content}):I()},children:f?"Saqlash":"Yaratish"})]})]})})})]})},Fs=({children:e})=>{const{user:a,loading:s}=ma();return s?u.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"inline-block w-10 h-10 border-2 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Yuklanmoqda..."})]})}):a?u.jsx(u.Fragment,{children:e}):u.jsx(Ye,{to:"/login",replace:!0})},Ds=()=>{const{user:e}=ma();return u.jsxs(Le,{children:[u.jsx(Je,{path:"/login",element:u.jsx(ns,{})}),u.jsx(Je,{path:"/register",element:u.jsx(os,{})}),u.jsx(Je,{path:"/payment/click",element:u.jsx(ds,{})}),u.jsx(Je,{path:"/public/article/:id",element:u.jsx(Ts,{})}),u.jsxs(Je,{path:"/",element:u.jsx(Fs,{children:u.jsx(wa,{})}),children:[u.jsx(Je,{index:!0,element:u.jsx(Ye,{to:"/dashboard",replace:!0})}),u.jsx(Je,{path:"dashboard",element:u.jsx(Sa,{})}),u.jsx(Je,{path:"articles",element:u.jsx(Qa,{})}),u.jsx(Je,{path:"articles/:id",element:u.jsx(ls,{})}),u.jsx(Je,{path:"translations/:id",element:u.jsx(zs,{})}),u.jsx(Je,{path:"published-articles",element:u.jsx(hs,{})}),u.jsx(Je,{path:"my-collections",element:u.jsx(_s,{})}),u.jsx(Je,{path:"my-translations",element:u.jsx(Ss,{})}),u.jsx(Je,{path:"submit",element:u.jsx(Ka,{})}),u.jsx(Je,{path:"submit-book",element:u.jsx(ks,{})}),u.jsx(Je,{path:"users",element:u.jsx(Ha,{})}),u.jsx(Je,{path:"journal-management",element:u.jsx(cs,{})}),u.jsx(Je,{path:"journal-admin-panel",element:u.jsx(As,{})}),u.jsx(Je,{path:"udk-requests",element:u.jsx(Xa,{})}),u.jsx(Je,{path:"services",element:u.jsx(ss,{})}),u.jsx(Je,{path:"maqola-namuna-olish",element:u.jsx(Ps,{})}),u.jsx(Je,{path:"translation-service",element:u.jsx(qs,{})}),u.jsx(Je,{path:"plagiarism-check",element:u.jsx(Va,{})}),u.jsx(Je,{path:"profile",element:u.jsx(ts,{})}),u.jsx(Je,{path:"financials",element:u.jsx(gs,{})}),u.jsx(Je,{path:"payment-test",element:u.jsx(Cs,{})}),u.jsx(Je,{path:"author-publications",element:u.jsx(Is,{})}),u.jsx(Je,{path:"author-publications/:id",element:u.jsx(Ms,{})})]}),u.jsx(Je,{path:"*",element:u.jsx(Ye,{to:e?"/dashboard":"/login",replace:!0})})]})},Os=()=>u.jsx(Re,{children:u.jsxs(ca,{children:[u.jsx(Ds,{}),u.jsx(Ue,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"})]})}),$s=document.getElementById("root");if(!$s)throw new Error("Could not find root element to mount to");Be.createRoot($s).render(u.jsx(G.StrictMode,{children:u.jsx(Os,{})}));
